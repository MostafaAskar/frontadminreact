"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3980],{89802:(e,l,i)=>{i.d(l,{q:()=>s});var t=i(47313),a=i(74294),n=i(72652),d=i(46417);const s=e=>{let{fetchOptions:l,refetch:i=!1,value:s,...o}=e;const[r,u]=(0,t.useState)(!1),[c,v]=(0,t.useState)([]);"object"===typeof(null===s||void 0===s?void 0:s.label)&&null!==(null===s||void 0===s?void 0:s.label)&&(s.label=s.label.value);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(a.Z,{labelInValue:!0,filterOption:!1,notFoundContent:r?(0,d.jsx)(n.Z,{size:"small"}):"no results",value:s,...o,options:r?[]:c,onFocus:()=>{c.length&&!i||(u(!0),l().then((e=>{v(e),u(!1)})))}})})}},20776:(e,l,i)=>{i.d(l,{o:()=>r});var t=i(47313),a=i(84762),n=i(72652),d=i(12279),s=i.n(d),o=i(46417);const r=e=>{let{fetchOptions:l,refetch:i=!1,debounceTimeout:d=400,...r}=e;const[u,c]=(0,t.useState)(!1),[v,m]=(0,t.useState)([]),p=(0,t.useMemo)((()=>s()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),d)),[]);return(0,o.jsx)(a.Z,{showSearch:!0,labelInValue:!0,filterTreeNode:(e,l)=>l.label.localeCompare(e),treeLine:!0,onSearch:e=>p(e),treeData:u?[]:v,treeDefaultExpandAll:!0,onFocus:()=>{v.length&&!i||(c(!0),l().then((e=>{m(e),c(!1)})))},notFoundContent:u?(0,o.jsx)(n.Z,{size:"small"}):"no results",...r})}},55940:(e,l,i)=>{i.d(l,{Z:()=>r});i(47313);var t=i(59491),a=i(47515),n=i(23560),d=i(24511),s=i(79492),o=i(46417);function r(e){let{size:l="",onClick:i,type:r="default",...u}=e;const{t:c}=(0,d.$)(),{isDemo:v}=(0,s.Z)();return(0,o.jsx)(t.Z,{size:l,icon:(0,o.jsx)(a.Z,{}),onClick:e=>{v?n.Am.warning(c("cannot.work.demo")):i(e)},type:r,...u})}},73431:(e,l,i)=>{i.d(l,{Z:()=>r});var t=i(47313),a=i(39180),n=i(2717),d=i(28830),s=i(60535),o=i(46417);const r=()=>{const e=(0,n.I0)(),{languages:l,defaultLang:i}=(0,n.v9)((e=>e.formLang),n.wU);(0,t.useEffect)((()=>{s.Z.getAllActive().then((l=>{let{data:i}=l;e((0,d.dc)(i)),e((0,d.mh)(i.find((e=>1===e.default)).locale))}))}),[]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(a.ZP.Group,{value:i,onChange:l=>{let{target:{value:i}}=l;e((0,d.mh)(i))},className:"float-right",buttonStyle:"solid",children:null===l||void 0===l?void 0:l.map((e=>(0,o.jsx)(a.ZP.Button,{value:e.locale,children:e.title},e.id)))})})}},13622:(e,l,i)=>{i.d(l,{R:()=>r});var t=i(47313),a=i(12279),n=i.n(a),d=i(74294),s=i(72652),o=i(46417);const r=e=>{let{fetchOptions:l,debounceTimeout:i=400,refetch:a=!1,...r}=e;const[u,c]=(0,t.useState)(!1),[v,m]=(0,t.useState)([]),p=(0,t.useMemo)((()=>n()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),i)),[l,i]);return(0,o.jsx)(d.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>p(""),filterOption:!1,onSearch:p,notFoundContent:u?(0,o.jsx)(s.Z,{size:"small"}):"no results",...r,options:v,onFocus:()=>{v.length&&!a||p("")}})}},89281:(e,l,i)=>{i.d(l,{h:()=>r});var t=i(47313),a=i(12279),n=i.n(a),d=i(74294),s=i(72652),o=i(46417);const r=e=>{let{fetchOptions:l,debounceTimeout:i=400,onClear:a,refetchOptions:r=!1,...u}=e;const[c,v]=(0,t.useState)(!1),[m,p]=(0,t.useState)([]),h=(0,t.useMemo)((()=>n()((e=>{p([]),v(!0),l(e).then((e=>{p(e),v(!1)}))}),i)),[l,i]);return(0,o.jsx)(d.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),a&&a()},notFoundContent:c?(0,o.jsx)(s.Z,{size:"small"}):"no results",...u,options:m,onFocus:()=>{m.length&&!r||h("")}})}},385:(e,l,i)=>{i.d(l,{Z:()=>g});var t=i(47313),a=i(10976),n=i(26824),d=i(68197),s=i(59624),o=i(45705),r=i(15178),u=i(9274),c=i(59491),v=i(82138),m=i(47515),p=i(5764),h=i(36104),x=i(24511),j=i(46417);const g=e=>{var l;let{mediaList:i,setMediaList:g,name:Z="products"}=e;const{t:y}=(0,x.$)(),[f]=a.Z.useForm(),[b,k]=(0,t.useState)(null),[w,I]=(0,t.useState)([]),[q,S]=(0,t.useState)(!1),[_,C]=(0,t.useState)(!1),$=async e=>{let{file:l,type:i}=e;l.name?(k("video"===i?(0,j.jsx)("video",{controls:!0,src:l.name,width:450,height:450}):(0,j.jsx)(n.Z,{src:l.name,width:"100%",height:450,alt:"preview-img"})),S(!0)):k(null)},F=e=>({uid:e.title,name:e.title,status:"done",url:e.title,created:!0});return(0,j.jsxs)(d.Z,{gutter:[24,24],children:[(0,j.jsx)(s.Z,{span:24,children:(0,j.jsx)(o.Z,{className:"align-items-start",children:(0,j.jsx)(r.Z,{customRequest:e=>{let{file:l,onSuccess:i}=e;C(!0);const t=new FormData;t.append("image",l),t.append("type",Z),h.Z.upload(t).then((e=>{let{data:l}=e;g((e=>({...e,images:[...e.images,{...F(l),isVideo:!0}]}))),i("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,j.jsxs)("div",{className:"media-upload",children:[(0,j.jsx)(v.Z,{})," ",(0,j.jsx)("span",{children:y("upload.video")})]})})})}),(0,j.jsx)(s.Z,{span:24,children:null===i||void 0===i||null===(l=i.previews)||void 0===l?void 0:l.map(((e,l)=>{var t,a;return(0,j.jsxs)(o.Z,{className:"uploaded-file",wrap:!0,children:[(0,j.jsx)("span",{className:"media-item",onClick:()=>$({type:"img",file:null===i||void 0===i?void 0:i.previews[l]}),children:null===i||void 0===i||null===(t=i.previews[l])||void 0===t?void 0:t.name}),(0,j.jsx)("span",{className:"media-item",onClick:()=>$({type:"video",file:null===i||void 0===i?void 0:i.images[l]}),children:null===i||void 0===i||null===(a=i.images[l])||void 0===a?void 0:a.name}),(0,j.jsx)(m.Z,{className:"delete-media-item",onClick:()=>(e=>{const l=i.images.filter(((l,i)=>{if(i!==e)return l})),t=i.previews.filter(((l,i)=>{if(i!==e)return l}));g({images:l,previews:t})})(l)})]})}))}),(0,j.jsx)(u.Z,{title:"Video Preview",visible:q,onCancel:()=>{S(!1)},footer:null,children:b}),(0,j.jsx)(u.Z,{title:"Preview image",visible:_,footer:null,children:(0,j.jsx)(a.Z,{form:f,onFinish:()=>{g((e=>({...e,previews:[...e.previews,...w]}))),I([]),C(!1)},layout:"vertical",children:(0,j.jsxs)(d.Z,{gutter:[24,24],children:[(0,j.jsx)(s.Z,{span:24,children:(0,j.jsx)(a.Z.Item,{label:y("preview.image"),name:"preview-image",rules:[{required:!(null!==w&&void 0!==w&&w.length),message:y("required")}],children:(0,j.jsx)(p.Z,{type:Z,imageList:w,setImageList:I,multiple:!1,text:"upload.image",form:f})})}),(0,j.jsx)(s.Z,{span:24,className:"d-flex justify-content-end",children:(0,j.jsx)(c.Z,{type:"primary",onClick:()=>f.submit(),children:y("save")})})]})})})]})}},33724:(e,l,i)=>{i.d(l,{Z:()=>t});const t=function(e){let l=[],i=e.length-1;return function t(a,n){for(let s=0,o=null===(d=e[n])||void 0===d?void 0:d.length;s<o;s++){var d;let o=a.slice(0);o.push(e[n][s]),n===i?l.push(o):t(o,n+1)}}([],0),l}},37630:(e,l,i)=>{function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;const l=[];for(let i=0;i<e;i++){const e=Math.floor(10*Math.random());l.push(e)}return l.join("")}i.d(l,{Z:()=>t})},75336:(e,l,i)=>{function t(e,l){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const t=e.map((e=>({[e.locale]:""===l[`${i}[${e.locale}]`]?void 0:l[`${i}[${e.locale}]`]})));return Object.assign({},...t)}i.d(l,{Z:()=>t})},71136:(e,l,i)=>{i.d(l,{Z:()=>a});var t=i(47313);function a(e,l){const[i,a]=(0,t.useState)(e);return(0,t.useEffect)((()=>{const i=setTimeout((()=>{a(e)}),l);return()=>{clearTimeout(i)}}),[e,l]),i}},16190:(e,l,i)=>{i.d(l,{Z:()=>g});var t=i(47313),a=i(10976),n=i(9274),d=i(59491),s=i(66672),o=i(74294),r=i(24511),u=i(73431),c=i(2717),v=i(5170),m=i(23560),p=i(97340),h=i(75336),x=i(51282),j=i(46417);function g(e){let{modal:l,handleCancel:i,onSuccess:g}=e;const[Z]=a.Z.useForm(),{t:y}=(0,r.$)(),f=(0,c.I0)(),[b,k]=(0,t.useState)(!1),[w,I]=(0,t.useState)(!1),{languages:q,defaultLang:S}=(0,c.v9)((e=>e.formLang),c.wU);(0,t.useEffect)((()=>{var e;null!==l&&void 0!==l&&l.id&&(e=l.id,I(!0),v.Z.getGroupById(e).then((e=>{const l=e.data;Z.setFieldsValue({...l,..._(l)})})).finally((()=>I(!1))))}),[l]);function _(e){if(!e)return{};const{translations:l}=e,i=q.map((e=>{var i;return{[`title[${e.locale}]`]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title}}));return Object.assign({},...i)}return(0,j.jsx)(n.Z,{title:null!==l&&void 0!==l&&l.id?y("edit.extra.group"):y("add.extra.group"),visible:!!l,onCancel:i,footer:[(0,j.jsx)(d.Z,{type:"primary",onClick:()=>Z.submit(),loading:b,children:y("save")},"save-button-group"),(0,j.jsx)(d.Z,{type:"default",onClick:i,children:y("cancel")},"cancel-button-group")],children:w?(0,j.jsx)(x.Z,{}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"d-flex justify-content-end",children:(0,j.jsx)(u.Z,{})}),(0,j.jsxs)(a.Z,{layout:"vertical",name:"extra-group",form:Z,onFinish:e=>{const t={title:(0,h.Z)(q,e),type:null===e||void 0===e?void 0:e.type};null!==l&&void 0!==l&&l.id?function(e,l){k(!0),v.Z.updateGroup(e,l).then((()=>{m.Am.success(y("successfully.updated")),f((0,p.gw)()),i()})).finally((()=>k(!1)))}(null===l||void 0===l?void 0:l.id,t):function(e){k(!0),v.Z.createGroup(e).then((()=>{m.Am.success(y("successfully.created")),i(),f((0,p.gw)()),g&&g()})).finally((()=>k(!1)))}(t)},children:[q.map((e=>(0,j.jsx)(a.Z.Item,{rules:[{required:e.locale===S,message:y("required")}],name:`title[${e.locale}]`,label:y("title"),hidden:e.locale!==S,children:(0,j.jsx)(s.Z,{placeholder:y("title")})},"title"+e.locale))),(0,j.jsx)(a.Z.Item,{name:"type",label:y("type"),rules:[{required:!0,message:y("required")}],children:(0,j.jsxs)(o.Z,{style:{width:"100%"},placeholder:y("select.extra.type"),children:[(0,j.jsx)(o.Z.Option,{value:"color",children:y("color")}),(0,j.jsx)(o.Z.Option,{value:"text",children:y("text")})]})})]})]})})}},21726:(e,l,i)=>{i.d(l,{Z:()=>g});var t=i(10976),a=i(66672),n=i(9274),d=i(59491),s=i(47313),o=i(8922),r=i(24511),u=i(2717),c=i(23560),v=i(20503),m=i(8550),p=i(34319),h=i(5170),x=i(89281),j=i(46417);function g(e){var l,i,g,Z;let{modal:y,handleCancel:f,isVisible:b,paramsData:k}=e;const[w]=t.Z.useForm(),{t:I}=(0,r.$)(),q=(0,u.I0)(),[S,_]=(0,s.useState)(!1),[C,$]=(0,s.useState)("text"),[F,N]=(0,s.useState)(null),[V,O]=(0,s.useState)("");(0,s.useEffect)((()=>{if(null!==y&&void 0!==y&&y.id){switch($(y.group.type),y.group.type){case"color":O(y.value);break;case"image":N((0,m.Z)(y.value))}w.setFieldsValue(y)}}),[y]);function P(e,l){switch(e){case"color":return l.hex;case"text":return l;case"image":return l.name;default:return""}}return(0,j.jsx)(n.Z,{title:null!==y&&void 0!==y&&y.id?I("edit.extra"):I("add.extra"),visible:b,onCancel:f,footer:[(0,j.jsx)(d.Z,{type:"primary",onClick:()=>w.submit(),loading:S,children:I("save")}),(0,j.jsx)(d.Z,{type:"default",onClick:f,children:I("cancel")})],children:(0,j.jsxs)(t.Z,{name:"extra-form",layout:"vertical",form:w,onFinish:e=>{var l,i;const t={extra_group_id:null!==(l=e.extra_group_id.value)&&void 0!==l?l:e.extra_group_id,value:null!==(i=P(C,e.value))&&void 0!==i?i:e.value};null!==y&&void 0!==y&&y.id?((e,l)=>{_(!0),h.Z.updateValue(e,l).then((()=>{c.Am.success(I("successfully.updated")),f(),q((0,p.pZ)(k))})).finally((()=>{_(!1),w.resetFields()}))})(null===y||void 0===y?void 0:y.id,t):(e=>{_(!0),h.Z.createValue(e).then((()=>{c.Am.success(I("successfully.created")),f(),q((0,p.pZ)(k))})).finally((()=>{_(!1),w.resetFields()}))})(t)},initialValues:{extra_group_id:null!==y&&void 0!==y&&y.group?{label:null===y||void 0===y||null===(l=y.group)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title,value:null===y||void 0===y||null===(g=y.group)||void 0===g?void 0:g.id,key:null===y||void 0===y||null===(Z=y.group)||void 0===Z?void 0:Z.id}:[]},children:[(0,j.jsx)(t.Z.Item,{name:"extra_group_id",label:I("extra.group"),rules:[{required:!0,message:"required"}],children:(0,j.jsx)(x.h,{fetchOptions:e=>{const l={perPage:10,page:1,search:e};return h.Z.getAllGroups(l).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:`${null===e||void 0===e?void 0:e.type},${null===e||void 0===e?void 0:e.id}`}}))))},placeholder:I("select.extra.group"),allowClear:!0,onChange:e=>{var l;$(null===e||void 0===e||null===(l=e.key)||void 0===l?void 0:l.split(",")[0]),w.setFieldsValue({value:""})}})}),(0,j.jsx)(t.Z.Item,{name:"value",label:I("value"),rules:[{required:!0,message:"required"}],children:(e=>{switch(e){case"color":return(0,j.jsx)(o.xS,{onChangeComplete:e=>O(e.hex),color:V,disableAlpha:!0});case"text":return(0,j.jsx)(a.Z,{placeholder:I("enter.extra.value")});case"image":return(0,j.jsx)(v.Z,{type:"extras",image:F,setImage:N,form:w,name:"value"});default:return""}})(C)})]})})}},47668:(e,l,i)=>{i.d(l,{Z:()=>F});var t=i(47313),a=i(77181),n=i(10976),d=i(45705),s=i(59491),o=i(2717),r=i(90954),u=i(24511),c=i(97890),v=i(23560),m=i(3394),p=i(9274),h=i(66672),x=i(42346),j=i(66204),g=i(5170),Z=i(16190),y=i(82138),f=i(71136),b=i(46417);const k=e=>{let{open:l,onClose:i,selectedExtras:a,onSelect:n}=e;const{t:d}=(0,u.$)(),[o,r]=(0,t.useState)([]),[c,v]=(0,t.useState)(!1),[m,k]=(0,t.useState)(!1),[w,I]=(0,t.useState)(""),q=(0,f.Z)(w,500),S=e=>{v(!0);const l={valid:1,perPage:100,search:e};g.Z.getAllGroups(l).then((e=>{const l=e.data.map((e=>{var l;return{id:e.id,label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,shop_id:e.shop_id,group:{...e}}}));r(l)})).finally((()=>v(!1)))};return(0,t.useEffect)((()=>{l&&S(q)}),[l,q]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(p.Z,{visible:l,onCancel:()=>{i(),I("")},footer:null,children:[(0,b.jsx)(h.Z,{className:"mt-3",value:w,onChange:e=>I(e.target.value)}),(0,b.jsx)(x.ZP,{loading:c,dataSource:o.filter((e=>!(null!==a&&void 0!==a&&a.some((l=>l.id===e.id))))),renderItem:e=>(0,b.jsx)(x.ZP.Item,{extra:null!==e&&void 0!==e&&e.shop_id?null:(0,b.jsx)(j.Z,{children:d("admin")}),style:{cursor:"pointer"},onClick:()=>{n(e)},children:e.label}),footer:c?null:(0,b.jsx)(s.Z,{type:"link",onClick:()=>k(!0),style:{paddingLeft:0},icon:(0,b.jsx)(y.Z,{}),children:d("add.new.extra")})})]}),(0,b.jsx)(Z.Z,{modal:m,handleCancel:()=>k(!1),onSuccess:()=>S()})]})};var w=i(32697),I=i(98276),q=i(41068),S=i(21726),_=i(34273),C=i(7142);const $=e=>{let{extra:l,onClose:i,onSelect:a}=e;const{t:n}=(0,u.$)(),[o,r]=(0,t.useState)(!1),[c,v]=(0,t.useState)([]),[m,h]=(0,t.useState)([]),[j,Z]=(0,t.useState)(!1);function f(e){r(!0),g.Z.getGroupById(e).then((e=>{v(e.data.extra_values.map((e=>({label:e.value,value:e.id,group_type:e.group.type}))))})).finally((()=>{r(!1)}))}return(0,t.useEffect)((()=>{var e;null!==l&&void 0!==l&&l.value&&!j&&(f(l.value),h((null===l||void 0===l||null===(e=l.values)||void 0===e?void 0:e.map((e=>e.value)))||[]))}),[null===l||void 0===l?void 0:l.value,j]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(p.Z,{visible:!!l,onCancel:i,footer:[(0,b.jsx)(s.Z,{onClick:i,children:n("cancel")}),!o&&c.length>0&&(0,b.jsx)(s.Z,{onClick:()=>{const e=[];c.forEach((l=>{m.forEach((i=>{l.value===i&&e.push(l)}))})),a(null===l||void 0===l?void 0:l.value,e),i()},type:"primary",children:n("save")})],children:[(0,b.jsx)(C.ZP,{autoHide:!0,autoHeight:!0,autoHeightMin:"60vh",autoHeightMax:"60vh",children:(0,b.jsx)(w.Z.Group,{value:m,onChange:e=>{h(e)},className:"w-100",children:0!==(null===c||void 0===c?void 0:c.length)||o?(0,b.jsx)(x.ZP,{dataSource:c,loading:o,renderItem:e=>(0,b.jsx)(x.ZP.Item,{children:(0,b.jsx)(w.Z,{value:e.value,children:"color"===e.group_type?(0,b.jsxs)(d.Z,{size:"small",children:[(0,b.jsx)(q.Z,{className:"extras-color-badge",color:null===e||void 0===e?void 0:e.label}),(0,_.B)(null===e||void 0===e?void 0:e.label),(0,b.jsxs)("span",{children:["(",null===e||void 0===e?void 0:e.label,")"]})]}):(0,b.jsx)("span",{children:null===e||void 0===e?void 0:e.label})})})}):(0,b.jsx)(I.Z,{})})}),o?null:(0,b.jsx)(s.Z,{type:"link",onClick:()=>Z(!0),style:{paddingLeft:0},icon:(0,b.jsx)(y.Z,{}),children:n("add.new.extra")})]}),l&&(0,b.jsx)(S.Z,{isVisible:j,modal:{label:null===l||void 0===l?void 0:l.label,value:null===l||void 0===l?void 0:l.id,key:null===l||void 0===l?void 0:l.id},handleCancel:()=>Z(!1),groupId:null===l||void 0===l?void 0:l.value,onSuccess:()=>f(null===l||void 0===l?void 0:l.value)})]})},F=e=>{var l;let{next:i,prev:p,isRequest:h}=e;const{t:x}=(0,u.$)(),j=(0,o.I0)(),{uuid:g,id:Z}=(0,c.UO)(),y=(0,c.s0)(),{activeMenu:f}=(0,o.v9)((e=>e.menu),o.wU),[w,I]=(0,t.useState)(!1),[q,S]=(0,t.useState)(!1),[_,C]=(0,t.useState)((null===(l=f.data)||void 0===l?void 0:l.extras)||[]),[F,N]=(0,t.useState)(null),[V,O]=(0,t.useState)(!1);return(0,b.jsx)(a.Z,{children:(0,b.jsxs)(n.Z,{layout:"vertical",initialValues:{...f.data},onFinish:()=>{if(_.some((e=>{var l;return 0===(null===(l=e.values)||void 0===l?void 0:l.length)||!e.values})))return void v.Am.error(x("please.select.at.least.1.extra.value.for.each.extra"));if(_.map((e=>e.value)).sort(((e,l)=>e-l)),h)return j((0,r.nc)({activeMenu:f,data:{...f.data,extras:_}})),void y(`/product-request/${Z}?step=2`,{state:{generate:V}});j((0,r.nc)({activeMenu:f,data:{...f.data,extras:_}})),i()},children:[(0,b.jsx)(k,{open:q,onClose:()=>S(!1),selectedExtras:_,onSelect:e=>{O(!0),C((l=>[...l,e])),S(!1)}}),(0,b.jsx)($,{extra:F,onClose:()=>N(null),onSelect:(e,l)=>{O(!0),C((i=>i.map((i=>{if(i.value===e){const e=l.map((e=>{var l,i;const t=null===(l=f.data)||void 0===l||null===(i=l.extras)||void 0===i?void 0:i.flatMap((e=>e.values)).find((l=>l.value===e.value));return{...e,stock_id:null===t||void 0===t?void 0:t.stock_id}}));return{...i,values:e}}return i}))))}}),(0,b.jsx)(d.Z,{className:"w-100",size:"middle",direction:"vertical",children:_.map((e=>{var l;return(0,b.jsxs)(d.Z,{className:"w-100",direction:"vertical",children:[(0,b.jsxs)(d.Z,{className:"w-100",wrap:!0,children:[(0,b.jsx)(s.Z,{onClick:()=>N(e),ghost:!0,type:"primary",children:null===e||void 0===e?void 0:e.label}),null===e||void 0===e||null===(l=e.values)||void 0===l?void 0:l.map((l=>(0,b.jsxs)("div",{className:"extra-value",children:[null===l||void 0===l?void 0:l.label," ",(0,b.jsx)("button",{onClick:()=>{return i=e.value,t=l.value,O(!0),void C((e=>e.map((e=>e.value===i?{...e,values:(null===e||void 0===e?void 0:e.values.filter((e=>e.value!==t)))||[]}:e))));var i,t},type:"button",className:"extra-clear",children:(0,b.jsx)(m.IOM,{})})]},l.value)))]}),(0,b.jsx)(d.Z,{className:"w-100",style:{justifyContent:"flex-end"},children:(0,b.jsx)(s.Z,{danger:!0,onClick:()=>{return l=e,O(!0),void C((e=>e.filter((e=>e.id!==l.id))));var l},type:"text",children:x("delete")})})]},e.id)}))}),(0,b.jsx)(s.Z,{onClick:()=>S(!0),className:"w-100 my-3",type:"dashed",children:x("add.extra")}),(0,b.jsxs)(d.Z,{className:"mt-3",children:[(0,b.jsx)(s.Z,{onClick:p,children:x("prev")}),(0,b.jsx)(s.Z,{type:"primary",htmlType:"submit",loading:w,children:x("next")})]})]})})}},78873:(e,l,i)=>{i.d(l,{Z:()=>f});var t=i(47313),a=i(77181),n=i(83371),d=i(68197),s=i(59624),o=i(45705),r=i(59491),u=i(72652),c=i(2717),v=i(97890),m=i(90954),p=i(95882),h=i(24511),x=i(17101),j=i(97421),g=i(23560),Z=i(14349),y=i(46417);const f=e=>{var l,i,f,b,k,w,I,q,S,_,C,$,F;let{prev:N,isRequest:V}=e;const{t:O}=(0,h.$)(),{activeMenu:P}=(0,c.v9)((e=>e.menu),c.wU),{defaultLang:M,languages:E}=(0,c.v9)((e=>e.formLang),c.wU),L=(0,v.s0)(),A=(0,c.I0)(),[U,z]=(0,t.useState)({}),[T,G]=(0,t.useState)(null),{uuid:R}=(0,v.UO)(),[B,W]=(0,t.useState)(!1);function D(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,i=E.map((e=>{var i,t;return{[`title[${e.locale}]`]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title,[`description[${e.locale}]`]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.description}}));return Object.assign({},...i)}(0,t.useEffect)((()=>{V||function(e){G(!0),x.Z.getById(e).then((e=>{const l={...e.data,...D(e.data),properties:e.data.properties.map(((e,l)=>({id:l,[`key[${e.locale}]`]:e.key,[`value[${e.locale}]`]:e.value}))),translation:void 0,translations:void 0};z(l)})).finally((()=>G(!1)))}(R)}),[V]);const H=P.data,K=V?P.data.model:U;return T?(0,y.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,y.jsx)(u.Z,{size:"large",className:"py-5"})}):(0,y.jsxs)(a.Z,{children:[V&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(n.Z,{bordered:!0,title:O("changed.info"),children:[(0,y.jsx)(n.Z.Item,{label:`${O("title")} (${M})`,span:3,children:H[`title[${M}]`]}),(0,y.jsx)(n.Z.Item,{label:`${O("description")} (${M})`,span:3,children:H[`description[${M}]`]}),(0,y.jsx)(n.Z.Item,{label:O("shop"),span:1.5,children:null===H||void 0===H||null===(l=H.shop)||void 0===l?void 0:l.translation.title}),(0,y.jsx)(n.Z.Item,{label:O("category"),span:1.5,children:null===H||void 0===H||null===(i=H.category)||void 0===i?void 0:i.label}),(0,y.jsx)(n.Z.Item,{label:O("brand"),span:1.5,children:null===H||void 0===H||null===(f=H.brand)||void 0===f?void 0:f.label}),(0,y.jsx)(n.Z.Item,{label:O("unit"),span:1.5,children:null===H||void 0===H||null===(b=H.unit)||void 0===b?void 0:b.label}),(0,y.jsx)(n.Z.Item,{label:O("images"),span:3,children:(0,y.jsx)(d.Z,{gutter:12,children:null===H||void 0===H||null===(k=H.images)||void 0===k?void 0:k.filter((e=>!e.isVideo)).map(((e,l)=>(0,y.jsx)(s.Z,{children:(0,y.jsx)("img",{width:80,alt:"product",src:e.url})},"image"+l)))})}),(0,y.jsx)(n.Z.Item,{label:O("tax"),children:(null===H||void 0===H?void 0:H.tax)||0}),(0,y.jsx)(n.Z.Item,{label:O("min.quantity"),children:null===H||void 0===H?void 0:H.min_qty}),(0,y.jsx)(n.Z.Item,{label:O("max.quantity"),children:null===H||void 0===H?void 0:H.max_qty})]}),null===H||void 0===H?void 0:H.stocks.map(((e,l)=>{var i;return e?(0,y.jsxs)(n.Z,{bordered:!0,className:"mt-4",children:[(0,y.jsx)(n.Z.Item,{label:O("price"),span:2,children:e.price}),(0,y.jsx)(n.Z.Item,{label:O("quantity"),span:2,children:e.quantity}),null===e||void 0===e||null===(i=e.ids)||void 0===i?void 0:i.map(((e,l)=>(0,y.jsx)(n.Z.Item,{label:null===H||void 0===H?void 0:H.extras[l].label,children:null===e||void 0===e?void 0:e.label},"extra"+l)))]},"desc"+l):""}))]}),(0,y.jsxs)(n.Z,{bordered:!0,className:"mt-4",title:O("original.info"),children:[(0,y.jsx)(n.Z.Item,{label:`${O("title")} (${M})`,span:3,column:3,children:(null===(w=K.translation)||void 0===w?void 0:w.title)||K[`title[${M}]`]}),(0,y.jsx)(n.Z.Item,{label:`${O("description")} (${M})`,span:3,column:3,children:(null===K||void 0===K||null===(I=K.translation)||void 0===I?void 0:I.description)||K[`description[${M}]`]}),(0,y.jsx)(n.Z.Item,{label:O("shop"),span:1.5,column:1.5,children:null===(q=K.shop)||void 0===q?void 0:q.translation.title}),(0,y.jsx)(n.Z.Item,{label:O("category"),span:1.5,column:1.5,children:null===(S=K.category)||void 0===S?void 0:S.translation.title}),(0,y.jsx)(n.Z.Item,{label:O("brand"),span:1.5,column:1.5,children:null===(_=K.brand)||void 0===_?void 0:_.title}),(0,y.jsx)(n.Z.Item,{label:O("unit"),span:1.5,column:1.5,children:null===(C=K.unit)||void 0===C?void 0:C.translation.title}),(0,y.jsx)(n.Z.Item,{label:O("images"),span:3,column:3,children:(0,y.jsx)(d.Z,{gutter:12,children:null===K||void 0===K||null===($=K.galleries)||void 0===$?void 0:$.filter((e=>!e.preview)).map(((e,l)=>(0,y.jsx)(s.Z,{children:(0,y.jsx)("img",{width:80,alt:"product",src:j.bV+e.path})},"image"+l)))})}),(0,y.jsx)(n.Z.Item,{span:3,column:3,label:O("tax"),children:K.tax||0}),(0,y.jsx)(n.Z.Item,{span:3,column:3,label:O("min.quantity"),children:K.min_qty}),(0,y.jsx)(n.Z.Item,{span:3,column:3,label:O("max.quantity"),children:K.max_qty})]}),null===(F=K.stocks)||void 0===F?void 0:F.map(((e,l)=>e?(0,y.jsxs)(n.Z,{bordered:!0,className:"mt-4",children:[(0,y.jsx)(n.Z.Item,{label:O("price"),span:2,column:2,children:e.price}),(0,y.jsx)(n.Z.Item,{label:O("quantity"),span:2,column:2,children:e.quantity}),e.extras.map(((e,l)=>{var i,t,a;return(0,y.jsx)(n.Z.Item,{label:null===e||void 0===e||null===(i=e.group)||void 0===i||null===(t=i.translation)||void 0===t?void 0:t.title,span:2,column:2,children:null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.value},"extra"+l)}))]},"desc"+l):"")),(0,y.jsx)("div",{className:"d-flex justify-content-end mt-4",children:(0,y.jsxs)(o.Z,{children:[(0,y.jsx)(r.Z,{onClick:N,children:O("prev")}),(0,y.jsx)(r.Z,{loading:B,type:"primary",onClick:function(){const e={status:void 0},l="catalog/products";if(V&&P.data){W(!0);const e={id:P.data.model_id,type:"product",data:P.data};Z.Z.requestChangeUpdate(P.data.request_id,e).then((()=>{L(`/${l}`,{state:{tab:"request"}}),g.Am.success(O("successfully.updated")),A((0,m.ph)({...P,nextUrl:l}))})).finally((()=>{W(!1)}))}else A((0,m.ph)({...P,nextUrl:l})),A((0,p.t2)(e)),L(`/${l}`)},children:O("finish")})]})})]})}},35321:(e,l,i)=>{i.d(l,{Z:()=>k});var t=i(47313),a=i(10976),n=i(45705),d=i(55291),s=i(9274),o=i(77181),r=i(68197),u=i(59624),c=i(59491),v=i(78508),m=i(47515),p=i(2717),h=i(90954),x=i(17101),j=i(24511),g=i(97890),Z=i(55940),y=i(13966),f=i(89281),b=i(46417);const k=e=>{let{next:l,prev:i}=e;const[k]=a.Z.useForm(),{t:w}=(0,j.$)(),I=(0,p.I0)(),{uuid:q}=(0,g.UO)(),{activeMenu:S}=(0,p.v9)((e=>e.menu),p.wU),[_,C]=(0,t.useState)([]),[$,F]=(0,t.useState)(!1),[N,V]=(0,t.useState)(!1),[O,P]=(0,t.useState)(null),M=[{key:"2",title:w("property.group"),dataIndex:"group",render:(e,l)=>{var i;return(null===e||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title)||"-"}},{key:"4",title:w("property.value"),dataIndex:"value",render:(e,l)=>(null===e||void 0===e?void 0:e.value)||"-"},{key:"5",title:w("options"),render:e=>(0,b.jsx)(n.Z,{children:(0,b.jsx)(Z.Z,{type:"primary",danger:!0,icon:(0,b.jsx)(m.Z,{}),onClick:()=>L(e)})})}];(0,t.useEffect)((()=>{if(_.length&&q){const e=_;I((0,h.nc)({activeMenu:S,data:{...S.data,properties:e}}))}}),[_]);const E=e=>{x.Z.properties(q,{properties:e}).then((()=>{d.ZP.success(w("product.properties.saved")),A(q)})).finally((()=>F(!1)))},L=e=>{s.Z.confirm({title:w("delete.product"),okText:w("yes"),okType:"danger",onOk:()=>{var l;const i=null===_||void 0===_||null===(l=_.filter((l=>l.id!==e.id)))||void 0===l?void 0:l.map((e=>{var l;return null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.id}));E(i)}})},A=e=>{V(!0),x.Z.getById(e).then((e=>{var l;let{data:i}=e;C(null===i||void 0===i||null===(l=i.properties)||void 0===l?void 0:l.filter((e=>null===e||void 0===e?void 0:e.value))),k.resetFields()})).catch((e=>{console.log(e)})).finally((()=>{V(!1)}))};(0,t.useEffect)((()=>{q&&A(q)}),[]);return(0,b.jsxs)(o.Z,{children:[(0,b.jsx)(a.Z,{name:"property-form",layout:"vertical",form:k,onFinish:e=>{F(!0);const l=e.propertyValue.map((e=>e.value)),i=null===_||void 0===_?void 0:_.map((e=>{var l;return null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.id})),t=new Set([...l,...i]),a=Array.from(t);E({...a})},children:(0,b.jsxs)(r.Z,{gutter:24,className:"mb-3",style:{display:"flex",alignItems:"center"},children:[(0,b.jsx)(u.Z,{span:10,children:(0,b.jsx)(a.Z.Item,{name:"propertyGroup",label:w("property.group"),rules:[{required:!0,message:w("required")}],children:(0,b.jsx)(f.h,{fetchOptions:e=>{const l={search:e,perPage:10,page:1};return y.Z.getAllGroups(l).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))))},placeholder:w("select.group"),onSelect:e=>{P(e),k.setFieldsValue({propertyValue:[]})},onClear:()=>{P(null),k.setFieldsValue({propertyValue:[]})}})})}),(0,b.jsx)(u.Z,{span:10,children:(0,b.jsx)(a.Z.Item,{name:"propertyValue",label:w("property.value"),rules:[{required:!0,message:w("required")}],children:(0,b.jsx)(f.h,{fetchOptions:e=>{const l={search:e,perPage:10,page:1,group_id:null===O||void 0===O?void 0:O.value};return y.Z.getAllValues(l).then((e=>e.data.map((e=>({label:null===e||void 0===e?void 0:e.value,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))))},placeholder:w("select.value"),refetchOptions:!0,disabled:!O,mode:"multiple"})})}),(0,b.jsx)(u.Z,{span:4,children:(0,b.jsx)(c.Z,{type:"primary",htmlType:"submit",loading:$,children:w("save")})})]})}),(0,b.jsx)(v.Z,{scroll:{x:!0},columns:M,dataSource:_,pagination:!1,rowKey:e=>e.id,loading:N}),(0,b.jsxs)(n.Z,{className:"mt-4",children:[(0,b.jsx)(c.Z,{onClick:i,children:w("prev")}),(0,b.jsx)(c.Z,{type:"primary",onClick:l,children:w("next")})]})]})}},8597:(e,l,i)=>{i.d(l,{Z:()=>q});var t=i(47313),a=i(10976),n=i(77181),d=i(46155),s=i(68197),o=i(59624),r=i(66672),u=i(59491),c=i(16124),v=i(45705),m=i(2717),p=i(85104),h=i(47515),x=i(17101),j=i(5170),g=i(24511),Z=i(97890),y=i(51282),f=i(33724),b=i(90954),k=i(89802),w=i(37630),I=i(46417);const q=e=>{var l;let{prev:i,next:q,isRequest:S}=e;const{t:_}=(0,g.$)(),[C]=a.Z.useForm(),{uuid:$}=(0,Z.UO)(),{activeMenu:F}=(0,m.v9)((e=>e.menu),m.wU),[N,V]=(0,t.useState)(null),[O,P]=(0,t.useState)(null),[M,E]=(0,t.useState)([]),L=(0,m.I0)(),A=(0,Z.TH)(),{defaultLang:U}=(0,m.v9)((e=>e.formLang),m.wU),{defaultCurrency:z}=(0,m.v9)((e=>e.currency),m.wU);(0,t.useEffect)((()=>{var e;if(S)if(null!==(e=A.state)&&void 0!==e&&e.generate){var l,i,t,a,n;const e=null!==F&&void 0!==F&&F.data.extras?(0,f.Z)(null===F||void 0===F||null===(l=F.data.extras)||void 0===l?void 0:l.map((e=>e.values||[]))):[],u=e.map((e=>{var l,i;if(e.every((e=>"undefined"!==typeof e.stock_id))){var t,a,n;const l=null===(t=F.data)||void 0===t||null===(a=t.actualStocks)||void 0===a?void 0:a.find((l=>l.extras.every((l=>e.some((e=>{var i;return e.value===(null===l||void 0===l||null===(i=l.value)||void 0===i?void 0:i.id)}))))));return{galleries:(null===l||void 0===l?void 0:l.galleries)||[],price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,stock_id:null===l||void 0===l?void 0:l.id,tax:(null===F||void 0===F?void 0:F.data.tax)||0,addons:(null===l||void 0===l||null===(n=l.addons)||void 0===n?void 0:n.map((e=>{var l,i,t;return{label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.value)}})))||[],...Object.assign({},...e.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value,group:F.data.extras[l].label}}))))}}return{price:0,quantity:0,tax:(null===(l=F.data)||void 0===l?void 0:l.tax)||0,sku:null===F||void 0===F||null===(i=F.data)||void 0===i?void 0:i.sku,addons:[],...Object.assign({},...e.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}));let c=[];if(0===e.length&&0!==(null===(i=F.data)||void 0===i||null===(t=i.actualStocks)||void 0===t?void 0:t.length)){var d,s,o;const e=null===(d=F.data.actualStocks)||void 0===d?void 0:d.at(0);c=[{price:(null===e||void 0===e?void 0:e.price)||0,quantity:(null===e||void 0===e?void 0:e.quantity)||0,sku:null===e||void 0===e?void 0:e.sku,tax:(null===(s=F.data)||void 0===s?void 0:s.tax)||0,addons:e?null===(o=e.addons)||void 0===o?void 0:o.map((e=>{var l,i,t;return{label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.value)}})):[]}]}var r;if(0===e.length&&0===(null===F||void 0===F||null===(a=F.data)||void 0===a||null===(n=a.actualStocks)||void 0===n?void 0:n.length))c=[{price:void 0,quantity:0,sku:null===F||void 0===F?void 0:F.data.sku,tax:(null===(r=F.data)||void 0===r?void 0:r.tax)||0,addons:[]}];const v=c.concat(u);E(F.data.actualStocks.map((e=>e.id))),C.setFieldsValue({stocks:v})}else{var u,c;const e=null===(u=F.data.stocks)||void 0===u?void 0:u.map((e=>({galleries:(null===e||void 0===e?void 0:e.galleries)||[],price:e.price,quantity:e.quantity,tax:F.data.tax,stock_id:e.stock_id,sku:e.sku,...Object.assign({},...e.ids.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value,group:e.group}})))),addons:e.addons})));E((null===(c=F.data)||void 0===c?void 0:c.delete_ids)||[]),C.setFieldsValue({stocks:e})}else!function(e){P(!0),x.Z.getById(e).then((e=>{var l,i,t,a,n;const d=null!==F&&void 0!==F&&null!==(l=F.data)&&void 0!==l&&l.extras?(0,f.Z)(null===F||void 0===F||null===(i=F.data)||void 0===i||null===(t=i.extras)||void 0===t?void 0:t.map((e=>(null===e||void 0===e?void 0:e.values)||[]))):[],s=d.map((l=>{var i,t;if(l.every((e=>"undefined"!==typeof e.stock_id))){var a,n,d;const i=e.data.stocks.find((e=>e.extras.every((e=>l.some((l=>{var i;return l.value===(null===e||void 0===e||null===(i=e.value)||void 0===i?void 0:i.id)}))))));return{galleries:(null===i||void 0===i?void 0:i.galleries)||[],price:(null===i||void 0===i?void 0:i.price)||0,quantity:(null===i||void 0===i?void 0:i.quantity)||0,sku:null!==(a=null===(n=F.data)||void 0===n?void 0:n.sku)&&void 0!==a?a:null===i||void 0===i?void 0:i.sku,stock_id:null===i||void 0===i?void 0:i.id,tax:(null===F||void 0===F?void 0:F.data.tax)||0,addons:(null===i||void 0===i||null===(d=i.addons)||void 0===d?void 0:d.map((e=>{var l,i,t;return{label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.value)}})))||[],...Object.assign({},...l.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}return{price:0,quantity:0,sku:null===(i=F.data)||void 0===i?void 0:i.sku,tax:(null===(t=F.data)||void 0===t?void 0:t.tax)||0,addons:[],...Object.assign({},...l.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}));let o=[];if(0===d.length&&0!==(null===(a=e.data.stocks)||void 0===a?void 0:a.length)){var r,u,c,v,m;const l=null===(r=e.data.stocks)||void 0===r?void 0:r.at(0);o=[{price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,sku:null!==(u=null===(c=F.data)||void 0===c?void 0:c.sku)&&void 0!==u?u:null===l||void 0===l?void 0:l.sku,tax:(null===(v=F.data)||void 0===v?void 0:v.tax)||0,addons:l?null===(m=l.addons)||void 0===m?void 0:m.map((e=>{var l,i,t;return{label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.value)}})):[]}]}var p,h;0===d.length&&0===(null===(n=e.data.stocks)||void 0===n?void 0:n.length)&&(o=[{price:void 0,quantity:0,sku:null===(p=F.data)||void 0===p?void 0:p.sku,tax:(null===(h=F.data)||void 0===h?void 0:h.tax)||0,addons:[]}]);const x=o.concat(s);E(e.data.stocks.map((e=>e.id))),C.setFieldsValue({stocks:x})})).finally((()=>{P(!1)}))}($)}),[S,null===(l=A.state)||void 0===l?void 0:l.generate]);const T=(e,l,i)=>e.map((e=>Object.assign(e,{[l]:i}))),G=(e,l)=>{const i=e?(0,w.Z)(6):l,{stocks:t}=C.getFieldsValue();C.setFieldsValue({"set.all.sku":i,stock:T(t,"sku",i)})};return(0,I.jsx)(n.Z,{title:`${_("product.name")}: ${F.data[`title[${U}]`]?`"${F.data[`title[${U}]`]}"`:""}`,children:O?(0,I.jsx)(y.Z,{}):(0,I.jsxs)(a.Z,{layout:"vertical",form:C,onFinish:e=>{var l,i;const{stocks:t}=e,a=M.filter(((e,l)=>{var i;return!(null===(i=t[l])||void 0===i||!i.stock_id)&&!t.some((l=>(null===l||void 0===l?void 0:l.stock_id)===e))}));let n;var d,s,o,r,u,c,v;null===(l=F.data)||void 0===l||null===(i=l.extras)||void 0===i||!i.length?n=[{price:null===t||void 0===t||null===(d=t[0])||void 0===d?void 0:d.price,quantity:null===t||void 0===t||null===(s=t[0])||void 0===s?void 0:s.quantity,addons:null!==t&&void 0!==t&&null!==(o=t[0])&&void 0!==o&&o.addons?S?null===t||void 0===t||null===(r=t[0])||void 0===r?void 0:r.addons.map((e=>e)):null===t||void 0===t||null===(u=t[0])||void 0===u?void 0:u.addons.map((e=>null===e||void 0===e?void 0:e.value)):[],stock_id:null===t||void 0===t||null===(c=t[0])||void 0===c?void 0:c.stock_id,sku:null===t||void 0===t||null===(v=t[0])||void 0===v?void 0:v.sku,ids:[]}]:n=t.map((e=>{var l,i,t,a;return{galleries:e.galleries,price:e.price,quantity:e.quantity,sku:e.sku,ids:S?null===(l=F.data)||void 0===l?void 0:l.extras.map(((l,i)=>e[`extras[${i}]`])):null===(i=F.data)||void 0===i?void 0:i.extras.map(((l,i)=>e[`extras[${i}]`].value)),addons:e.addons?S?null===(t=e.addons)||void 0===t?void 0:t.map((e=>e)):null===(a=e.addons)||void 0===a?void 0:a.map((e=>e.value)):[],stock_id:e.stock_id}}));if(S)return L((0,b.nc)({activeMenu:F,data:{...F.data,stocks:n,delete_ids:a}})),void q();V(!0),x.Z.stocks($,{extras:n,delete_ids:a}).then((e=>{let{data:{stocks:l}}=e;const i=null===l||void 0===l?void 0:l.flatMap((e=>e.extras)),t=i.map((e=>({...e.value,stock_id:e.stock_id,group_type:e.group.type}))),n=null===i||void 0===i?void 0:i.find((e=>"color"===e.group.type)),d={};l.forEach((e=>{e.extras.forEach((l=>{var i,t,a,n,s;l.extra_group_id in d?null!==(i=d[l.extra_group_id].values)&&void 0!==i&&i.some((e=>{var i;return e.value===(null===(i=l.value)||void 0===i?void 0:i.id)}))||null===(t=d[l.extra_group_id].values)||void 0===t||t.push({value:l.value.id,label:null===(a=l.value)||void 0===a?void 0:a.value,stock_id:e.id}):d[l.extra_group_id]={group:l.group,label:null===(n=l.group.translation)||void 0===n?void 0:n.title,value:l.extra_group_id,id:l.extra_group_id,stock_id:e.id,values:[{value:l.value.id,label:null===(s=l.value)||void 0===s?void 0:s.value,stock_id:e.id}]}}))})),L((0,b.nc)({activeMenu:F,data:{...F.data,newExtras:[{group:null===n||void 0===n?void 0:n.group,values:t}],delete_ids:a,stocks:l,stocksData:l,extras:Object.values(d)}})),q()})).finally((()=>V(!1)))},children:[(0,I.jsx)(d.Z,{}),(0,I.jsx)("h2",{children:_("set.all.values")}),(0,I.jsxs)(s.Z,{gutter:12,align:"middle",children:[(0,I.jsx)(o.Z,{span:5,style:{marginRight:"10px"},children:(0,I.jsx)(a.Z.Item,{label:_("sku"),name:"set.all.sku",children:(0,I.jsx)(r.Z,{className:"w-100",onChange:e=>G(!1,e.target.value)})})}),(0,I.jsx)(o.Z,{children:(0,I.jsx)(a.Z.Item,{label:" ",name:"sku",children:(0,I.jsx)(u.Z,{icon:(0,I.jsx)(p.Z,{}),onClick:()=>G(!0)})})}),(0,I.jsx)(o.Z,{span:4,children:(0,I.jsx)(a.Z.Item,{label:_("price"),name:"set.all.price",rules:[{type:"number",min:0,message:_("must.be.positive.number")}],children:(0,I.jsx)(c.Z,{className:"w-100",onChange:function(e){const{stocks:l}=C.getFieldsValue();C.setFieldsValue({stocks:T(l,"price",e)})}})})}),(0,I.jsx)(o.Z,{span:4,children:(0,I.jsx)(a.Z.Item,{label:_("quantity"),name:"set.all.quantity",rules:[{type:"number",min:0,message:_("must.be.positive.number")}],children:(0,I.jsx)(c.Z,{className:"w-100",onChange:function(e){const{stocks:l}=C.getFieldsValue();C.setFieldsValue({stocks:T(l,"quantity",e)})}})})})]}),(0,I.jsx)(d.Z,{}),(0,I.jsx)("h2",{children:_("values")}),(0,I.jsx)(a.Z.List,{name:"stocks",children:(e,l)=>{let{add:i,remove:t}=l;return(0,I.jsx)("div",{children:e.map(((l,i)=>{var n,d,v,m;return(0,I.jsxs)(s.Z,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(n=F.data)&&void 0!==n&&null!==(d=n.extras)&&void 0!==d&&d.length)&&l.key,children:[null===(v=F.data)||void 0===v||null===(m=v.extras)||void 0===m?void 0:m.map(((e,l)=>(0,I.jsx)(o.Z,{children:(0,I.jsx)(a.Z.Item,{label:null===e||void 0===e?void 0:e.label,name:[i,`extras[${l}]`],rules:[{required:!0,message:_("required")}],children:(0,I.jsx)(k.q,{fetchOptions:()=>{return l=e.value,j.Z.getGroupById(l).then((e=>e.data.extra_values.map((e=>({label:null===e||void 0===e?void 0:e.value,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))));var l},className:"w-100",disabled:!0,style:{minWidth:200}})})},"extra"+e.value))),(0,I.jsx)(o.Z,{children:(0,I.jsx)(a.Z.Item,{label:_("sku"),name:[i,"sku"],children:(0,I.jsx)(r.Z,{className:"w-100",style:{minWidth:200}})})}),(0,I.jsx)(o.Z,{children:(0,I.jsx)(a.Z.Item,{label:_("quantity"),name:[i,"quantity"],rules:[{required:!0,message:_("required")}],children:(0,I.jsx)(c.Z,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,I.jsxs)(o.Z,{children:[(0,I.jsx)(a.Z.Item,{label:`${_("price")} (${null===z||void 0===z?void 0:z.symbol})`,name:[i,"price"],rules:[{required:!0,message:_("requried")}],children:(0,I.jsx)(c.Z,{min:0,className:"w-100",style:{minWidth:200}})}),(0,I.jsx)(a.Z.Item,{hidden:!0,label:_("id"),name:[i,"stock_id"],children:(0,I.jsx)(c.Z,{min:1,className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,I.jsxs)(o.Z,{children:[(0,I.jsx)(a.Z.Item,{label:_("tax"),name:[i,"tax"],children:(0,I.jsx)(c.Z,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})}),(0,I.jsx)(a.Z.Item,{label:_("tax"),name:[i,"galleries"],hidden:!0,children:(0,I.jsx)(c.Z,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,I.jsx)(o.Z,{children:(0,I.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:(e,i)=>{var t,a;return(null===(t=e.stocks[l.name])||void 0===t?void 0:t.price)!==(null===(a=i.stocks[l.name])||void 0===a?void 0:a.price)},children:e=>{let{getFieldValue:i}=e;const t=i(["stocks",l.name,"tax"])||0,n=i(["stocks",l.name,"price"]),d=0===t?null===n||void 0===n?void 0:n.toFixed(2):(n*t/100+n).toFixed(2);return(0,I.jsx)(a.Z.Item,{label:`${_("total.price")} (${null===z||void 0===z?void 0:z.symbol})`,children:(0,I.jsx)(c.Z,{min:1,disabled:!0,value:d,className:"w-100",style:{minWidth:200}})})}})}),(0,I.jsx)(o.Z,{children:(null===e||void 0===e?void 0:e.length)>1?(0,I.jsx)(u.Z,{type:"primary",className:"mt-2",danger:!0,icon:(0,I.jsx)(h.Z,{}),onClick:()=>{t(l.name)}}):""})]},l.key)}))})}}),(0,I.jsxs)(v.Z,{className:"mt-4",children:[(0,I.jsx)(u.Z,{onClick:i,children:_("prev")}),(0,I.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:!!N,children:_("next")})]})]})})}},97307:(e,l,i)=>{i.d(l,{Z:()=>C});var t=i(47313),a=i(10976),n=i(68197),d=i(59624),s=i(77181),o=i(66672),r=i(16124),u=i(86345),c=i(59491),v=i(89281),m=i(53149),p=i(11216),h=i(30763),x=i(2717),j=i(17101),g=i(90954),Z=i(31055),y=i(97890),f=i(24511),b=i(5764),k=i(49080),w=i(13622),I=i(82138),q=i(20776),S=i(385),_=i(46417);const C=e=>{var l,i,C;let{next:$,action_type:F="",isRequest:N}=e;const{t:V}=(0,f.$)(),[O]=a.Z.useForm(),P=(0,x.I0)(),{uuid:M}=(0,y.UO)(),E=(0,y.s0)(),[L,A]=(0,t.useState)(null),{activeMenu:U}=(0,x.v9)((e=>e.menu),x.wU),{defaultLang:z,languages:T}=(0,x.v9)((e=>e.formLang),x.wU),[G,R]=(0,t.useState)((null===U||void 0===U||null===(l=U.data)||void 0===l?void 0:l.initialMediaFile)||{images:[],previews:[]}),[B,W]=(0,t.useState)((null===(i=U.data)||void 0===i||null===(C=i.images)||void 0===C?void 0:C.filter((e=>!e.isVideo)))||[]),[D,H]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=O.getFieldsValue(!0);P((0,g.nc)({activeMenu:U,data:{...U.data,...e}}))}),[]);const K=e=>{const l={images:[],previews:[]},i=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.preview,url:e.preview}))),t=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:!0})));return l.previews=i,l.images=t,l};function X(e){const l={perPage:10,page:1,active:1,search:e};return Z.Z.getAll(l).then((e=>{let{data:l}=e;return null===l||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))}(0,t.useEffect)((()=>(X(),()=>{const e=O.getFieldsValue(!0);P((0,g.nc)({activeMenu:U,data:{...U.data,...e}}))})),[]);const J=()=>{P((0,g.bL)({id:"category-add",url:"category/add",name:V("add.category")})),E("/category/add")},Q=()=>{P((0,g.bL)({id:"unit-add",url:"unit/add",name:V("add.unit")})),E("/unit/add")};return(0,_.jsxs)(a.Z,{layout:"vertical",form:O,initialValues:{active:!0,vegetarian:!0,min_qty:1,max_qty:1,tax:0,interval:1,age_limit:12,digital:!1,...U.data},onFinish:e=>{var l,i,t,a,n;H(!0);const d={...e,digital:e.digital?1:0,active:Number(e.active),brand_id:null===(l=e.brand)||void 0===l?void 0:l.value,category_id:(null===(i=e.category)||void 0===i?void 0:i.value)||e.category,shop_id:null===(t=e.shop)||void 0===t?void 0:t.value,unit_id:null===(a=e.unit)||void 0===a?void 0:a.value,images:void 0,brand:void 0,category:void 0,shop:void 0,unit:void 0,tax:e.tax||0,...Object.assign({},...[...null===G||void 0===G?void 0:G.images,...B].map(((e,l)=>({[`images[${l}]`]:e.name})))),...Object.assign({},...null===G||void 0===G||null===(n=G.previews)||void 0===n?void 0:n.map(((e,l)=>({[`previews[${l}]`]:e.name}))))};if(N)return P((0,g.nc)({activeMenu:U,data:{...U.data,...d,images:B,brand:e.brand,category:e.category,shop:e.shop,unit:e.unit,tax:e.tax||0,title:{...Object.assign({},...T.map((l=>({[l.locale]:e[`title[${l.locale}]`]}))))},description:{...Object.assign({},...T.map((l=>({[l.locale]:e[`description[${l.locale}]`]}))))}}})),void $();"edit"===F?function(e,l){j.Z.update(M,l).then((()=>{P((0,g.nc)({activeMenu:U,data:{...e,...null===U||void 0===U?void 0:U.data,digital:Boolean(null===l||void 0===l?void 0:l.digital)}})),$()})).catch((e=>A(e.response.data.params))).finally((()=>H(!1)))}(e,d):function(e,l){j.Z.create(l).then((l=>{let{data:i}=l;P((0,g.SS)({id:`product-${i.uuid}`,url:`product/${i.uuid}`,name:V("add.product"),data:{...e,...i,initialMediaFile:K(i.galleries)},refetch:!1})),E(`/product/${i.uuid}/?step=1`)})).catch((e=>A(e.response.data.params))).finally((()=>H(!1)))}(e,d)},children:[(0,_.jsxs)(n.Z,{gutter:12,children:[(0,_.jsx)(d.Z,{span:16,children:(0,_.jsxs)(n.Z,{children:[(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("basic.info"),children:(0,_.jsxs)(n.Z,{children:[(0,_.jsx)(d.Z,{span:24,children:T.map((e=>(0,_.jsx)(a.Z.Item,{label:V("name"),name:`title[${e.locale}]`,rules:[{validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==z?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(V("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(V("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(V("required")))}],hidden:e.locale!==z,children:(0,_.jsx)(o.Z,{})},"name"+e.id)))}),(0,_.jsx)(d.Z,{span:24,children:T.map((e=>(0,_.jsx)(a.Z.Item,{label:V("description"),name:`description[${e.locale}]`,rules:[{validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==z?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(V("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(V("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(V("required")))}],hidden:e.locale!==z,children:(0,_.jsx)(k.Z,{rows:3})},"description"+e.id)))})]})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("pricing"),children:(0,_.jsxs)(n.Z,{gutter:12,children:[(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("min.qty"),name:"min_qty",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(r.Z,{min:1,className:"w-100"})})}),(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("max.qty"),name:"max_qty",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(r.Z,{min:1,className:"w-100"})})}),(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("tax"),name:"tax",rules:[{validator:(e,l)=>l&&(l<0||l>100)?Promise.reject(new Error(V("must.be.between.0.and.100"))):Promise.resolve()}],children:(0,_.jsx)(r.Z,{className:"w-100",addonAfter:"%"})})}),(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("interval.unit"),name:"interval",rules:[{required:!0,message:V("required")},{type:"number",min:0,message:V("must.be.positive")}],help:null!==L&&void 0!==L&&L.interval?L.interval[0]:null,validateStatus:null!==L&&void 0!==L&&L.interval?"error":"success",children:(0,_.jsx)(r.Z,{className:"w-100"})})})]})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("additions"),children:(0,_.jsxs)(n.Z,{gutter:12,children:[(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{label:V("age.limit"),name:"age_limit",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(r.Z,{min:0,className:"w-100"})})}),(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(u.Z,{})})}),(0,_.jsx)(d.Z,{span:6,children:(0,_.jsx)(a.Z.Item,{label:V("digital"),name:"digital",valuePropName:"checked",children:(0,_.jsx)(u.Z,{})})})]})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("video"),children:(0,_.jsx)(S.Z,{form:O,mediaList:G,setMediaList:R})})})]})}),(0,_.jsx)(d.Z,{span:8,children:(0,_.jsxs)(n.Z,{children:[(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("organization"),children:(0,_.jsxs)(n.Z,{children:[!N&&(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{label:V("shop/restaurant"),name:"shop",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(w.R,{fetchOptions:async function(e){const l={search:e,active:1};return m.Z.get(l).then((e=>e.data.map((e=>({label:e.translation?e.translation.title:"no name",value:e.id,key:e.id})))))},onChange:()=>O.setFieldsValue({category:void 0})})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{label:V("category"),name:"category",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(q.o,{refetch:!0,fetchOptions:async function(e){const l={perPage:100,type:"main",search:e};return h.Z.getAll(l).then((e=>e.data.map((e=>{var l,i,t;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,type:"main",disabled:null===(i=e.children)||void 0===i?void 0:i.length,children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var l,i,t;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,type:"sub_main",disabled:null===(i=e.children)||void 0===i?void 0:i.length,children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,type:"child"}}))}}))}}))))},dropdownRender:e=>(0,_.jsxs)(_.Fragment,{children:[e,(0,_.jsx)("div",{className:"p-1",children:(0,_.jsx)(c.Z,{icon:(0,_.jsx)(I.Z,{}),className:"w-100",onClick:J,children:V("add.category")})})]}),allowClear:!0})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{label:V("brand"),name:"brand",children:(0,_.jsx)(v.h,{fetchOptions:async function(e){const l={perPage:10,type:"main",search:e,active:1};return p.Z.getAll(l).then((e=>e.data.map((e=>({label:e.title,value:e.id,key:e.id})))))}})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{label:V("unit"),name:"unit",rules:[{required:!0,message:V("required")}],children:(0,_.jsx)(v.h,{fetchOptions:X,dropdownRender:e=>(0,_.jsxs)(_.Fragment,{children:[e,(0,_.jsx)("div",{className:"p-1",children:(0,_.jsx)(c.Z,{icon:(0,_.jsx)(I.Z,{}),className:"w-100",onClick:Q,children:V("add.unit")})})]})})})})]})})}),(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(s.Z,{title:V("media"),children:(0,_.jsx)(n.Z,{children:(0,_.jsx)(d.Z,{span:24,children:(0,_.jsx)(a.Z.Item,{name:"images",rules:[{validator:()=>0===(null===B||void 0===B?void 0:B.length)?Promise.reject(new Error(V("required"))):Promise.resolve()}],children:(0,_.jsx)(b.Z,{type:"products",imageList:B,setImageList:W,form:O,multiple:!0})})})})})})]})})]}),(0,_.jsx)(c.Z,{type:"primary",htmlType:"submit",loading:D,children:V("next")})]})}},96077:(e,l,i)=>{i.d(l,{S:()=>t});const t=[{title:"product",content:"First-content"},{title:"product.digital",content:"Product-digital"},{title:"product.extras",content:"Second-content"},{title:"stocks",content:"Third-content"},{title:"wholesale",content:"wholesale-content"},{title:"Gallery",content:"Gallery-content"},{title:"product.property",content:"Fourth-content"},{title:"finish",content:"Finish-content"}]},85104:(e,l,i)=>{i.d(l,{Z:()=>o});var t=i(1413),a=i(47313);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 693.2c-42.5-24.6-94.3-18-129.2 12.8l-53-30.7V523.6c0-15.7-8.4-30.3-22-38.1l-136-78.3v-67.1c44.2-15 76-56.8 76-106.1 0-61.9-50.1-112-112-112s-112 50.1-112 112c0 49.3 31.8 91.1 76 106.1v67.1l-136 78.3c-13.6 7.8-22 22.4-22 38.1v151.6l-53 30.7c-34.9-30.8-86.8-37.4-129.2-12.8-53.5 31-71.7 99.4-41 152.9 30.8 53.5 98.9 71.9 152.2 41 42.5-24.6 62.7-73 53.6-118.8l48.7-28.3 140.6 81c6.8 3.9 14.4 5.9 22 5.9s15.2-2 22-5.9L674.5 740l48.7 28.3c-9.1 45.7 11.2 94.2 53.6 118.8 53.3 30.9 121.5 12.6 152.2-41 30.8-53.6 12.6-122-40.7-152.9zm-673 138.4a47.6 47.6 0 01-65.2-17.6c-13.2-22.9-5.4-52.3 17.5-65.5a47.6 47.6 0 0165.2 17.6c13.2 22.9 5.4 52.3-17.5 65.5zM522 463.8zM464 234a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm170 446.2l-122 70.3-122-70.3V539.8l122-70.3 122 70.3v140.4zm239.9 133.9c-13.2 22.9-42.4 30.8-65.2 17.6-22.8-13.2-30.7-42.6-17.5-65.5s42.4-30.8 65.2-17.6c22.9 13.2 30.7 42.5 17.5 65.5z"}}]},name:"deployment-unit",theme:"outlined"};var d=i(17469),s=function(e,l){return a.createElement(d.Z,(0,t.Z)((0,t.Z)({},e),{},{ref:l,icon:n}))};s.displayName="DeploymentUnitOutlined";const o=a.forwardRef(s)}}]);