(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3856],{33834:(e,t,a)=>{"use strict";a.d(t,{K:()=>o});var i=a(97890),l=a(74776),n=a.n(l);const o=()=>{const e=(0,i.s0)(),t=(0,i.TH)(),a=n().parse(t.search,{ignoreQueryPrefix:!0});return{values:a,set:(t,i)=>e({search:n().stringify({...a,[t]:i})}),reset:t=>{const i={...a};i[t]&&delete i[t],e({search:n().stringify({...i})})},clear:()=>e({search:n().stringify({})}),merge:t=>e({search:n().stringify({...a,...t})})}}},52509:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var i=a(47313),l=a(96077),n=a(83999),o=a(77181),r=a(72652),d=a(35321),s=a(78873),u=a(8597),v=a(47668),c=a(97307),p=a(73431),x=a(97890),g=a(17101),m=a(2717),f=a(90954),h=a(24511),y=a(33834),_=a(34144),j=a(87882),k=a(56326),Z=a(46417);const{Step:w}=n.Z,b=()=>{var e,t,a,b,S;const{t:q}=(0,h.$)(),{uuid:$}=(0,x.UO)(),F=(0,y.K)(),{activeMenu:M}=(0,m.v9)((e=>e.menu),m.wU),{languages:E}=(0,m.v9)((e=>e.formLang),m.wU),N=(0,m.I0)(),O=Number((null===(e=F.values)||void 0===e?void 0:e.step)||0),[z,C]=(0,i.useState)(M.refetch),[U,A]=(0,i.useState)(l.S),{extras:B}=(null===M||void 0===M?void 0:M.data)||{},G=null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.digital,I=null===B||void 0===B?void 0:B.some((e=>{var t;return"color"===(null===e||void 0===e||null===(t=e.group)||void 0===t?void 0:t.type)})),K=(0,i.useMemo)((()=>null===B||void 0===B?void 0:B.find((e=>{var t;return"color"===(null===e||void 0===e||null===(t=e.group)||void 0===t?void 0:t.type)}))),[B]);Array.from(new Set(null===K||void 0===K||null===(a=K.values)||void 0===a?void 0:a.map((e=>e.value)))).map((e=>{var t;return null===K||void 0===K||null===(t=K.values)||void 0===t?void 0:t.find((t=>t.value===e))})).filter((e=>"color"===e.group_type));(0,i.useEffect)((()=>{G?A(l.S.filter((e=>"product.extras"!==e.title))):!1===G&&A(l.S.filter((e=>"product.digital"!==e.title))),A(I?e=>e:e=>e.filter((e=>"Gallery"!==e.title)))}),[I,G]);const P=()=>{const e=O+1;F.set("step",e)},T=()=>{const e=O-1;F.set("step",e)},V=e=>{const t={images:[],previews:[]},a=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.preview,url:e.preview}))),i=e.filter((e=>e.preview)).map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:!0})));return t.previews=a,t.images=i,t},D=e=>e?{label:null!==e&&void 0!==e&&e.translation?e.translation.title:e.title,value:e.id,key:e.id}:null;function H(e){if(null===e||void 0===e||!e.translations)return{};const{translations:t}=e,a=E.map((e=>{var a,i;return{[`title[${e.locale}]`]:null===(a=t.find((t=>t.locale===e.locale)))||void 0===a?void 0:a.title,[`description[${e.locale}]`]:null===(i=t.find((t=>t.locale===e.locale)))||void 0===i?void 0:i.description}}));return Object.assign({},...a)}(0,i.useEffect)((()=>{M.refetch&&function(e){C(!0),g.Z.getById(e).then((e=>{var t,a,i,l,n,o;const r={};e.data.stocks.forEach((e=>{e.extras.forEach((t=>{var a,i,l,n,o;t.extra_group_id in r?null!==(a=r[t.extra_group_id].values)&&void 0!==a&&a.some((e=>{var a;return e.value===(null===(a=t.value)||void 0===a?void 0:a.id)}))||null===(i=r[t.extra_group_id].values)||void 0===i||i.push({value:t.value.id,label:null===(l=t.value)||void 0===l?void 0:l.value,stock_id:e.id}):r[t.extra_group_id]={group:t.group,label:null===(n=t.group.translation)||void 0===n?void 0:n.title,value:t.extra_group_id,id:t.extra_group_id,stock_id:e.id,values:[{value:t.value.id,label:null===(o=t.value)||void 0===o?void 0:o.value,stock_id:e.id}]}}))}));const d={...e.data,...H(e.data),shop:D(e.data.shop),category:D(e.data.category),brand:D(e.data.brand),unit:D(e.data.unit),images:(s=e.data.galleries,s.map((e=>({uid:e.id,name:e.path,url:e.path,isVideo:Boolean(e.preview)})))),initialMediaFile:V(e.data.galleries),extras:Object.values(r),stocks:e.data.stocks.map((e=>({...e,...Object.assign({},...e.extras.map(((e,t)=>({[`extras[${t}]`]:e.id})))),quantity:e.quantity||0,price:e.price||0,extras:void 0}))),stocksData:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.stocks,properties:e.data.properties.map(((e,t)=>({id:t,[`key[${e.locale}]`]:e.key,[`value[${e.locale}]`]:e.value}))),translation:void 0,translations:void 0,min_qty:null===(a=e.data)||void 0===a?void 0:a.min_qty,max_qty:null===(i=e.data)||void 0===i?void 0:i.max_qty,tax:null===(l=e.data)||void 0===l?void 0:l.tax,interval:null===(n=e.data)||void 0===n?void 0:n.interval,age_limit:null===(o=e.data)||void 0===o?void 0:o.age_limit};var s;N((0,f.nc)({activeMenu:M,data:d}))})).finally((()=>{C(!1),N((0,f.A_)(M))}))}($)}),[M.refetch]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(o.Z,{title:q("edit.product"),extra:(0,Z.jsx)(p.Z,{}),children:(0,Z.jsx)(n.Z,{current:O,onChange:e=>{N((0,f.nc)({activeMenu:M,data:{...M.data,step:e}})),F.set("step",e)},children:U.map((e=>(0,Z.jsx)(w,{title:q(e.title)},e.title)))})}),z?(0,Z.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,Z.jsx)(r.Z,{size:"large",className:"py-5"})}):(0,Z.jsxs)("div",{className:"",children:["First-content"===U[O].content&&(0,Z.jsx)(c.Z,{next:P,action_type:"edit"}),(null===(b=M.data)||void 0===b?void 0:b.digital)&&"Product-digital"===U[O].content&&(0,Z.jsx)(j.Z,{next:P,prev:T}),!(null!==(S=M.data)&&void 0!==S&&S.digital)&&"Second-content"===U[O].content&&(0,Z.jsx)(v.Z,{next:P,prev:T}),"Third-content"===U[O].content&&(0,Z.jsx)(u.Z,{next:P,prev:T}),"wholesale-content"===U[O].content&&(0,Z.jsx)(k.Z,{next:P,prev:T}),I>0&&"Gallery-content"===U[O].content&&(0,Z.jsx)(_.Z,{next:P,prev:T}),"Fourth-content"===U[O].content&&(0,Z.jsx)(d.Z,{next:P,prev:T}),"Finish-content"===U[O].content&&(0,Z.jsx)(s.Z,{prev:T})]})]})}},24654:()=>{}}]);