"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2171],{56814:(e,l,a)=>{a.d(l,{Z:()=>m});a(47313);var t=a(52838),i=a(19107),s=a(97421),n=a(2717),r=a(10976),d=a(74294),o=a(23885),u=a(46417);const m=e=>{let{value:l,setValue:a,setLocation:m}=e;const{placePredictions:c,getPlacePredictions:v,isPlacePredictionsLoading:p}=(0,t.Z)({apiKey:s.kr,libraries:["places","geocode"]}),{defaultLang:g,languages:h}=(0,n.v9)((e=>e.formLang),n.wU);return(0,u.jsx)("div",{children:h.map(((e,t)=>(0,u.jsx)(r.Z.Item,{label:(0,o.t)("address"),name:`address[${e.locale}]`,rules:[{required:e.locale===g,message:(0,o.t)("required")}],hidden:e.locale!==g,children:(0,u.jsx)(d.Z,{allowClear:!0,searchValue:l,showSearch:!0,autoClearSearchValue:!0,loading:p,options:null===c||void 0===c?void 0:c.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{a(e),e.length>0&&v({input:e})},onSelect:async e=>{const l=await(0,i.Z)(e);m({lat:null===l||void 0===l?void 0:l.geometry.location.lat,lng:null===l||void 0===l?void 0:l.geometry.location.lng})}})},"address"+t)))})}},2772:(e,l,a)=>{a.d(l,{I:()=>t});const t=[{label:"IN_HOUSE",value:1,key:1},{label:"SELLER",value:2,key:2}]},19107:(e,l,a)=>{a.d(l,{Z:()=>n});var t=a(31881),i=a.n(t),s=a(97421);async function n(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.kr,a={address:e,key:l};return i().get("https://maps.googleapis.com/maps/api/geocode/json",{params:a}).then((e=>{let{data:l}=e;return l.results[0]})).catch((e=>"not found"))}},40622:(e,l,a)=>{a.d(l,{Z:()=>H});var t=a(47313),i=a(10976),s=a(45705),n=a(59491),r=a(97890),d=a(2717),o=a(90954),u=a(49067),m=a(24511),c=a(17649),v=a(74294),p=a(68197),g=a(59624),h=a(77181),x=a(66672),Z=a(86345),y=a(16124),j=a(46155),f=a(52421),b=a(97388),_=a(5764),k=a(98447),w=a(13622),I=a(61197),q=a(49986),S=a(74551),L=a(45005),N=a(56814),P=a(2772);const O=[{label:"minutes",value:"minute",key:"minute"},{label:"hours",value:"hour",key:"hour"},{label:"days",value:"day",key:"day"}];var F=a(46417);const{Option:E}=v.Z,C=e=>{let{backImage:l,setBackImage:a,logoImage:s,setLogoImage:r,form:o,user:u,setLocation:c,location:C}=e;const{t:H}=(0,m.$)(),[V,$]=(0,t.useState)(null),[M,R]=(0,t.useState)(null),[Y,D]=(0,t.useState)(null),{defaultLang:U,languages:B}=(0,d.v9)((e=>e.formLang),d.wU),[A,T]=(0,t.useState)("");const z=()=>{$(!0),D(!0)},J=()=>{$(!1),R(!1)};return(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:24,children:(0,F.jsx)(h.Z,{children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:4,children:(0,F.jsx)(i.Z.Item,{label:H("logo.image"),name:"logo_img",rules:[{required:!(null!==s&&void 0!==s&&s.length),message:H("required")}],children:(0,F.jsx)(_.Z,{type:"shops/logo",imageList:s,setImageList:r,form:o,multiple:!1,name:"logo_img"})})}),(0,F.jsx)(g.Z,{span:4,children:(0,F.jsx)(i.Z.Item,{label:H("background.image"),name:"background_img",rules:[{required:!(null!==l&&void 0!==l&&l.length),message:H("required")}],children:(0,F.jsx)(_.Z,{type:"shops/background",imageList:l,setImageList:a,form:o,multiple:!1,name:"background_img"})})}),(0,F.jsx)(g.Z,{span:10,children:(0,F.jsx)(i.Z.Item,{label:H("status.note"),name:"status_note",children:(0,F.jsx)(f.Z,{rows:4,maxLength:100})})}),(0,F.jsx)(g.Z,{span:4,children:(0,F.jsx)(i.Z.Item,{name:"status",label:H("status"),children:(0,F.jsx)(x.Z,{disabled:!0})})}),(0,F.jsx)(g.Z,{span:2,children:(0,F.jsx)(i.Z.Item,{label:H("open"),name:"open",valuePropName:"checked",children:(0,F.jsx)(Z.Z,{disabled:!0})})})]})})}),(0,F.jsx)(g.Z,{span:24,children:(0,F.jsx)(h.Z,{title:H("general"),children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:12,children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:24,children:B.map(((e,l)=>(0,F.jsx)(i.Z.Item,{label:H("title"),name:`title[${e.locale}]`,rules:[{required:(null===e||void 0===e?void 0:e.locale)===U,message:H("required")},{validator(l,a){var t;return a&&(null===a||void 0===a||null===(t=a.trim())||void 0===t?void 0:t.length)<2&&(null===e||void 0===e?void 0:e.locale)===U?Promise.reject(new Error(H("must.be.at.least.2"))):Promise.resolve()}}],hidden:e.locale!==U,children:(0,F.jsx)(x.Z,{maxLength:50})},"title"+l)))}),(0,F.jsx)(g.Z,{span:24,children:(0,F.jsx)(i.Z.Item,{label:H("phone"),name:"phone",rules:[{required:!0,message:H("required")},{type:"number",max:1e20,message:H("max.length.20")}],children:(0,F.jsx)(y.Z,{min:0,className:"w-100"})})})]})}),(0,F.jsx)(g.Z,{span:12,children:B.map(((e,l)=>(0,F.jsx)(i.Z.Item,{label:H("description"),name:`description[${e.locale}]`,rules:[{required:(null===e||void 0===e?void 0:e.locale)===U,message:H("required")},{validator(l,a){var t;return a&&(null===a||void 0===a||null===(t=a.trim())||void 0===t?void 0:t.length)<5&&(null===e||void 0===e?void 0:e.locale)===U?Promise.reject(new Error(H("must.be.at.least.5"))):Promise.resolve()}}],hidden:e.locale!==U,children:(0,F.jsx)(f.Z,{rows:4,maxLength:150})},"desc"+l)))}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{label:H("shop.tags"),name:"tags",rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(w.R,{mode:"multiple",fetchOptions:async function(e){D(!1);const l={search:e};return I.Z.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>{var l;return{label:(null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title)||"no name",value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},refetch:Y})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{label:H("shop.type"),name:"delivery_type",rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(v.Z,{options:P.I})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{label:H("seller"),name:"user",rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(w.R,{disabled:u,fetchOptions:async function(e){const l={search:e,roles:"user","empty-shop":1};return D(!1),q.Z.search(l).then((e=>e.data.map((e=>({label:(null===e||void 0===e?void 0:e.firstname)+" "+((null===e||void 0===e?void 0:e.lastname)||""),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))))},refetch:Y,dropdownRender:e=>(0,F.jsxs)(F.Fragment,{children:[e,(0,F.jsx)(j.Z,{style:{margin:"8px 0"}}),(0,F.jsx)(n.Z,{className:"w-100",icon:(0,F.jsx)(k.Z,{}),onClick:z,children:H("add.user")})]})})})})]})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(h.Z,{title:H("delivery.time"),children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{name:"delivery_time_type",label:H("delivery_time_type"),rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(v.Z,{className:"w-100",children:O.map((e=>(0,F.jsx)(E,{value:e.value,label:H(e.label)},e.key)))})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{name:"delivery_time_from",label:H("delivery_time_from"),rules:[{required:!0,message:H("required")},{type:"number",max:9999999999,message:H("max.length.10")}],children:(0,F.jsx)(y.Z,{min:0,className:"w-100"})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{name:"delivery_time_to",label:H("delivery_time_to"),rules:[{required:!0,message:H("required")},{type:"number",max:9999999999,message:H("max.length.10")}],children:(0,F.jsx)(y.Z,{min:0,className:"w-100"})})})]})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(h.Z,{title:H("order.info"),children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{label:H("tax"),name:"tax",rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(y.Z,{min:0,max:100,addonAfter:"%",className:"w-100"})})}),(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(i.Z.Item,{label:H("admin.commission"),name:"percentage",rules:[{required:!0,message:H("required")}],children:(0,F.jsx)(y.Z,{min:0,max:100,className:"w-100",addonAfter:"%"})})})]})})}),(0,F.jsx)(g.Z,{span:24,children:(0,F.jsx)(h.Z,{title:H("address"),children:(0,F.jsxs)(p.Z,{gutter:12,children:[(0,F.jsx)(g.Z,{span:12,children:(0,F.jsx)(N.Z,{value:A,setValue:T,setLocation:c})}),(0,F.jsx)(g.Z,{span:24,children:(0,F.jsx)(b.Z,{location:C,setLocation:c,setAddress:e=>o.setFieldsValue({[`address[${U}]`]:e})})})]})})}),V&&(0,F.jsx)(S.Z,{visible:V,handleCancel:()=>J()}),M&&(0,F.jsx)(L.Z,{visible:M,handleCancel:()=>J()})]})},H=e=>{var l,a,v,p,g,h,x,Z,y,j,f,b,_,k,w,I,q,S,L,N,E;let{next:H,action_type:V="",user:$}=e;const{t:M}=(0,m.$)(),[R]=i.Z.useForm(),Y=(0,r.s0)(),D=(0,d.I0)(),{uuid:U}=(0,r.UO)(),{activeMenu:B}=(0,d.v9)((e=>e.menu),d.wU),{settings:A}=(0,d.v9)((e=>e.globalSettings),d.wU),[T,z]=(0,t.useState)(null!==B&&void 0!==B&&null!==(l=B.data)&&void 0!==l&&l.location?{lat:parseFloat(null===B||void 0===B||null===(a=B.data)||void 0===a||null===(v=a.location)||void 0===v?void 0:v.latitude),lng:parseFloat(null===B||void 0===B||null===(p=B.data)||void 0===p||null===(g=p.location)||void 0===g?void 0:g.longitude)}:(0,c.Z)(A)),[J,K]=(0,t.useState)(!1),[G,Q]=(0,t.useState)(null!==(h=B.data)&&void 0!==h&&h.logo_img?[null===(x=B.data)||void 0===x?void 0:x.logo_img]:[]),[W,X]=(0,t.useState)(null!==(Z=B.data)&&void 0!==Z&&Z.background_img?[null===(y=B.data)||void 0===y?void 0:y.background_img]:[]);(0,t.useEffect)((()=>()=>{const e=R.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),D((0,o.nc)({activeMenu:B,data:{...B.data,...e}}))}),[]);return(0,F.jsx)(F.Fragment,{children:(0,F.jsxs)(i.Z,{form:R,name:"basic",layout:"vertical",onFinish:e=>{var l,a,t,i;K(!0);const s={...e,delivery_type:(null===e||void 0===e||null===(l=e.delivery_type)||void 0===l?void 0:l.value)||(null===e||void 0===e?void 0:e.delivery_type),"images[0]":null===(a=G[0])||void 0===a?void 0:a.name,"images[1]":null===(t=W[0])||void 0===t?void 0:t.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to||0,delivery_time_from:e.delivery_time_from||0,tags:null===e||void 0===e||null===(i=e.tags)||void 0===i?void 0:i.map((e=>e.value)),user_id:e.user.value,open:void 0,"location[latitude]":T.lat,"location[longitude]":T.lng,user:void 0,delivery_time:0};null===s||void 0===s||delete s.background_img,null===s||void 0===s||delete s.logo_img,"edit"===V?function(e,l){u.Z.update(U,l).then((()=>{D((0,o.nc)({activeMenu:B,data:e})),H()})).catch((e=>console.error(e.response.data.params))).finally((()=>K(!1)))}(e,s):function(e,l){u.Z.create(l).then((l=>{let{data:a}=l;D((0,o.SS)({id:`shop-${a.uuid}`,url:`shop/${a.uuid}`,name:M("add.shop"),data:{...e,id:null===a||void 0===a?void 0:a.id,seller:null===a||void 0===a?void 0:a.seller},refetch:!1})),Y(`/shop/${a.uuid}?step=1`)})).catch((e=>console.error(e.response.data.params))).finally((()=>K(!1)))}(e,s)},initialValues:{open:!1,status:"new",delivery_time_type:O[0],...B.data,delivery_type:null!==(j=null===(f=B.data)||void 0===f?void 0:f.delivery_type)&&void 0!==j?j:P.I[0],delivery_time_from:null!==(b=B.data)&&void 0!==b&&null!==(_=b.delivery_time)&&void 0!==_&&_.from?Number(null===(k=B.data)||void 0===k||null===(w=k.delivery_time)||void 0===w?void 0:w.from):0,delivery_time_to:null!==(I=B.data)&&void 0!==I&&null!==(q=I.delivery_time)&&void 0!==q&&q.to?Number(null===(S=B.data)||void 0===S||null===(L=S.delivery_time)||void 0===L?void 0:L.to):0,phone:null!==(N=B.data)&&void 0!==N&&N.phone?Number(null===(E=B.data)||void 0===E?void 0:E.phone):0},children:[(0,F.jsx)(C,{form:R,user:$,backImage:W,setBackImage:X,logoImage:G,setLogoImage:Q,location:T,setLocation:z}),(0,F.jsx)(s.Z,{children:(0,F.jsx)(n.Z,{type:"primary",htmlType:"submit",loading:J,children:M("next")})})]})})}},20131:(e,l,a)=>{a.d(l,{Z:()=>p});var t=a(47313),i=a(51282),s=a(70816),n=a.n(s),r=a(78790),d=a(49682),o=a(97890),u=a(21429),m=a(22899),c=a(10976),v=a(46417);const p=e=>{let{next:l,prev:a}=e;const[s]=c.Z.useForm(),[p,g]=(0,t.useState)([]),[h,x]=(0,t.useState)(new Array(7).fill(!1)),[Z,y]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),{uuid:b}=(0,o.UO)();return(0,t.useEffect)((()=>{s.setFieldsValue({working_days:u.P}),b&&(f(!0),d.Z.getById(b).then((e=>{g(e.data.closed_dates.filter((e=>e.day>n()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),r.Z.getById(b).then((e=>{x(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&s.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:n()(e.from,"HH:mm:ss"),to:n()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>f(!1))))}),[]),(0,v.jsx)(v.Fragment,{children:j?(0,v.jsx)(i.Z,{}):(0,v.jsx)(m.Z,{onFinish:e=>{y(!0);const a={dates:p?p.map((e=>n()(e).format("YYYY-MM-DD"))):void 0},t={dates:e.working_days.map((e=>({day:e.title,from:n()(e.from?e.from:"00").format("HH:mm"),to:n()(e.to?e.to:"00").format("HH:mm"),disabled:e.disabled})))};d.Z.update(b,a).then((()=>{l()})).finally((()=>y(!1))),0!==e.working_days.length&&r.Z.update(b,t).then((()=>{l()})).finally((()=>y(!1)))},prev:a,form:s,lines:h,loadingBtn:Z,days:p,setDays:g,setLines:x,weeks:u.P})})}},25050:(e,l,a)=>{a.d(l,{Z:()=>m});var t=a(87462),i=a(47313),s=a(99096),n=function(e,l){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&l.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)l.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(a[t[i]]=e[t[i]])}return a},r=s.Z.TimePicker,d=s.Z.RangePicker,o=i.forwardRef((function(e,l){return i.createElement(d,(0,t.Z)({},e,{dropdownClassName:e.popupClassName,picker:"time",mode:void 0,ref:l}))})),u=i.forwardRef((function(e,l){var a=e.addon,s=e.renderExtraFooter,d=e.popupClassName,o=n(e,["addon","renderExtraFooter","popupClassName"]),u=i.useMemo((function(){return s||(a||void 0)}),[a,s]);return i.createElement(r,(0,t.Z)({},o,{dropdownClassName:d,mode:void 0,ref:l,renderExtraFooter:u}))}));u.displayName="TimePicker",u.RangePicker=o;const m=u}}]);