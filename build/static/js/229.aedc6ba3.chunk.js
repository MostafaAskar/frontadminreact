"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[229],{89281:(e,t,s)=>{s.d(t,{h:()=>u});var a=s(47313),r=s(12279),l=s.n(r),n=s(74294),d=s(72652),i=s(46417);const u=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:r,refetchOptions:u=!1,...o}=e;const[c,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)([]),v=(0,a.useMemo)((()=>l()((e=>{p([]),m(!0),t(e).then((e=>{p(e),m(!1)}))}),s)),[t,s]);return(0,i.jsx)(n.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:v,onClear:()=>{v(""),r&&r()},notFoundContent:c?(0,i.jsx)(d.Z,{size:"small"}):"no results",...o,options:h,onFocus:()=>{h.length&&!u||v("")}})}},81742:(e,t,s)=>{s.d(t,{Z:()=>r});var a=s(34344);const r={getAll:e=>a.Z.get("dashboard/seller/stocks/select-paginate",{params:e})}},229:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var a=s(47313),r=s(97890),l=s(23560),n=s(10976),d=s(77181),i=s(68197),u=s(59624),o=s(74294),c=s(16124),m=s(99096),h=s(59491),p=s(70816),v=s.n(p),x=s(2717),f=s(90954),Z=s(57409),j=s(69660),g=s(89281),Y=s(24511),y=s(5764),b=s(81742),M=s(46417);function D(){var e,t;const{t:s}=(0,Y.$)(),{activeMenu:p}=(0,x.v9)((e=>e.menu),x.wU),D=(0,x.I0)(),[q]=n.Z.useForm(),N=(0,r.s0)(),[w,S]=(0,a.useState)(!1),{myShop:I}=(0,x.v9)((e=>e.myShop),x.wU),[k,O]=(0,a.useState)(null!==(e=p.data)&&void 0!==e&&e.images?[null===(t=p.data)||void 0===t?void 0:t.images[0]]:[]);(0,a.useEffect)((()=>()=>{const e=q.getFieldsValue(!0),t=JSON.stringify(e.start),s=JSON.stringify(e.end),a={...e,start:t,end:s};D((0,f.nc)({activeMenu:p,data:a}))}),[]);return(0,M.jsx)(d.Z,{title:s("add.discount"),className:"h-100",children:(0,M.jsxs)(n.Z,{name:"discount-add",layout:"vertical",onFinish:e=>{var t;if(v()(e.start).format("YYYY-MM-DD")>v()(e.end).format("YYYY-MM-DD"))return l.Am.error(s("start.date.must.be.before.end.date"));const a={price:e.price,type:e.type,stocks:e.products.map((e=>e.value)),start:e.start?v()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?v()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(t=k[0])||void 0===t?void 0:t.name]};S(!0);const r="seller/discounts";Z.Z.create(a).then((()=>{l.Am.success(s("successfully.created")),(0,x.dC)((()=>{D((0,f.ph)({...p,nextUrl:r})),D((0,j.k)({}))})),N(`/${r}`)})).finally((()=>S(!1)))},form:q,initialValues:{...(()=>{var e,t,s,a;const r=p.data;if(null===(e=p.data)||void 0===e||!e.start||null===(t=p.data)||void 0===t||!t.end)return r;const l=null===(s=p.data)||void 0===s?void 0:s.start,n=null===(a=p.data)||void 0===a?void 0:a.end;return{...r,start:v()(l,"YYYY-MM-DD"),end:v()(n,"YYYY-MM-DD")}})(),...p.data},className:"d-flex flex-column h-100",children:[(0,M.jsxs)(i.Z,{gutter:12,children:[(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(n.Z.Item,{label:s("type"),name:"type",rules:[{required:!0,message:s("required")}],children:(0,M.jsxs)(o.Z,{children:[(0,M.jsx)(o.Z.Option,{value:"fix",children:s("fix")}),(0,M.jsx)(o.Z.Option,{value:"percent",children:s("percent")})]})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(n.Z.Item,{label:s("price"),name:"price",rules:[{required:!0,message:s("required")}],children:(0,M.jsx)(c.Z,{min:0,className:"w-100"})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(n.Z.Item,{label:s("start.date"),name:"start",rules:[{required:!0,message:s("required")}],valuePropName:"date",children:(0,M.jsx)(m.Z,{className:"w-100",placeholder:"",disabledDate:e=>v()().add(-1,"days")>=e})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(n.Z.Item,{label:s("end.date"),name:"end",rules:[{required:!0,message:s("required")}],valuePropName:"date",children:(0,M.jsx)(m.Z,{className:"w-100",placeholder:"",disabledDate:e=>v()().add(-1,"days")>=e})})}),(0,M.jsx)(u.Z,{span:24,children:(0,M.jsx)(n.Z.Item,{label:s("products"),name:"products",rules:[{required:!0,message:s("required")}],children:(0,M.jsx)(g.h,{fetchOptions:async function(e){const t={search:e,shop_id:I.id};return b.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t,s;return{label:null===e||void 0===e||null===(t=e.product)||void 0===t||null===(s=t.translation)||void 0===s?void 0:s.title,value:e.id,key:e.id}}))}))},mode:"multiple"})})}),(0,M.jsx)(u.Z,{span:24,children:(0,M.jsx)(n.Z.Item,{label:s("image"),name:"images",rules:[{required:!k.length,message:s("required")}],children:(0,M.jsx)(y.Z,{type:"discounts",imageList:k,setImageList:O,form:q,multiple:!1,name:"image"})})})]}),(0,M.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,M.jsx)("div",{className:"pb-5",children:(0,M.jsx)(h.Z,{type:"primary",htmlType:"submit",loading:w,children:s("submit")})})})]})})}}}]);