{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Space,Table}from'antd';import{shallowEqual,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import numberToPrice from'../../helpers/numberToPrice';import userService from'../../services/user';import{PlusCircleOutlined}from'@ant-design/icons';import UserWalletModal from'./userWalletModal';import FilterColumns from'../../components/filter-column';import moment from'moment';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function WalletHistory(_ref){var _data$wallet;let{data}=_ref;const{t}=useTranslation();const[page,setPage]=useState(1);const[perPage,setPerPage]=useState(10);const[total,setTotal]=useState(1);const[loading,setLoading]=useState(false);const[list,setList]=useState([]);const[walletModal,setWalletModal]=useState(false);const{defaultCurrency}=useSelector(state=>state.currency,shallowEqual);const[columns,setColumns]=useState([{title:t('created.by'),dataIndex:'author',key:'author',is_show:true,render:author=>/*#__PURE__*/_jsxs(\"div\",{children:[author===null||author===void 0?void 0:author.firstname,\" \",(author===null||author===void 0?void 0:author.lastname)||'']})},{title:t('price'),dataIndex:'price',key:'price',is_show:true,render:price=>numberToPrice(price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)},{title:t('note'),dataIndex:'note',key:'note',is_show:true},{title:t('created.at'),dataIndex:'created_at',key:'created_at',is_show:true,render:created_at=>moment(created_at).format('YYYY-MM-DD HH:mm')}]);function onChangePagination(pagination,filters,sorter){const{pageSize:perPage,current:page}=pagination;setPage(page);setPerPage(perPage);}function fetchWalletHistory(){setLoading(true);const params={pageSize:10,page:page||1};userService.walletHistory(data.uuid,params).then(res=>{setList(res.data);setTotal(res.meta.total);}).finally(()=>setLoading(false));}useEffect(()=>{fetchWalletHistory();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[page]);return/*#__PURE__*/_jsxs(\"div\",{className:\"px-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),onClick:()=>setWalletModal(true),children:`${t('wallet')}: ${numberToPrice(data===null||data===void 0?void 0:(_data$wallet=data.wallet)===null||_data$wallet===void 0?void 0:_data$wallet.price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}`}),/*#__PURE__*/_jsx(FilterColumns,{columns:columns,setColumns:setColumns})]})}),/*#__PURE__*/_jsx(Table,{scroll:{x:true},columns:columns===null||columns===void 0?void 0:columns.filter(item=>item.is_show),dataSource:list,loading:loading,pagination:{pageSize:perPage,page,total},rowKey:record=>record.id,onChange:onChangePagination}),walletModal&&/*#__PURE__*/_jsx(UserWalletModal,{modal:walletModal,uuid:data.uuid,handleCancel:()=>setWalletModal(false)})]});}","map":null,"metadata":{},"sourceType":"module"}