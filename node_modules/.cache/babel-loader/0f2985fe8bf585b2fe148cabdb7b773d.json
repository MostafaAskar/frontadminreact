{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import{toast}from'react-toastify';import{Button,Card,Col,Form,Input,InputNumber,Row,Select}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,removeFromMenu,setMenuData}from'../../../redux/slices/menu';import{useTranslation}from'react-i18next';import LanguageList from'../../../components/language-list';import sellerBookingTable from'../../../services/seller/booking-table';import{AsyncSelect}from'components/async-select';import sellerBookingZone from'services/seller/booking-zone';import{DebounceSelect}from'components/search';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BookingTableEdit=()=>{const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{id}=useParams();const dispatch=useDispatch();const[form]=Form.useForm();const navigate=useNavigate();const[loading,setLoading]=useState(false);const[loadingBtn,setLoadingBtn]=useState(false);useEffect(()=>{return()=>{const data=form.getFieldsValue(true);dispatch(setMenuData({activeMenu,data}));};},[]);const fetchBox=id=>{setLoading(true);sellerBookingTable.getById(id).then(res=>{var _data$shop_section,_data$shop_section$tr,_data$shop_section2;let data=res.data;form.setFieldsValue({...data,shop_section_id:{label:(_data$shop_section=data.shop_section)===null||_data$shop_section===void 0?void 0:(_data$shop_section$tr=_data$shop_section.translation)===null||_data$shop_section$tr===void 0?void 0:_data$shop_section$tr.title,value:(_data$shop_section2=data.shop_section)===null||_data$shop_section2===void 0?void 0:_data$shop_section2.id}});}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const onFinish=values=>{const body={...values,chair_count:String(values.chair_count),shop_section_id:values.shop_section_id.value};setLoadingBtn(true);const nextUrl='seller/booking/tables';sellerBookingTable.update(id,body).then(()=>{toast.success(t('successfully.updated'));navigate(`/${nextUrl}`);dispatch(removeFromMenu({...activeMenu,nextUrl}));}).finally(()=>setLoadingBtn(false));};function fetchZone(search){return sellerBookingZone.getAll({search}).then(res=>res.data.map(item=>{var _item$translation;return{label:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item.id};}));}useEffect(()=>{if(activeMenu.refetch)fetchBox(id);},[activeMenu.refetch]);return/*#__PURE__*/_jsx(Card,{title:t('edit.booking.table'),extra:/*#__PURE__*/_jsx(LanguageList,{}),loading:loading,children:/*#__PURE__*/_jsxs(Form,{name:\"basic\",layout:\"vertical\",onFinish:onFinish,form:form,initialValues:{active:true,...activeMenu.data},children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('zona'),name:'shop_section_id',rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DebounceSelect,{fetchOptions:fetchZone,debounceTimeout:300})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"name\",name:`name`,rules:[{required:true,message:''}],children:/*#__PURE__*/_jsx(Input,{})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('chair.count'),name:\"chair_count\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('tax'),name:\"tax\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\"})})})]}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('submit')})]})});};export default BookingTableEdit;","map":null,"metadata":{},"sourceType":"module"}