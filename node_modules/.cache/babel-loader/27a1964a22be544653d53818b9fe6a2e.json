{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{Button,Space,Table,Image,Card}from'antd';import{DeleteOutlined,EditOutlined,PlusCircleOutlined}from'@ant-design/icons';import{toast}from'react-toastify';import{useTranslation}from'react-i18next';import{batch,shallowEqual,useDispatch,useSelector}from'react-redux';import{fetchSellerExtraValue}from'redux/slices/extraValue';import extraService from'services/seller/extras';import ExtraValueModal from'./extra-value-modal';import DeleteButton from'components/delete-button';import{IMG_URL}from'configs/app-global';import{disableRefetch,setMenuData}from'redux/slices/menu';import FilterColumns from'components/filter-column';import useDidUpdate from'helpers/useDidUpdate';import{Context}from'context/context';import CustomModal from'components/modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ExtraValue(){var _activeMenu$data,_activeMenu$data2,_activeMenu$data3;const{t}=useTranslation();const dispatch=useDispatch();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{extraValues,loading,meta}=useSelector(state=>state.extraValue,shallowEqual);const{setIsModalVisible}=useContext(Context);const data=activeMenu===null||activeMenu===void 0?void 0:activeMenu.data;const paramsData={perPage:(data===null||data===void 0?void 0:data.perPage)||10,page:(data===null||data===void 0?void 0:data.page)||1,group_id:(data===null||data===void 0?void 0:data.group_id)||null};const[id,setId]=useState(null);const[modal,setModal]=useState(null);const[loadingBtn,setLoadingBtn]=useState(false);const[text,setText]=useState(null);const[columns,setColumns]=useState([{title:t('id'),dataIndex:'id',key:'id',is_show:true},{title:t('title'),dataIndex:'extra_group_id',key:'extra_group_id',is_show:true,render:(_,row)=>{var _row$group,_row$group$translatio;return row===null||row===void 0?void 0:(_row$group=row.group)===null||_row$group===void 0?void 0:(_row$group$translatio=_row$group.translation)===null||_row$group$translatio===void 0?void 0:_row$group$translatio.title;}},{title:t('value'),dataIndex:'value',key:'value',is_show:true,render:(value,row)=>{var _row$group2,_row$group3,_row$group4;return/*#__PURE__*/_jsxs(Space,{className:\"extras\",children:[(row===null||row===void 0?void 0:(_row$group2=row.group)===null||_row$group2===void 0?void 0:_row$group2.type)==='color'?/*#__PURE__*/_jsx(\"div\",{className:\"extra-color-wrapper-contain\",style:{backgroundColor:row===null||row===void 0?void 0:row.value}}):null,(row===null||row===void 0?void 0:(_row$group3=row.group)===null||_row$group3===void 0?void 0:_row$group3.type)==='image'?/*#__PURE__*/_jsx(Image,{width:100,src:IMG_URL+(row===null||row===void 0?void 0:row.value),className:\"borderRadius\"}):null,(row===null||row===void 0?void 0:(_row$group4=row.group)===null||_row$group4===void 0?void 0:_row$group4.type)==='image'?null:/*#__PURE__*/_jsx(\"span\",{children:row===null||row===void 0?void 0:row.value})]});}},{title:t('options'),is_show:true,render:record=>/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>setModal(record)}),/*#__PURE__*/_jsx(DeleteButton,{type:\"primary\",danger:true,icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:()=>{setId([record.id]);setIsModalVisible(true);setText(true);}})]})}]);const handleCancel=()=>setModal(null);const deleteExtra=()=>{setLoadingBtn(true);const params={...Object.assign({},...id.map((item,index)=>({[`ids[${index}]`]:item})))};extraService.deleteValue(params).then(()=>{toast.success(t('successfully.deleted'));setId(null);dispatch(fetchSellerExtraValue(paramsData));}).finally(()=>{setIsModalVisible(false);setLoadingBtn(false);setId(null);});};useEffect(()=>{if(activeMenu.refetch){batch(()=>{dispatch(fetchSellerExtraValue(paramsData));dispatch(disableRefetch(activeMenu));});}},[activeMenu.refetch]);useDidUpdate(()=>{dispatch(fetchSellerExtraValue(paramsData));},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.data]);function onChangePagination(pagination,filter,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column}=sorter;dispatch(setMenuData({activeMenu,data:{...activeMenu.data,perPage,page,column}}));}const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};const allDelete=()=>{if(id===null||id.length===0){toast.warning(t('select.the.product'));}else{setIsModalVisible(true);setText(false);}};return/*#__PURE__*/_jsxs(Card,{title:t('extra.value'),extra:/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(DeleteButton,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:allDelete,children:t('delete.selected')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),onClick:()=>setModal({}),children:t('add.extra')}),/*#__PURE__*/_jsx(FilterColumns,{columns:columns,setColumns:setColumns})]}),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},loading:loading,columns:columns===null||columns===void 0?void 0:columns.filter(item=>item.is_show),rowSelection:rowSelection,dataSource:extraValues,rowKey:record=>record.id,pagination:{pageSize:10,page:((_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.page)||1,total:meta.total,defaultCurrent:(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.page,current:(_activeMenu$data3=activeMenu.data)===null||_activeMenu$data3===void 0?void 0:_activeMenu$data3.page},onChange:onChangePagination}),modal&&/*#__PURE__*/_jsx(ExtraValueModal,{isVisible:modal,modal:modal,handleCancel:handleCancel,paramsData:paramsData}),/*#__PURE__*/_jsx(CustomModal,{click:deleteExtra,text:text?t('delete'):t('all.delete'),loading:loadingBtn,setText:setId})]});}","map":null,"metadata":{},"sourceType":"module"}