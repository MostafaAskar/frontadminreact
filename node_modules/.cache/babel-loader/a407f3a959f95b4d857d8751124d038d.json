{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{Button,Card,Space,Table}from'antd';import{shallowEqual,useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import{useTranslation}from'react-i18next';import{useSelector}from'react-redux';import{addMenu,disableRefetch,setMenuData}from'redux/slices/menu';import{fetchParcelTypes}from'redux/slices/parcelTypes';import DeleteButton from'components/delete-button';import{DeleteOutlined,EditOutlined,PlusCircleOutlined}from'@ant-design/icons';import FilterColumns from'components/filter-column';import CustomModal from'components/modal';import useDidUpdate from'helpers/useDidUpdate';import{Context}from'context/context';import parcelTypeService from'services/parcelType';import{toast}from'react-toastify';import formatSortType from'helpers/formatSortType';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ParcelTypes(){var _activeMenu$data;const{t}=useTranslation();const navigate=useNavigate();const dispatch=useDispatch();const[id,setId]=useState(null);const[text,setText]=useState(null);const[loadingBtn,setLoadingBtn]=useState(false);const{setIsModalVisible}=useContext(Context);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const data=activeMenu===null||activeMenu===void 0?void 0:activeMenu.data;const paramsData={sort:data===null||data===void 0?void 0:data.sort,column:data===null||data===void 0?void 0:data.column,pageSize:data===null||data===void 0?void 0:data.per_page,page:(data===null||data===void 0?void 0:data.page)||1};const{data:types,loading,meta}=useSelector(state=>state.parcelTypes,shallowEqual);const[columns,setColumns]=useState([{title:t('id'),dataIndex:'id',key:'id',is_show:true},{title:t('title'),dataIndex:'type',key:'type',is_show:true},{title:t('options'),key:'options',dataIndex:'options',is_show:true,render:(_,row)=>{return/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>goToEdit(row)}),/*#__PURE__*/_jsx(DeleteButton,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:()=>{setId([row.id]);setIsModalVisible(true);setText(true);}})]});}}]);const goToEdit=row=>{dispatch(addMenu({url:`parcel-types/${row.id}`,id:'edit-parcel-type',name:t('edit.parcel.type')}));navigate(`/parcel-types/${row.id}`);};const goToAdd=()=>{dispatch(addMenu({id:'add-parcel-type',url:`parcel-types/add`,name:t(`add.parcel.type`)}));navigate(`/parcel-types/add`);};const deliveryDelete=()=>{setLoadingBtn(true);const params={...Object.assign({},...id.map((item,index)=>({[`ids[${index}]`]:item})))};parcelTypeService.delete(params).then(()=>{toast.success(t('successfully.deleted'));dispatch(fetchParcelTypes(paramsData));setIsModalVisible(false);setText(null);}).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(activeMenu!==null&&activeMenu!==void 0&&activeMenu.refetch){dispatch(fetchParcelTypes(paramsData));dispatch(disableRefetch(activeMenu));}},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.refetch]);useDidUpdate(()=>{dispatch(fetchParcelTypes(paramsData));},[activeMenu.data]);function onChangePagination(pagination,filters,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column,order}=sorter;const sort=formatSortType(order);dispatch(setMenuData({activeMenu,data:{...data,perPage,page,column,sort}}));}const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};const allDelete=()=>{if(id===null||id.length===0){toast.warning(t('select.the.product'));}else{setIsModalVisible(true);setText(false);}};return/*#__PURE__*/_jsxs(Card,{title:t('parcel.types'),extra:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(DeleteButton,{size:\"\",onClick:allDelete,children:t('delete.selected')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),onClick:goToAdd,children:t('add.parcel.type')}),/*#__PURE__*/_jsx(FilterColumns,{columns:columns,setColumns:setColumns})]}),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},rowSelection:rowSelection,columns:columns===null||columns===void 0?void 0:columns.filter(item=>item.is_show),dataSource:types,pagination:{pageSize:meta.per_page,page:(data===null||data===void 0?void 0:data.page)||1,total:meta.total,defaultCurrent:data===null||data===void 0?void 0:data.page,current:(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.page},rowKey:res=>res.id,onChange:onChangePagination,loading:loading}),/*#__PURE__*/_jsx(CustomModal,{click:deliveryDelete,text:text?t('delete'):t('all.delete'),setText:setId,loading:loadingBtn})]});}","map":null,"metadata":{},"sourceType":"module"}