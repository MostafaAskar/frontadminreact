{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import{Button,Card,Space,Table}from'antd';import{DeleteOutlined,EditOutlined,EyeOutlined,PlusCircleOutlined,PlusOutlined}from'@ant-design/icons';import{toast}from'react-toastify';import{useTranslation}from'react-i18next';import extraService from'../../../../services/seller/extras';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{fetchSellerExtraGroups}from'../../../../redux/slices/extraGroup';import{disableRefetch,setMenuData}from'../../../../redux/slices/menu';import ExtraGroupModal from'./extra-group-modal';import DeleteButton from'../../../../components/delete-button';import ExtraGroupShowModal from'./extra-group-show-modal';import FilterColumns from'../../../../components/filter-column';import CustomModal from'../../../../components/modal';import{Context}from'../../../../context/context';import useDidUpdate from'helpers/useDidUpdate';import SearchInput from'../../../../components/search-input';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SellerExtraGroup(){var _activeMenu$data,_activeMenu$data2,_activeMenu$data3;const{t}=useTranslation();const dispatch=useDispatch();const{setIsModalVisible}=useContext(Context);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{extraGroups,loading,meta}=useSelector(state=>state.extraGroup,shallowEqual);const[id,setId]=useState(null);const[show,setShow]=useState(null);const[modal,setModal]=useState(null);const[loadingBtn,setLoadingBtn]=useState(false);const[text,setText]=useState(null);const data=activeMenu.data;const paramsData={search:data===null||data===void 0?void 0:data.search,column:data===null||data===void 0?void 0:data.column,perPage:data===null||data===void 0?void 0:data.perPage,sort:data===null||data===void 0?void 0:data.sort,page:data===null||data===void 0?void 0:data.page};const[columns,setColumns]=useState([{title:t('id'),dataIndex:'id',key:'id',is_show:true},{title:t('title'),dataIndex:'translation',key:'translation',is_show:true,render:translation=>translation===null||translation===void 0?void 0:translation.title},{title:t('type'),dataIndex:'type',key:'type',is_show:true},{title:t('options'),is_show:true,render:(record,row)=>/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EyeOutlined,{}),onClick:()=>setShow(record.id)}),/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>setModal(record),disabled:!(row!==null&&row!==void 0&&row.shop_id)}),/*#__PURE__*/_jsx(DeleteButton,{type:\"primary\",danger:true,icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:()=>{setIsModalVisible(true);setId([record.id]);setText(true);},disabled:!(row!==null&&row!==void 0&&row.shop_id)})]})}]);const handleCancel=()=>{setShow(null);setModal(null);};const onDeleteExtra=()=>{setLoadingBtn(true);const params={...Object.assign({},...id.map((item,index)=>({[`ids[${index}]`]:item})))};extraService.deleteGroup(params).then(()=>{setIsModalVisible(false);toast.success(t('successfully.deleted'));setId(null);dispatch(fetchSellerExtraGroups());}).finally(()=>setLoadingBtn(false));};useDidUpdate(()=>{dispatch(fetchSellerExtraGroups(paramsData));},[activeMenu.data]);useEffect(()=>{if(activeMenu.refetch){dispatch(fetchSellerExtraGroups(paramsData));dispatch(disableRefetch(activeMenu));}},[activeMenu.refetch]);const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};const allDelete=()=>{if(id===null||id.length===0){toast.warning(t('select.the.product'));}else{setIsModalVisible(true);setText(false);}};const handleFilter=(item,name)=>{dispatch(setMenuData({activeMenu,data:{...activeMenu.data,[name]:item}}));};function onChangePagination(pagination,filter,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column}=sorter;dispatch(setMenuData({activeMenu,data:{...activeMenu.data,perPage,page,column}}));}return/*#__PURE__*/_jsxs(Card,{title:t('extra.group'),extra:/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),onClick:()=>setModal({}),children:t('add.extra')}),/*#__PURE__*/_jsx(DeleteButton,{size:\"\",onClick:allDelete,children:t('delete.selected')}),/*#__PURE__*/_jsx(FilterColumns,{columns:columns,setColumns:setColumns})]}),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},rowSelection:rowSelection,loading:loading,columns:columns===null||columns===void 0?void 0:columns.filter(item=>item.is_show),dataSource:extraGroups,rowKey:record=>record.id,pagination:{pageSize:paramsData.perPage,page:((_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.page)||1,total:meta.total,defaultCurrent:(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.page,current:(_activeMenu$data3=activeMenu.data)===null||_activeMenu$data3===void 0?void 0:_activeMenu$data3.page},onChange:onChangePagination}),modal&&/*#__PURE__*/_jsx(ExtraGroupModal,{modal:modal,handleCancel:handleCancel}),/*#__PURE__*/_jsx(CustomModal,{click:onDeleteExtra,text:text?t('delete'):t('all.delete'),loading:loadingBtn,setText:setId}),show&&/*#__PURE__*/_jsx(ExtraGroupShowModal,{open:show,handleClose:handleCancel})]});}","map":null,"metadata":{},"sourceType":"module"}