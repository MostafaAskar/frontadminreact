{"ast":null,"code":"import{Button,Form,Space}from'antd';import{InfiniteSelect}from'components/infinite-select';import{useState}from'react';import{useTranslation}from'react-i18next';import addressService from'services/rest/address';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LocationSelect=_ref=>{let{onClose,onSubmit,isButtonLoading}=_ref;const{t}=useTranslation();const[links,setLinks]=useState(null);const[selectedCountry,setSelectedCountry]=useState(null);const fetchCountries=_ref2=>{let{search,page}=_ref2;return addressService.getCountries({search,page,has_price:true}).then(res=>{setLinks(res.links);return res.data.map(country=>{var _country$translation;return{label:country===null||country===void 0?void 0:(_country$translation=country.translation)===null||_country$translation===void 0?void 0:_country$translation.title,value:`${country.id},${country.region_id}`};});});};const fetchCities=_ref3=>{let{search,page}=_ref3;return addressService.getCities({search,page,country_id:selectedCountry.value,has_price:true}).then(res=>{setLinks(res.links);const cities=[];if(res.meta.current_page===1){cities.push({label:t('whole.country'),value:'all'});}res.data.forEach(country=>{var _country$translation2;cities.push({label:country===null||country===void 0?void 0:(_country$translation2=country.translation)===null||_country$translation2===void 0?void 0:_country$translation2.title,value:country.id});});return cities;});};return/*#__PURE__*/_jsxs(Form,{layout:\"vertical\",onFinish:onSubmit,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"country\",label:t('country'),rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InfiniteSelect,{hasMore:links===null||links===void 0?void 0:links.next,fetchOptions:fetchCountries,onChange:value=>setSelectedCountry(value)})}),selectedCountry&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Form.Item,{rules:[{required:true,message:t('required')}],name:\"city\",label:t('city'),children:/*#__PURE__*/_jsx(InfiniteSelect,{hasMore:links===null||links===void 0?void 0:links.next,fetchOptions:fetchCities})})}),/*#__PURE__*/_jsxs(Space,{className:\"justify-content-end w-100\",children:[/*#__PURE__*/_jsx(Button,{onClick:onClose,htmlType:\"button\",children:t('cancel')}),/*#__PURE__*/_jsx(Button,{loading:isButtonLoading,htmlType:\"submit\",type:\"primary\",children:t('add')})]})]});};export default LocationSelect;","map":null,"metadata":{},"sourceType":"module"}