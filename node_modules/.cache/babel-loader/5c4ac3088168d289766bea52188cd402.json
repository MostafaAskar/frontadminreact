{"ast":null,"code":"import axios from 'axios';\nimport { notification } from 'antd';\nimport { api_url } from '../configs/app-global';\nimport { store } from '../redux/store';\nimport { clearUser } from '../redux/slices/auth';\nimport i18n from '../configs/i18next';\nimport { toast } from 'react-toastify';\nconst service = axios.create({\n  baseURL: api_url,\n  timeout: 16000\n}); // Config\n\nconst TOKEN_PAYLOAD_KEY = 'authorization';\nconst AUTH_TOKEN = 'token';\nconst AUTH_TOKEN_TYPE = 'Bearer'; // API Request interceptor\n\nservice.interceptors.request.use(config => {\n  const access_token = localStorage.getItem(AUTH_TOKEN);\n\n  if (access_token) {\n    config.headers[TOKEN_PAYLOAD_KEY] = AUTH_TOKEN_TYPE + ' ' + access_token;\n  }\n\n  if (config.method === 'get') {\n    config.params = {\n      lang: i18n.language,\n      ...config.params\n    };\n  }\n\n  return config;\n}, error => {\n  // Do something with request error here\n  notification.error({\n    message: 'Error'\n  });\n  Promise.reject(error);\n}); // API respone interceptor\n\nservice.interceptors.response.use(response => {\n  return response.data;\n}, error => {\n  var _error$response, _error$response$data, _error$response2, _error$response3, _error$response4, _error$response6, _error$response8, _error$response8$data, _error$response11;\n\n  let notificationParam = {\n    message: i18n.t((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message)\n  }; // Remove token and redirect\n\n  if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 403 || ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 401) {\n    localStorage.removeItem(AUTH_TOKEN);\n    store.dispatch(clearUser());\n  }\n\n  if (((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 508) {\n    var _error$response5, _error$response5$data;\n\n    notificationParam.message = (_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.message;\n  }\n\n  if (((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : _error$response6.status) === 500) {\n    var _error$response7, _error$response7$data;\n\n    notificationParam.message = ((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.message) || \"Internal server error\";\n  }\n\n  if ((_error$response8 = error.response) !== null && _error$response8 !== void 0 && (_error$response8$data = _error$response8.data) !== null && _error$response8$data !== void 0 && _error$response8$data.params) {\n    var _error$response9, _error$response9$data;\n\n    if (Object.values((_error$response9 = error.response) === null || _error$response9 === void 0 ? void 0 : (_error$response9$data = _error$response9.data) === null || _error$response9$data === void 0 ? void 0 : _error$response9$data.params)[0]) {\n      var _error$response10, _error$response10$dat;\n\n      notificationParam.message = Object.values((_error$response10 = error.response) === null || _error$response10 === void 0 ? void 0 : (_error$response10$dat = _error$response10.data) === null || _error$response10$dat === void 0 ? void 0 : _error$response10$dat.params)[0].at(0);\n    }\n  }\n\n  toast.error(notificationParam.message, {\n    toastId: (_error$response11 = error.response) === null || _error$response11 === void 0 ? void 0 : _error$response11.status\n  });\n  return Promise.reject(error);\n});\nexport default service;","map":{"version":3,"names":["axios","notification","api_url","store","clearUser","i18n","toast","service","create","baseURL","timeout","TOKEN_PAYLOAD_KEY","AUTH_TOKEN","AUTH_TOKEN_TYPE","interceptors","request","use","config","access_token","localStorage","getItem","headers","method","params","lang","language","error","message","Promise","reject","response","data","notificationParam","t","status","removeItem","dispatch","Object","values","at","toastId"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/services/request.js"],"sourcesContent":["import axios from 'axios';\nimport { notification } from 'antd';\nimport { api_url } from '../configs/app-global';\nimport { store } from '../redux/store';\nimport { clearUser } from '../redux/slices/auth';\nimport i18n from '../configs/i18next';\nimport { toast } from 'react-toastify';\n\nconst service = axios.create({\n  baseURL: api_url,\n  timeout: 16000,\n});\n\n// Config\nconst TOKEN_PAYLOAD_KEY = 'authorization';\nconst AUTH_TOKEN = 'token';\nconst AUTH_TOKEN_TYPE = 'Bearer';\n\n// API Request interceptor\nservice.interceptors.request.use(\n  (config) => {\n    const access_token = localStorage.getItem(AUTH_TOKEN);\n\n    if (access_token) {\n      config.headers[TOKEN_PAYLOAD_KEY] = AUTH_TOKEN_TYPE + ' ' + access_token;\n    }\n    if (config.method === 'get') {\n      config.params = { lang: i18n.language, ...config.params };\n    }\n\n    return config;\n  },\n  (error) => {\n    // Do something with request error here\n    notification.error({\n      message: 'Error',\n    });\n    Promise.reject(error);\n  }\n);\n\n// API respone interceptor\nservice.interceptors.response.use(\n  (response) => {\n    return response.data;\n  },\n  (error) => {\n    let notificationParam = {\n      message: i18n.t(error.response?.data?.message),\n    };\n\n    // Remove token and redirect\n    if (error.response?.status === 403 || error.response?.status === 401) {\n      localStorage.removeItem(AUTH_TOKEN);\n      store.dispatch(clearUser());\n    }\n\n    if (error.response?.status === 508) {\n      notificationParam.message = error.response?.data?.message;\n    }\n\n    if (error.response?.status === 500) {\n      notificationParam.message = error.response?.data?.message || \"Internal server error\";\n    }\n\n    if(error.response?.data?.params) {\n      if(Object.values(error.response?.data?.params)[0]){\n        notificationParam.message = Object.values(error.response?.data?.params)[0].at(0)\n      }\n    }\n\n    toast.error(notificationParam.message, {\n      toastId: error.response?.status,\n    });\n    return Promise.reject(error);\n  }\n);\n\nexport default service;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}