{"ast":null,"code":"import React,{useState}from'react';import{Button,Col,Form,Input,InputNumber,Modal,Row}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import{setRefetch}from'../../redux/slices/menu';import{AsyncSelect}from'../../components/async-select';import userService from'../../services/user';import currencyService from'../../services/currency';import paymentService from'../../services/payment';import{payoutService}from'../../services/payout';import{RefetchSearch}from'components/refetch-search';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PayoutRequestModal(_ref){var _data$currency,_data$currency2,_data$currency3,_data$payment,_data$payment2,_data$createdBy,_data$createdBy2,_data$createdBy3;let{data,handleCancel}=_ref;const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[loading,setLoading]=useState(false);const dispatch=useDispatch();const handleFinish=values=>{var _values$created_by,_values$payment_id,_values$currency_id;const payload={cause:values.cause,price:values.price,created_by:values===null||values===void 0?void 0:(_values$created_by=values.created_by)===null||_values$created_by===void 0?void 0:_values$created_by.value,payment_id:values===null||values===void 0?void 0:(_values$payment_id=values.payment_id)===null||_values$payment_id===void 0?void 0:_values$payment_id.value,currency_id:values===null||values===void 0?void 0:(_values$currency_id=values.currency_id)===null||_values$currency_id===void 0?void 0:_values$currency_id.value,answer:values.answer};setLoading(true);if(data!==null&&data!==void 0&&data.id){payoutService.update(data.id,payload).then(()=>{handleCancel();dispatch(setRefetch(activeMenu));}).finally(()=>setLoading(false));}else{payoutService.create(payload).then(()=>{handleCancel();dispatch(setRefetch(activeMenu));}).finally(()=>setLoading(false));}};return/*#__PURE__*/_jsx(Modal,{visible:!!data,title:t('pay.to.seller'),onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{onClick:handleCancel,children:t('cancel')},'calcel-btn'),/*#__PURE__*/_jsx(Button,{type:\"primary\",form:\"form\",htmlType:\"submit\"// onClick={acceptRequest}\n,loading:loading,children:data!==null&&data!==void 0&&data.id?t('edit'):t('create')},'pay-btn')],children:/*#__PURE__*/_jsx(Form,{initialValues:{cause:data===null||data===void 0?void 0:data.cause,price:data===null||data===void 0?void 0:data.price,answer:data===null||data===void 0?void 0:data.answer,currency_id:(data===null||data===void 0?void 0:data.currency)&&{value:data===null||data===void 0?void 0:(_data$currency=data.currency)===null||_data$currency===void 0?void 0:_data$currency.id,label:`${data===null||data===void 0?void 0:(_data$currency2=data.currency)===null||_data$currency2===void 0?void 0:_data$currency2.title} (${data===null||data===void 0?void 0:(_data$currency3=data.currency)===null||_data$currency3===void 0?void 0:_data$currency3.symbol})`},payment_id:(data===null||data===void 0?void 0:data.payment)&&{value:data===null||data===void 0?void 0:(_data$payment=data.payment)===null||_data$payment===void 0?void 0:_data$payment.id,label:data===null||data===void 0?void 0:(_data$payment2=data.payment)===null||_data$payment2===void 0?void 0:_data$payment2.tag},created_by:(data===null||data===void 0?void 0:data.createdBy)&&{value:data===null||data===void 0?void 0:(_data$createdBy=data.createdBy)===null||_data$createdBy===void 0?void 0:_data$createdBy.id,label:`${data===null||data===void 0?void 0:(_data$createdBy2=data.createdBy)===null||_data$createdBy2===void 0?void 0:_data$createdBy2.firstname} ${(data===null||data===void 0?void 0:(_data$createdBy3=data.createdBy)===null||_data$createdBy3===void 0?void 0:_data$createdBy3.lastname)||''}`}},onFinish:handleFinish,id:\"form\",layout:\"vertical\",children:/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"created_by\",rules:[{required:true,message:t('required')}],label:t('seller'),children:/*#__PURE__*/_jsx(RefetchSearch,{className:\"w-100\",placeholder:t('select.seller'),fetchOptions:search=>userService.getAll({role:'seller',search}).then(_ref2=>{let{data}=_ref2;return data.map(item=>({value:item.id,label:`${item.firstname} ${item.lastname||''}`,key:item.id}));})})}),/*#__PURE__*/_jsx(Form.Item,{name:\"payment_id\",rules:[{required:true,message:t('required')}],label:t('payment'),children:/*#__PURE__*/_jsx(AsyncSelect,{className:\"w-100\",placeholder:t('select.payment.type'),fetchOptions:()=>paymentService.getAll().then(_ref3=>{let{data}=_ref3;return data.filter(item=>item.active&&item.tag==='wallet').map(item=>({value:item.id,label:item.tag,key:item.id}));})})})]}),/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"currency_id\",rules:[{required:true,message:t('required')}],label:t('currency'),children:/*#__PURE__*/_jsx(AsyncSelect,{className:\"w-100\",placeholder:t('select.currency'),fetchOptions:()=>currencyService.getAll().then(_ref4=>{let{data}=_ref4;return data.filter(item=>item.active).map(item=>({value:item.id,label:`${item.title} (${item.symbol||''})`,key:item.id}));})})}),/*#__PURE__*/_jsx(Form.Item,{name:\"price\",rules:[{required:true,message:t('required')}],label:t('price'),children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",placeholder:t('amount'),min:0})})]}),/*#__PURE__*/_jsxs(Col,{span:24,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"cause\",rules:[{validator(_,value){if(!value){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],label:t('cause'),children:/*#__PURE__*/_jsx(Input.TextArea,{showCount:true,maxLength:100,placeholder:t('cause')})}),/*#__PURE__*/_jsx(Form.Item,{name:\"answer\",label:t('answer'),rules:[{validator(_,value){if(!value){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],children:/*#__PURE__*/_jsx(Input.TextArea,{showCount:true,maxLength:100,placeholder:t('answer')})})]})]})})});}","map":null,"metadata":{},"sourceType":"module"}