{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Col,Form,Input,Row,Select,Switch}from'antd';import{toast}from'react-toastify';import TextArea from'antd/es/input/TextArea';import{shallowEqual,useSelector}from'react-redux';import categoryService from'services/seller/category';import{useTranslation}from'react-i18next';import MediaUpload from'components/upload';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const SubcategoryAdd=_ref=>{var _activeMenu$data,_activeMenu$data2;let{parent={},setId,setIsRefetch}=_ref;const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[image,setImage]=useState((_activeMenu$data=activeMenu.data)!==null&&_activeMenu$data!==void 0&&_activeMenu$data.image?[(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.image]:[]);const[form]=Form.useForm();const[loadingBtn,setLoadingBtn]=useState(false);const[error,setError]=useState(null);const{defaultLang,languages}=useSelector(state=>state.formLang,shallowEqual);useEffect(()=>{return()=>{form.resetFields();};},[]);const onFinish=values=>{var _values$parent_id,_image$;setLoadingBtn(true);const body={...values,type:(parent===null||parent===void 0?void 0:parent.type)==='main'?'sub_main':'child',active:values.active?1:0,keywords:values.keywords.join(','),parent_id:(_values$parent_id=values.parent_id)===null||_values$parent_id===void 0?void 0:_values$parent_id.value,'images[0]':(_image$=image[0])===null||_image$===void 0?void 0:_image$.name};categoryService.create(body).then(()=>{toast.success(t('successfully.created'));setId(null);form.resetFields();setIsRefetch(true);}).catch(err=>setError(err.response.data.params)).finally(()=>setLoadingBtn(false));};if(!(parent!==null&&parent!==void 0&&parent.id))return'';return/*#__PURE__*/_jsxs(Form,{name:\"basic\",layout:\"vertical\",onFinish:onFinish,initialValues:{active:true,...parent},form:form,children:[/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('parent.category'),name:\"parent_id\",rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{disabled:true})})}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map((item,index)=>/*#__PURE__*/_jsx(Form.Item,{label:t('name'),name:`title[${item.locale}]`,help:error?error[`title.${defaultLang}`]?error[`title.${defaultLang}`][0]:null:null,validateStatus:error?'error':'success',rules:[{required:true,validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{placeholder:t('name')})},item.title+index))}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map((item,index)=>/*#__PURE__*/_jsx(Form.Item,{label:t('description'),name:`description[${item.locale}]`,rules:[{required:true,validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<5){return Promise.reject(new Error(t('must.be.at.least.5')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(TextArea,{rows:4})},item.locale+index))}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('keywords'),name:\"keywords\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{mode:\"tags\",style:{width:'100%'}})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('image'),name:\"images\",rules:[{validator(){if((image===null||image===void 0?void 0:image.length)===0){return Promise.reject(new Error(t('required')));}return Promise.resolve();}}],children:/*#__PURE__*/_jsx(MediaUpload,{type:\"categories\",imageList:image,setImageList:setImage,form:form,multiple:false})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('active'),name:\"active\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Switch,{})})})]}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,className:\"w-100\",children:t('submit')})]});};export default SubcategoryAdd;","map":null,"metadata":{},"sourceType":"module"}