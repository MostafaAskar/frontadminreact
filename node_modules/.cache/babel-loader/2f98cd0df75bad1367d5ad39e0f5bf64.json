{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/subscriptions/subscriptionModal.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Button, Card, Col, Modal, Row } from 'antd';\nimport { useTranslation } from 'react-i18next';\nimport subscriptionService from 'services/seller/subscriptions';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { fetchRestPayments } from 'redux/slices/payment';\nimport Loading from 'components/loading';\nimport { toast } from 'react-toastify';\nimport { fetchMyShop } from 'redux/slices/myShop';\nimport Paystack from 'assets/images/paystack.svg';\nimport { FaPaypal } from 'react-icons/fa';\nimport { SiStripe, SiRazorpay } from 'react-icons/si';\nimport { AiOutlineWallet } from 'react-icons/ai';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst acceptedPayments = ['wallet'];\nexport default function SellerSubscriptionModal(_ref) {\n  _s();\n\n  var _payments$filter;\n\n  let {\n    modal,\n    handleCancel\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const dispatch = useDispatch();\n  const {\n    seller\n  } = useSelector(state => state.myShop.myShop, shallowEqual);\n  const [loadingBtn, setLoadingBtn] = useState(false);\n  const [paymentType, setPaymentType] = useState({});\n  const {\n    payments,\n    loading\n  } = useSelector(state => state.payment, shallowEqual);\n  useEffect(() => {\n    dispatch(fetchRestPayments({}));\n  }, []);\n\n  const handleSubmit = () => {\n    var _seller$wallet;\n\n    if (!paymentType.id) {\n      toast.warning(t('please.select.payment.type'));\n      return;\n    }\n\n    if (paymentType.tag === 'wallet' && (seller === null || seller === void 0 ? void 0 : (_seller$wallet = seller.wallet) === null || _seller$wallet === void 0 ? void 0 : _seller$wallet.price) < modal.price) {\n      toast.warning(t('insufficient.balance'));\n      return;\n    }\n\n    setLoadingBtn(true);\n    subscriptionService.attach(modal.id).then(_ref2 => {\n      let {\n        data\n      } = _ref2;\n      return transactionCreate(data.id);\n    }).error(() => setLoadingBtn(false));\n  };\n\n  function transactionCreate(id) {\n    const payload = {\n      payment_sys_id: paymentType.id\n    };\n    subscriptionService.transactionCreate(id, payload).then(() => {\n      handleCancel();\n      toast.success(t('successfully.purchased'));\n      dispatch(fetchMyShop({}));\n    }).finally(() => setLoadingBtn(false));\n  }\n\n  const selectPayment = type => {\n    if (!acceptedPayments.includes(type.tag)) {\n      toast.warning(t('cannot.work.demo'));\n      return;\n    }\n\n    setPaymentType(type);\n  };\n\n  const handleAddIcon = data => {\n    switch (data) {\n      case 'wallet':\n        return /*#__PURE__*/_jsxDEV(AiOutlineWallet, {\n          size: 80\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 16\n        }, this);\n\n      case 'paypal':\n        return /*#__PURE__*/_jsxDEV(FaPaypal, {\n          size: 80\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 16\n        }, this);\n\n      case 'stripe':\n        return /*#__PURE__*/_jsxDEV(SiStripe, {\n          size: 80\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 16\n        }, this);\n\n      case 'razorpay':\n        return /*#__PURE__*/_jsxDEV(SiRazorpay, {\n          size: 80\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 16\n        }, this);\n\n      case 'paystack':\n        return /*#__PURE__*/_jsxDEV(\"img\", {\n          src: Paystack,\n          alt: \"img\",\n          width: \"80\",\n          height: \"80\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 16\n        }, this);\n\n      default:\n        return /*#__PURE__*/_jsxDEV(AiOutlineWallet, {\n          size: 80\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 16\n        }, this);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    visible: !!modal,\n    title: t('purchase.subscription'),\n    onCancel: handleCancel,\n    footer: [/*#__PURE__*/_jsxDEV(Button, {\n      type: \"primary\",\n      onClick: handleSubmit,\n      loading: loadingBtn,\n      children: t('save')\n    }, 'save-btn', false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      type: \"default\",\n      onClick: handleCancel,\n      children: t('cancel')\n    }, 'cancel-btn', false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }, this)],\n    children: !loading ? /*#__PURE__*/_jsxDEV(Row, {\n      gutter: 12,\n      children: payments === null || payments === void 0 ? void 0 : (_payments$filter = payments.filter(item => (item === null || item === void 0 ? void 0 : item.tag) !== 'cash')) === null || _payments$filter === void 0 ? void 0 : _payments$filter.map((item, index) => /*#__PURE__*/_jsxDEV(Col, {\n        span: 8,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: `payment-card ${(paymentType === null || paymentType === void 0 ? void 0 : paymentType.tag) === item.tag ? 'active' : ''}`,\n          onClick: () => selectPayment(item),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"payment-icon\",\n            children: handleAddIcon(item === null || item === void 0 ? void 0 : item.tag)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-weight-bold mt-2\",\n            children: t(item === null || item === void 0 ? void 0 : item.tag)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n\n_s(SellerSubscriptionModal, \"30X3vu1LgdJFRK4yElKdq/dqJvU=\", false, function () {\n  return [useTranslation, useDispatch, useSelector, useSelector];\n});\n\n_c = SellerSubscriptionModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"SellerSubscriptionModal\");","map":{"version":3,"names":["React","useEffect","useState","Button","Card","Col","Modal","Row","useTranslation","subscriptionService","shallowEqual","useDispatch","useSelector","fetchRestPayments","Loading","toast","fetchMyShop","Paystack","FaPaypal","SiStripe","SiRazorpay","AiOutlineWallet","acceptedPayments","SellerSubscriptionModal","modal","handleCancel","t","dispatch","seller","state","myShop","loadingBtn","setLoadingBtn","paymentType","setPaymentType","payments","loading","payment","handleSubmit","id","warning","tag","wallet","price","attach","then","data","transactionCreate","error","payload","payment_sys_id","success","finally","selectPayment","type","includes","handleAddIcon","filter","item","map","index"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/subscriptions/subscriptionModal.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Button, Card, Col, Modal, Row } from 'antd';\nimport { useTranslation } from 'react-i18next';\nimport subscriptionService from 'services/seller/subscriptions';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { fetchRestPayments } from 'redux/slices/payment';\nimport Loading from 'components/loading';\nimport { toast } from 'react-toastify';\nimport { fetchMyShop } from 'redux/slices/myShop';\nimport Paystack from 'assets/images/paystack.svg';\nimport { FaPaypal } from 'react-icons/fa';\nimport { SiStripe, SiRazorpay } from 'react-icons/si';\nimport { AiOutlineWallet } from 'react-icons/ai';\nconst acceptedPayments = ['wallet'];\n\nexport default function SellerSubscriptionModal({ modal, handleCancel }) {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const { seller } = useSelector((state) => state.myShop.myShop, shallowEqual);\n  const [loadingBtn, setLoadingBtn] = useState(false);\n  const [paymentType, setPaymentType] = useState({});\n\n  const { payments, loading } = useSelector(\n    (state) => state.payment,\n    shallowEqual\n  );\n\n  useEffect(() => {\n    dispatch(fetchRestPayments({}));\n  }, []);\n\n  const handleSubmit = () => {\n    if (!paymentType.id) {\n      toast.warning(t('please.select.payment.type'));\n      return;\n    }\n    if (paymentType.tag === 'wallet' && seller?.wallet?.price < modal.price) {\n      toast.warning(t('insufficient.balance'));\n      return;\n    }\n    setLoadingBtn(true);\n    subscriptionService\n      .attach(modal.id)\n      .then(({ data }) => transactionCreate(data.id))\n      .error(() => setLoadingBtn(false));\n  };\n\n  function transactionCreate(id) {\n    const payload = {\n      payment_sys_id: paymentType.id,\n    };\n    subscriptionService\n      .transactionCreate(id, payload)\n      .then(() => {\n        handleCancel();\n        toast.success(t('successfully.purchased'));\n        dispatch(fetchMyShop({}));\n      })\n      .finally(() => setLoadingBtn(false));\n  }\n\n  const selectPayment = (type) => {\n    if (!acceptedPayments.includes(type.tag)) {\n      toast.warning(t('cannot.work.demo'));\n      return;\n    }\n    setPaymentType(type);\n  };\n\n  const handleAddIcon = (data) => {\n    switch (data) {\n      case 'wallet':\n        return <AiOutlineWallet size={80} />;\n      case 'paypal':\n        return <FaPaypal size={80} />;\n      case 'stripe':\n        return <SiStripe size={80} />;\n      case 'razorpay':\n        return <SiRazorpay size={80} />;\n      case 'paystack':\n        return <img src={Paystack} alt='img' width='80' height='80' />;\n      default:\n        return <AiOutlineWallet size={80} />;\n    }\n  };\n\n  return (\n    <Modal\n      visible={!!modal}\n      title={t('purchase.subscription')}\n      onCancel={handleCancel}\n      footer={[\n        <Button\n          type='primary'\n          onClick={handleSubmit}\n          loading={loadingBtn}\n          key='save-btn'\n        >\n          {t('save')}\n        </Button>,\n        <Button type='default' onClick={handleCancel} key='cancel-btn'>\n          {t('cancel')}\n        </Button>,\n      ]}\n    >\n      {!loading ? (\n        <Row gutter={12}>\n          {payments\n            ?.filter((item) => item?.tag !== 'cash')\n            ?.map((item, index) => (\n              <Col span={8} key={index}>\n                <Card\n                  className={`payment-card ${\n                    paymentType?.tag === item.tag ? 'active' : ''\n                  }`}\n                  onClick={() => selectPayment(item)}\n                >\n                  <div className='payment-icon'>{handleAddIcon(item?.tag)}</div>\n                  <div className='font-weight-bold mt-2'>{t(item?.tag)}</div>\n                </Card>\n              </Col>\n            ))}\n        </Row>\n      ) : (\n        <Loading />\n      )}\n    </Modal>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}