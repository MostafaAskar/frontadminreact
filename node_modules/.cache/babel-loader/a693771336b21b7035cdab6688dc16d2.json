{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Button,Col,Form,Input,InputNumber,Row,Space}from'antd';import{useNavigate}from'react-router-dom';import{shallowEqual,useDispatch,useSelector}from'react-redux';import userService from'../../services/user';import{toast}from'react-toastify';import{removeFromMenu}from'../../redux/slices/menu';import moment from'moment';import{useTranslation}from'react-i18next';import Loading from'../../components/loading';import useDemo from'../../helpers/useDemo';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserEdit(_ref){var _activeMenu$data3;let{prev}=_ref;const{isDemo}=useDemo();const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const dispatch=useDispatch();const navigate=useNavigate();const[error,setError]=useState(null);const[loadingBtn,setLoadingBtn]=useState(false);const[loading,setLoading]=useState(false);const[form]=Form.useForm();console.log(isDemo);const showUserData=uuid=>{setLoading(true);userService.getById(uuid).then(res=>{const data=res.data;form.setFieldsValue({firstname:data.firstname,lastname:data.lastname,email:data.email,phone:data.phone,password_confirmation:data.password_confirmation,password:data.password});}).finally(()=>setLoading(false));};const onFinish=values=>{var _activeMenu$data,_activeMenu$data$sell;setLoadingBtn(true);const body={firstname:values.firstname,lastname:values.lastname,email:values.email,phone:values.phone,password_confirmation:values.password_confirmation,password:values.password};const nextUrl='restaurants';userService.update(activeMenu===null||activeMenu===void 0?void 0:(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:(_activeMenu$data$sell=_activeMenu$data.seller)===null||_activeMenu$data$sell===void 0?void 0:_activeMenu$data$sell.uuid,body).then(()=>{toast.success(t('successfully.updated'));navigate(`/${nextUrl}`);dispatch(removeFromMenu({...activeMenu,nextUrl}));}).catch(err=>setError(err.response.data.params)).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(activeMenu!==null&&activeMenu!==void 0&&activeMenu.data){var _activeMenu$data2,_activeMenu$data2$sel;showUserData(activeMenu===null||activeMenu===void 0?void 0:(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:(_activeMenu$data2$sel=_activeMenu$data2.seller)===null||_activeMenu$data2$sel===void 0?void 0:_activeMenu$data2$sel.uuid);}},[]);return/*#__PURE__*/_jsx(_Fragment,{children:!loading?/*#__PURE__*/_jsx(Form,{form:form,layout:\"vertical\",initialValues:{gender:'male',role:'admin',...activeMenu.data,birthday:(_activeMenu$data3=activeMenu.data)!==null&&_activeMenu$data3!==void 0&&_activeMenu$data3.birthday?moment(activeMenu.data.birthday):null},onFinish:onFinish,className:\"py-4\",children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('firstname'),name:\"firstname\",help:error!==null&&error!==void 0&&error.firstname?error.firstname[0]:null,validateStatus:error!==null&&error!==void 0&&error.firstname?'error':'success',rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('lastname'),name:\"lastname\",help:error!==null&&error!==void 0&&error.lastname?error.lastname[0]:null,validateStatus:error!==null&&error!==void 0&&error.lastname?'error':'success',rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),isDemo||/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('phone'),name:\"phone\",help:error!==null&&error!==void 0&&error.phone?error.phone[0]:null,validateStatus:error!==null&&error!==void 0&&error.phone?'error':'success',rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{min:0,className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('email'),name:\"email\",help:error!==null&&error!==void 0&&error.email?error.email[0]:null,validateStatus:error!==null&&error!==void 0&&error.email?'error':'success',rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{type:\"email\",className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('password'),name:\"password\",help:error!==null&&error!==void 0&&error.password?error.password[0]:null,validateStatus:error!==null&&error!==void 0&&error.password?'error':'success',rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(Input.Password,{type:\"password\",className:\"w-100\",autoComplete:\"off\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('password.confirmation'),help:error!==null&&error!==void 0&&error.password_confirmation?error.password_confirmation[0]:null,validateStatus:error!==null&&error!==void 0&&error.password_confirmation?'error':'success',name:\"password_confirmation\",dependencies:['password'],hasFeedback:true,rules:[{required:false,message:t('required')},_ref2=>{let{getFieldValue}=_ref2;return{validator(rule,value){if(!value||getFieldValue('password')===value){return Promise.resolve();}return Promise.reject(t('passwords.do.not.match'));}};}],children:/*#__PURE__*/_jsx(Input.Password,{type:\"password\",className:\"w-100\",autoComplete:\"off\"})})})]}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('save')}),/*#__PURE__*/_jsx(Button,{htmlType:\"submit\",onClick:()=>prev(),children:t('prev')})]})})]})}):/*#__PURE__*/_jsx(Loading,{})});}","map":null,"metadata":{},"sourceType":"module"}