{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Card,Steps}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,setMenuData}from'redux/slices/menu';import LanguageList from'components/language-list';import shopService from'services/seller/shop';import{useTranslation}from'react-i18next';import{useQueryParams}from'helpers/useQueryParams';import ShopMain from'./main';import Delivery from'./shopDelivery';import Loading from'components/loading';import ShopLocations from'components/shop/seller-shop-locations';import ShopSocial from'./social';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const{Step}=Steps;export const steps=[{title:'shop',content:'First-content'},{title:'shop.locations',content:'Second-content'},{title:'social',content:'Third-content'},{title:'delivery',content:'Fourth-content'}];export default function MyShopEdit(){var _queryParams$values,_queryParams$values3;const{t}=useTranslation();const dispatch=useDispatch();const queryParams=useQueryParams();const current=Number(((_queryParams$values=queryParams.values)===null||_queryParams$values===void 0?void 0:_queryParams$values.step)||0);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{languages}=useSelector(state=>state.formLang,shallowEqual);const[loading,setLoading]=useState(false);const fetchShop=()=>{setLoading(true);shopService.get().then(res=>{var _res$data,_res$data2,_res$data3,_res$data3$seller,_res$data4,_res$data4$seller,_res$data5,_res$data6,_res$data7,_res$data8,_res$data8$categories,_res$data9,_res$data9$tags,_res$data10,_res$data11,_res$data12,_res$data13,_res$data14;const data={...res.data,...getLanguageFields(res.data),logo_img:createImages((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.logo_img),background_img:createImages((_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.background_img),user:{label:`${res.data.seller.firstname||''} ${((_res$data3=res.data)===null||_res$data3===void 0?void 0:(_res$data3$seller=_res$data3.seller)===null||_res$data3$seller===void 0?void 0:_res$data3$seller.lastname)||''}`,value:(_res$data4=res.data)===null||_res$data4===void 0?void 0:(_res$data4$seller=_res$data4.seller)===null||_res$data4$seller===void 0?void 0:_res$data4$seller.id},delivery_time_from:((_res$data5=res.data)===null||_res$data5===void 0?void 0:_res$data5.delivery_time.from)||0,delivery_time_to:((_res$data6=res.data)===null||_res$data6===void 0?void 0:_res$data6.delivery_time.to)||0,delivery_time_type:(_res$data7=res.data)===null||_res$data7===void 0?void 0:_res$data7.delivery_time.type,categories:(_res$data8=res.data)===null||_res$data8===void 0?void 0:(_res$data8$categories=_res$data8.categories)===null||_res$data8$categories===void 0?void 0:_res$data8$categories.map(item=>{var _item$translation;return{label:item===null||item===void 0?void 0:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item.id,key:item.id};}),tags:(_res$data9=res.data)===null||_res$data9===void 0?void 0:(_res$data9$tags=_res$data9.tags)===null||_res$data9$tags===void 0?void 0:_res$data9$tags.map(item=>{var _item$translation2;return{label:item===null||item===void 0?void 0:(_item$translation2=item.translation)===null||_item$translation2===void 0?void 0:_item$translation2.title,value:item.id,key:item.id};}),price:((_res$data10=res.data)===null||_res$data10===void 0?void 0:_res$data10.price)||0,price_per_km:((_res$data11=res.data)===null||_res$data11===void 0?void 0:_res$data11.price_per_km)||0,min_amount:((_res$data12=res.data)===null||_res$data12===void 0?void 0:_res$data12.min_amount)||0,tax:((_res$data13=res.data)===null||_res$data13===void 0?void 0:_res$data13.tax)||0,percentage:((_res$data14=res.data)===null||_res$data14===void 0?void 0:_res$data14.percentage)||0};dispatch(setMenuData({activeMenu,data}));}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const createImages=items=>{return{items,uid:items,url:items,name:items};};function getLanguageFields(data){if(!(data!==null&&data!==void 0&&data.translations)){return{};}const{translations}=data;const result=languages.map(item=>{var _translations$find,_translations$find2,_translations$find3;return{[`title[${item.locale}]`]:(_translations$find=translations.find(el=>el.locale===item.locale))===null||_translations$find===void 0?void 0:_translations$find.title,[`description[${item.locale}]`]:(_translations$find2=translations.find(el=>el.locale===item.locale))===null||_translations$find2===void 0?void 0:_translations$find2.description,[`address[${item.locale}]`]:(_translations$find3=translations.find(el=>el.locale===item.locale))===null||_translations$find3===void 0?void 0:_translations$find3.address};});return Object.assign({},...result);}useEffect(()=>{var _queryParams$values2;if(activeMenu.refetch||(_queryParams$values2=queryParams.values)!==null&&_queryParams$values2!==void 0&&_queryParams$values2.step){fetchShop();}},[activeMenu.refetch,(_queryParams$values3=queryParams.values)===null||_queryParams$values3===void 0?void 0:_queryParams$values3.step]);const next=()=>{const step=current+1;queryParams.set('step',step);};const prev=()=>{const step=current-1;queryParams.set('step',step);};const onChange=step=>{dispatch(setMenuData({activeMenu,data:{...activeMenu.data,step}}));queryParams.set('step',step);};return/*#__PURE__*/_jsxs(Card,{title:t('shop.edit'),extra:/*#__PURE__*/_jsx(LanguageList,{}),children:[/*#__PURE__*/_jsx(Steps,{current:current,onChange:onChange,children:steps.map(item=>/*#__PURE__*/_jsx(Step,{title:t(item.title)},item.title))}),!loading?/*#__PURE__*/_jsxs(\"div\",{className:\"steps-content\",children:[steps[current].content==='First-content'&&/*#__PURE__*/_jsx(ShopMain,{next:next,loading:loading}),steps[current].content==='Second-content'&&/*#__PURE__*/_jsx(ShopLocations,{prev:prev,next:next}),steps[current].content==='Third-content'&&/*#__PURE__*/_jsx(ShopSocial,{prev:prev,next:next}),steps[current].content==='Fourth-content'&&/*#__PURE__*/_jsx(Delivery,{prev:prev})]}):/*#__PURE__*/_jsx(Loading,{})]});}","map":null,"metadata":{},"sourceType":"module"}