{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/user/userRoleModal.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Button, Form, Modal, Select } from 'antd';\nimport userService from '../../services/user';\nimport { shallowEqual, useDispatch } from 'react-redux';\nimport { fetchUsers } from '../../redux/slices/user';\nimport { toast } from 'react-toastify';\nimport { useTranslation } from 'react-i18next';\nimport { fetchClients } from '../../redux/slices/client';\nimport { DebounceSelect } from '../../components/search';\nimport shopService from '../../services/restaurant';\nimport { useSelector } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function UserRoleModal(_ref) {\n  _s();\n\n  let {\n    data,\n    handleCancel\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const [form] = Form.useForm();\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const [role, setRole] = useState(data.role);\n  const {\n    user\n  } = useSelector(state => state.auth, shallowEqual);\n  const roleList = [{\n    label: t('user'),\n    value: 'user',\n    key: 1\n  }, {\n    label: t('manager'),\n    value: 'manager',\n    key: 2\n  }, {\n    label: t('moderator'),\n    value: 'moderator',\n    key: 3\n  }];\n  const menegerRoleList = [{\n    label: t('user'),\n    value: 'user',\n    key: 4\n  }, {\n    label: t('moderator'),\n    value: 'moderator',\n    key: 5\n  }];\n\n  function changeRole(uuid, role) {\n    setLoading(true);\n    userService.updateRole(uuid, {\n      role\n    }).then(() => {\n      toast.success(t('successfully.updated'));\n\n      if (data.role === 'user') {\n        dispatch(fetchClients());\n      } else {\n        dispatch(fetchUsers({\n          role: data.role\n        }));\n      }\n\n      handleCancel();\n    }).finally(() => setLoading(false));\n  }\n\n  const onFinish = values => {\n    changeRole(data.uuid, values.role);\n  };\n\n  const ChangeRole = e => setRole(e);\n\n  async function fetchUserShop(search) {\n    const params = {\n      search,\n      status: 'approved'\n    };\n    return shopService.search(params).then(res => res.data.map(item => ({\n      label: item.translation !== null ? item.translation.title : 'no name',\n      value: item.id\n    })));\n  }\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    visible: !!data,\n    title: t('change.user.role'),\n    onCancel: handleCancel,\n    footer: [/*#__PURE__*/_jsxDEV(Button, {\n      type: \"primary\",\n      onClick: () => form.submit(),\n      loading: loading,\n      children: t('save')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      type: \"default\",\n      onClick: handleCancel,\n      children: t('cancel')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this)],\n    children: /*#__PURE__*/_jsxDEV(Form, {\n      layout: \"vertical\",\n      name: \"user-role\",\n      form: form,\n      onFinish: onFinish,\n      initialValues: data,\n      children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n        name: \"role\",\n        label: t('role'),\n        rules: [{\n          required: true,\n          message: t('required')\n        }],\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          className: \"w-100\",\n          options: user.role === 'manager' ? menegerRoleList : roleList,\n          onChange: ChangeRole\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), role !== 'manager' && role !== 'user' ? /*#__PURE__*/_jsxDEV(Form.Item, {\n        label: t('shop'),\n        name: \"shop_id\",\n        rules: [{\n          required: true,\n          message: t('required')\n        }],\n        children: /*#__PURE__*/_jsxDEV(DebounceSelect, {\n          className: \"w-100\",\n          placeholder: t('select.shop'),\n          fetchOptions: fetchUserShop,\n          allowClear: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this) : undefined]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UserRoleModal, \"GFJXerHbS5Sajmg1Z+cBi+lV1Ys=\", false, function () {\n  return [useTranslation, Form.useForm, useDispatch, useSelector];\n});\n\n_c = UserRoleModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserRoleModal\");","map":{"version":3,"names":["React","useState","Button","Form","Modal","Select","userService","shallowEqual","useDispatch","fetchUsers","toast","useTranslation","fetchClients","DebounceSelect","shopService","useSelector","UserRoleModal","data","handleCancel","t","form","useForm","dispatch","loading","setLoading","role","setRole","user","state","auth","roleList","label","value","key","menegerRoleList","changeRole","uuid","updateRole","then","success","finally","onFinish","values","ChangeRole","e","fetchUserShop","search","params","status","res","map","item","translation","title","id","submit","required","message","undefined"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/user/userRoleModal.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Button, Form, Modal, Select } from 'antd';\nimport userService from '../../services/user';\nimport { shallowEqual, useDispatch } from 'react-redux';\nimport { fetchUsers } from '../../redux/slices/user';\nimport { toast } from 'react-toastify';\nimport { useTranslation } from 'react-i18next';\nimport { fetchClients } from '../../redux/slices/client';\nimport { DebounceSelect } from '../../components/search';\nimport shopService from '../../services/restaurant';\nimport { useSelector } from 'react-redux';\n\nexport default function UserRoleModal({ data, handleCancel }) {\n  const { t } = useTranslation();\n  const [form] = Form.useForm();\n  const dispatch = useDispatch();\n  const [loading, setLoading] = useState(false);\n  const [role, setRole] = useState(data.role);\n  const { user } = useSelector((state) => state.auth, shallowEqual);\n  const roleList = [\n    { label: t('user'), value: 'user', key: 1 },\n    { label: t('manager'), value: 'manager', key: 2 },\n    { label: t('moderator'), value: 'moderator', key: 3 },\n  ];\n  const menegerRoleList = [\n    { label: t('user'), value: 'user', key: 4 },\n    { label: t('moderator'), value: 'moderator', key: 5 },\n  ];\n\n  function changeRole(uuid, role) {\n    setLoading(true);\n    userService\n      .updateRole(uuid, { role })\n      .then(() => {\n        toast.success(t('successfully.updated'));\n        if (data.role === 'user') {\n          dispatch(fetchClients());\n        } else {\n          dispatch(fetchUsers({ role: data.role }));\n        }\n        handleCancel();\n      })\n      .finally(() => setLoading(false));\n  }\n\n  const onFinish = (values) => {\n    changeRole(data.uuid, values.role);\n  };\n\n  const ChangeRole = (e) => setRole(e);\n\n  async function fetchUserShop(search) {\n    const params = { search, status: 'approved' };\n    return shopService.search(params).then((res) =>\n      res.data.map((item) => ({\n        label: item.translation !== null ? item.translation.title : 'no name',\n        value: item.id,\n      }))\n    );\n  }\n\n  return (\n    <Modal\n      visible={!!data}\n      title={t('change.user.role')}\n      onCancel={handleCancel}\n      footer={[\n        <Button type='primary' onClick={() => form.submit()} loading={loading}>\n          {t('save')}\n        </Button>,\n        <Button type='default' onClick={handleCancel}>\n          {t('cancel')}\n        </Button>,\n      ]}\n    >\n      <Form\n        layout='vertical'\n        name='user-role'\n        form={form}\n        onFinish={onFinish}\n        initialValues={data}\n      >\n        <Form.Item\n          name='role'\n          label={t('role')}\n          rules={[{ required: true, message: t('required') }]}\n        >\n          <Select\n            className='w-100'\n            options={user.role === 'manager' ? menegerRoleList : roleList}\n            onChange={ChangeRole}\n          />\n        </Form.Item>\n\n        {role !== 'manager' && role !== 'user' ? (\n          <Form.Item\n            label={t('shop')}\n            name='shop_id'\n            rules={[{ required: true, message: t('required') }]}\n          >\n            <DebounceSelect\n              className='w-100'\n              placeholder={t('select.shop')}\n              fetchOptions={fetchUserShop}\n              allowClear={false}\n            />\n          </Form.Item>\n        ) : undefined}\n      </Form>\n    </Modal>\n  );\n}\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,MAAT,EAAiBC,IAAjB,EAAuBC,KAAvB,EAA8BC,MAA9B,QAA4C,MAA5C;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,SAASC,YAAT,EAAuBC,WAAvB,QAA0C,aAA1C;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,cAAT,QAA+B,eAA/B;AACA,SAASC,YAAT,QAA6B,2BAA7B;AACA,SAASC,cAAT,QAA+B,yBAA/B;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,SAASC,WAAT,QAA4B,aAA5B;;AAEA,eAAe,SAASC,aAAT,OAA+C;EAAA;;EAAA,IAAxB;IAAEC,IAAF;IAAQC;EAAR,CAAwB;EAC5D,MAAM;IAAEC;EAAF,IAAQR,cAAc,EAA5B;EACA,MAAM,CAACS,IAAD,IAASjB,IAAI,CAACkB,OAAL,EAAf;EACA,MAAMC,QAAQ,GAAGd,WAAW,EAA5B;EACA,MAAM,CAACe,OAAD,EAAUC,UAAV,IAAwBvB,QAAQ,CAAC,KAAD,CAAtC;EACA,MAAM,CAACwB,IAAD,EAAOC,OAAP,IAAkBzB,QAAQ,CAACgB,IAAI,CAACQ,IAAN,CAAhC;EACA,MAAM;IAAEE;EAAF,IAAWZ,WAAW,CAAEa,KAAD,IAAWA,KAAK,CAACC,IAAlB,EAAwBtB,YAAxB,CAA5B;EACA,MAAMuB,QAAQ,GAAG,CACf;IAAEC,KAAK,EAAEZ,CAAC,CAAC,MAAD,CAAV;IAAoBa,KAAK,EAAE,MAA3B;IAAmCC,GAAG,EAAE;EAAxC,CADe,EAEf;IAAEF,KAAK,EAAEZ,CAAC,CAAC,SAAD,CAAV;IAAuBa,KAAK,EAAE,SAA9B;IAAyCC,GAAG,EAAE;EAA9C,CAFe,EAGf;IAAEF,KAAK,EAAEZ,CAAC,CAAC,WAAD,CAAV;IAAyBa,KAAK,EAAE,WAAhC;IAA6CC,GAAG,EAAE;EAAlD,CAHe,CAAjB;EAKA,MAAMC,eAAe,GAAG,CACtB;IAAEH,KAAK,EAAEZ,CAAC,CAAC,MAAD,CAAV;IAAoBa,KAAK,EAAE,MAA3B;IAAmCC,GAAG,EAAE;EAAxC,CADsB,EAEtB;IAAEF,KAAK,EAAEZ,CAAC,CAAC,WAAD,CAAV;IAAyBa,KAAK,EAAE,WAAhC;IAA6CC,GAAG,EAAE;EAAlD,CAFsB,CAAxB;;EAKA,SAASE,UAAT,CAAoBC,IAApB,EAA0BX,IAA1B,EAAgC;IAC9BD,UAAU,CAAC,IAAD,CAAV;IACAlB,WAAW,CACR+B,UADH,CACcD,IADd,EACoB;MAAEX;IAAF,CADpB,EAEGa,IAFH,CAEQ,MAAM;MACV5B,KAAK,CAAC6B,OAAN,CAAcpB,CAAC,CAAC,sBAAD,CAAf;;MACA,IAAIF,IAAI,CAACQ,IAAL,KAAc,MAAlB,EAA0B;QACxBH,QAAQ,CAACV,YAAY,EAAb,CAAR;MACD,CAFD,MAEO;QACLU,QAAQ,CAACb,UAAU,CAAC;UAAEgB,IAAI,EAAER,IAAI,CAACQ;QAAb,CAAD,CAAX,CAAR;MACD;;MACDP,YAAY;IACb,CAVH,EAWGsB,OAXH,CAWW,MAAMhB,UAAU,CAAC,KAAD,CAX3B;EAYD;;EAED,MAAMiB,QAAQ,GAAIC,MAAD,IAAY;IAC3BP,UAAU,CAAClB,IAAI,CAACmB,IAAN,EAAYM,MAAM,CAACjB,IAAnB,CAAV;EACD,CAFD;;EAIA,MAAMkB,UAAU,GAAIC,CAAD,IAAOlB,OAAO,CAACkB,CAAD,CAAjC;;EAEA,eAAeC,aAAf,CAA6BC,MAA7B,EAAqC;IACnC,MAAMC,MAAM,GAAG;MAAED,MAAF;MAAUE,MAAM,EAAE;IAAlB,CAAf;IACA,OAAOlC,WAAW,CAACgC,MAAZ,CAAmBC,MAAnB,EAA2BT,IAA3B,CAAiCW,GAAD,IACrCA,GAAG,CAAChC,IAAJ,CAASiC,GAAT,CAAcC,IAAD,KAAW;MACtBpB,KAAK,EAAEoB,IAAI,CAACC,WAAL,KAAqB,IAArB,GAA4BD,IAAI,CAACC,WAAL,CAAiBC,KAA7C,GAAqD,SADtC;MAEtBrB,KAAK,EAAEmB,IAAI,CAACG;IAFU,CAAX,CAAb,CADK,CAAP;EAMD;;EAED,oBACE,QAAC,KAAD;IACE,OAAO,EAAE,CAAC,CAACrC,IADb;IAEE,KAAK,EAAEE,CAAC,CAAC,kBAAD,CAFV;IAGE,QAAQ,EAAED,YAHZ;IAIE,MAAM,EAAE,cACN,QAAC,MAAD;MAAQ,IAAI,EAAC,SAAb;MAAuB,OAAO,EAAE,MAAME,IAAI,CAACmC,MAAL,EAAtC;MAAqD,OAAO,EAAEhC,OAA9D;MAAA,UACGJ,CAAC,CAAC,MAAD;IADJ;MAAA;MAAA;MAAA;IAAA,QADM,eAIN,QAAC,MAAD;MAAQ,IAAI,EAAC,SAAb;MAAuB,OAAO,EAAED,YAAhC;MAAA,UACGC,CAAC,CAAC,QAAD;IADJ;MAAA;MAAA;MAAA;IAAA,QAJM,CAJV;IAAA,uBAaE,QAAC,IAAD;MACE,MAAM,EAAC,UADT;MAEE,IAAI,EAAC,WAFP;MAGE,IAAI,EAAEC,IAHR;MAIE,QAAQ,EAAEqB,QAJZ;MAKE,aAAa,EAAExB,IALjB;MAAA,wBAOE,QAAC,IAAD,CAAM,IAAN;QACE,IAAI,EAAC,MADP;QAEE,KAAK,EAAEE,CAAC,CAAC,MAAD,CAFV;QAGE,KAAK,EAAE,CAAC;UAAEqC,QAAQ,EAAE,IAAZ;UAAkBC,OAAO,EAAEtC,CAAC,CAAC,UAAD;QAA5B,CAAD,CAHT;QAAA,uBAKE,QAAC,MAAD;UACE,SAAS,EAAC,OADZ;UAEE,OAAO,EAAEQ,IAAI,CAACF,IAAL,KAAc,SAAd,GAA0BS,eAA1B,GAA4CJ,QAFvD;UAGE,QAAQ,EAAEa;QAHZ;UAAA;UAAA;UAAA;QAAA;MALF;QAAA;QAAA;QAAA;MAAA,QAPF,EAmBGlB,IAAI,KAAK,SAAT,IAAsBA,IAAI,KAAK,MAA/B,gBACC,QAAC,IAAD,CAAM,IAAN;QACE,KAAK,EAAEN,CAAC,CAAC,MAAD,CADV;QAEE,IAAI,EAAC,SAFP;QAGE,KAAK,EAAE,CAAC;UAAEqC,QAAQ,EAAE,IAAZ;UAAkBC,OAAO,EAAEtC,CAAC,CAAC,UAAD;QAA5B,CAAD,CAHT;QAAA,uBAKE,QAAC,cAAD;UACE,SAAS,EAAC,OADZ;UAEE,WAAW,EAAEA,CAAC,CAAC,aAAD,CAFhB;UAGE,YAAY,EAAE0B,aAHhB;UAIE,UAAU,EAAE;QAJd;UAAA;UAAA;UAAA;QAAA;MALF;QAAA;QAAA;QAAA;MAAA,QADD,GAaGa,SAhCN;IAAA;MAAA;MAAA;MAAA;IAAA;EAbF;IAAA;IAAA;IAAA;EAAA,QADF;AAkDD;;GAnGuB1C,a;UACRL,c,EACCR,IAAI,CAACkB,O,EACHb,W,EAGAO,W;;;KANKC,a"},"metadata":{},"sourceType":"module"}