{"ast":null,"code":"import React,{useState}from'react';import{Button,Col,Form,Modal,Row}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import parcelOrderService from'services/parcelOrder';import{setRefetch}from'redux/slices/menu';import{useTranslation}from'react-i18next';import userService from'services/user';import{DebounceSelect}from'components/search';import{jsx as _jsx}from\"react/jsx-runtime\";export default function ParcelDeliveryman(_ref){var _data$deliveryman,_data$deliveryman2,_data$deliveryman3;let{orderDetails:data,handleCancel}=_ref;const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[form]=Form.useForm();const dispatch=useDispatch();const[loading,setLoading]=useState(false);const onFinish=values=>{const params={deliveryman_id:values.deliveryman.value};setLoading(true);parcelOrderService.updateDelivery(data.id,params).then(()=>{handleCancel();dispatch(setRefetch(activeMenu));}).finally(()=>setLoading(false));};async function fetchDelivery(search){const params={search:search.length?search:undefined,page:1,perPage:10,role:'deliveryman',exist_token:1};return userService.getAll(params).then(_ref2=>{let{data}=_ref2;return data.map(item=>({label:[item.firstname,item.lastname].join(' '),value:item.id}));});}return/*#__PURE__*/_jsx(Modal,{visible:!!data,onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>form.submit(),loading:loading,children:t('save')},'saveBtn'),/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancelBtn')],children:/*#__PURE__*/_jsx(Form,{form:form,layout:\"vertical\",onFinish:onFinish,initialValues:{deliveryman:{label:data.deliveryman?(data===null||data===void 0?void 0:(_data$deliveryman=data.deliveryman)===null||_data$deliveryman===void 0?void 0:_data$deliveryman.firstname)+' '+(data===null||data===void 0?void 0:(_data$deliveryman2=data.deliveryman)===null||_data$deliveryman2===void 0?void 0:_data$deliveryman2.lastname):null,value:data.deliveryman?data===null||data===void 0?void 0:(_data$deliveryman3=data.deliveryman)===null||_data$deliveryman3===void 0?void 0:_data$deliveryman3.id:null}},children:/*#__PURE__*/_jsx(Row,{gutter:12,children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('deliveryman'),name:\"deliveryman\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DebounceSelect,{className:\"w-100\",debounceTimeout:500,placeholder:t('select.shop'),fetchOptions:fetchDelivery,allowClear:true})})})})})});}","map":null,"metadata":{},"sourceType":"module"}