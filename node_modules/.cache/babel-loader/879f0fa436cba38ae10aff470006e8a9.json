{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/coupons/coupon-edit.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Form, Card } from 'antd';\nimport LanguageList from 'components/language-list';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport couponService from 'services/seller/coupon';\nimport moment from 'moment';\nimport { batch, shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, removeFromMenu } from 'redux/slices/menu';\nimport { useTranslation } from 'react-i18next';\nimport { fetchCoupon } from 'redux/slices/sellerCoupons';\nimport CouponForm from './coupon-form';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CouponEdit = () => {\n  _s();\n\n  const {\n    t\n  } = useTranslation();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n  const {\n    languages\n  } = useSelector(state => state.formLang, shallowEqual);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const {\n    id\n  } = useParams();\n  const {\n    activeMenu\n  } = useSelector(state => state.menu, shallowEqual);\n  const {\n    myShop\n  } = useSelector(state => state.myShop, shallowEqual);\n\n  function getLanguageFields(data) {\n    if (!(data !== null && data !== void 0 && data.translations)) {\n      return {};\n    }\n\n    const {\n      translations\n    } = data;\n    const result = languages.map(item => {\n      var _translations$find;\n\n      return {\n        [`title[${item.locale}]`]: (_translations$find = translations.find(el => el.locale === item.locale)) === null || _translations$find === void 0 ? void 0 : _translations$find.title\n      };\n    });\n    return Object.assign({}, ...result);\n  }\n\n  function getCoupon(id) {\n    setLoading(true);\n    couponService.getById(id).then(_ref => {\n      let {\n        data\n      } = _ref;\n      const body = { ...data,\n        ...getLanguageFields(data),\n        expired_at: moment(data.expired_at, 'YYYY-MM-DD')\n      };\n      form.setFieldsValue(body);\n    }).finally(() => {\n      setLoading(false);\n      dispatch(disableRefetch(activeMenu));\n    });\n  }\n\n  const handleSubmit = values => {\n    const nextUrl = 'seller/coupons';\n    const params = { ...values,\n      shop_id: myShop === null || myShop === void 0 ? void 0 : myShop.id,\n      expired_at: moment(values.expired_at).format('YYYY-MM-DD'),\n      qty: Number(values.qty),\n      price: Number(values.price)\n    };\n    return couponService.update(id, params).then(res => {\n      toast.success(t('successfully.updated'));\n      batch(() => {\n        dispatch(removeFromMenu({ ...activeMenu,\n          nextUrl\n        }));\n        dispatch(fetchCoupon({\n          shop_id: myShop === null || myShop === void 0 ? void 0 : myShop.id\n        }));\n      });\n      navigate(`/${nextUrl}`);\n    });\n  };\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      getCoupon(id);\n    }\n  }, [activeMenu.refetch]);\n  return /*#__PURE__*/_jsxDEV(Card, {\n    title: t('edit.coupon'),\n    extra: /*#__PURE__*/_jsxDEV(LanguageList, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 43\n    }, this),\n    loading: loading,\n    children: /*#__PURE__*/_jsxDEV(CouponForm, {\n      form: form,\n      handleSubmit: handleSubmit\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CouponEdit, \"ZfzTNnyhg1mZ3wt4w5kG3RTqLHs=\", false, function () {\n  return [useTranslation, Form.useForm, useSelector, useDispatch, useNavigate, useParams, useSelector, useSelector];\n});\n\n_c = CouponEdit;\nexport default CouponEdit;\n\nvar _c;\n\n$RefreshReg$(_c, \"CouponEdit\");","map":{"version":3,"names":["React","useEffect","useState","Form","Card","LanguageList","useNavigate","useParams","couponService","moment","batch","shallowEqual","useDispatch","useSelector","disableRefetch","removeFromMenu","useTranslation","fetchCoupon","CouponForm","toast","CouponEdit","t","form","useForm","loading","setLoading","languages","state","formLang","dispatch","navigate","id","activeMenu","menu","myShop","getLanguageFields","data","translations","result","map","item","locale","find","el","title","Object","assign","getCoupon","getById","then","body","expired_at","setFieldsValue","finally","handleSubmit","values","nextUrl","params","shop_id","format","qty","Number","price","update","res","success","refetch"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/coupons/coupon-edit.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Form, Card } from 'antd';\nimport LanguageList from 'components/language-list';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport couponService from 'services/seller/coupon';\nimport moment from 'moment';\nimport { batch, shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, removeFromMenu } from 'redux/slices/menu';\nimport { useTranslation } from 'react-i18next';\nimport { fetchCoupon } from 'redux/slices/sellerCoupons';\nimport CouponForm from './coupon-form';\nimport { toast } from 'react-toastify';\n\nconst CouponEdit = () => {\n  const { t } = useTranslation();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n  const { languages } = useSelector((state) => state.formLang, shallowEqual);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const { id } = useParams();\n  const { activeMenu } = useSelector((state) => state.menu, shallowEqual);\n  const { myShop } = useSelector((state) => state.myShop, shallowEqual);\n\n  function getLanguageFields(data) {\n    if (!data?.translations) {\n      return {};\n    }\n    const { translations } = data;\n    const result = languages.map((item) => ({\n      [`title[${item.locale}]`]: translations.find(\n        (el) => el.locale === item.locale,\n      )?.title,\n    }));\n    return Object.assign({}, ...result);\n  }\n\n  function getCoupon(id) {\n    setLoading(true);\n    couponService\n      .getById(id)\n      .then(({ data }) => {\n        const body = {\n          ...data,\n          ...getLanguageFields(data),\n          expired_at: moment(data.expired_at, 'YYYY-MM-DD'),\n        };\n        form.setFieldsValue(body);\n      })\n      .finally(() => {\n        setLoading(false);\n        dispatch(disableRefetch(activeMenu));\n      });\n  }\n\n  const handleSubmit = (values) => {\n    const nextUrl = 'seller/coupons';\n\n    const params = {\n      ...values,\n      shop_id: myShop?.id,\n      expired_at: moment(values.expired_at).format('YYYY-MM-DD'),\n      qty: Number(values.qty),\n      price: Number(values.price),\n    };\n\n    return couponService.update(id, params).then((res) => {\n      toast.success(t('successfully.updated'));\n      batch(() => {\n        dispatch(removeFromMenu({ ...activeMenu, nextUrl }));\n        dispatch(fetchCoupon({ shop_id: myShop?.id }));\n      });\n      navigate(`/${nextUrl}`);\n    });\n  };\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      getCoupon(id);\n    }\n  }, [activeMenu.refetch]);\n\n  return (\n    <Card title={t('edit.coupon')} extra={<LanguageList />} loading={loading}>\n      <CouponForm form={form} handleSubmit={handleSubmit} />\n    </Card>\n  );\n};\n\nexport default CouponEdit;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}