{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Button,Card,Form,Input,Modal}from'antd';import{toast}from'react-toastify';import{useParams}from'react-router-dom';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch}from'../../redux/slices/menu';import categoryService from'../../services/category';import{useTranslation}from'react-i18next';import LanguageList from'components/language-list';import{setRefetch}from'redux/slices/menu';import{jsx as _jsx}from\"react/jsx-runtime\";const MenuCategoryEdit=_ref=>{let{isModalOpen,handleCancel}=_ref;const{t}=useTranslation();const dispatch=useDispatch();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[loading,setLoading]=useState(false);const[form]=Form.useForm();const[loadingBtn,setLoadingBtn]=useState(false);const{defaultLang,languages}=useSelector(state=>state.formLang,shallowEqual);const uuid=isModalOpen===null||isModalOpen===void 0?void 0:isModalOpen.uuid;function getLanguageFields(data){if(!data){return{};}const{translations}=data;const result=languages.map(item=>{var _translations$find;return{[`title[${item.locale}]`]:(_translations$find=translations.find(el=>el.locale===item.locale))===null||_translations$find===void 0?void 0:_translations$find.title};});return Object.assign({},...result);}const getCategory=alias=>{setLoading(true);categoryService.getById(alias).then(res=>{let category=res.data;const body={...getLanguageFields(category)};form.setFieldsValue(body);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const onFinish=values=>{setLoadingBtn(true);const body={...values,type:'menu'};console.log('isModalOpen => ',isModalOpen);categoryService.update(uuid,body).then(()=>{toast.success(t('successfully.updated'));handleCancel();dispatch(setRefetch(activeMenu));}).catch(err=>console.error(err.response.data.params)).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(isModalOpen)getCategory(isModalOpen.uuid);},[isModalOpen]);return/*#__PURE__*/_jsx(Modal,{visible:isModalOpen,title:t('edit.menu.category'),onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{loading:loadingBtn,type:\"primary\",onClick:()=>form.submit(),children:t('save')},'saveBtn'),/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancelBtn')],children:/*#__PURE__*/_jsx(Card,{extra:/*#__PURE__*/_jsx(LanguageList,{}),loading:loading,children:/*#__PURE__*/_jsx(Form,{name:\"basic\",layout:\"vertical\",onFinish:onFinish,initialValues:{...activeMenu.data},form:form,children:languages.map((item,index)=>/*#__PURE__*/_jsx(Form.Item,{label:t('name'),name:`title[${item.locale}]`,rules:[{required:item.locale===defaultLang,message:t('required')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{placeholder:t('name'),className:\"w-100\"})},item.title+index))})})});};export default MenuCategoryEdit;","map":null,"metadata":{},"sourceType":"module"}