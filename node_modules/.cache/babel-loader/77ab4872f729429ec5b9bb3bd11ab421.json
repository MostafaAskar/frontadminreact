{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Card,Table,Image,Space,Button,Tag}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,setMenuData}from'redux/slices/menu';import{useTranslation}from'react-i18next';import{fetchDeliverymanRequest}from'redux/slices/deliveryman-request';import useDidUpdate from'helpers/useDidUpdate';import formatSortType from'helpers/formatSortType';import{EditOutlined,EyeOutlined}from'@ant-design/icons';import DeliverymanRequestModal from'./details-modal';import StatusChangeModal from'./status-change-modal';import requestAdminModelsService from'services/request-models';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DeliverymanRequest(){const dispatch=useDispatch();const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{deliverymanRequestData,meta,loading}=useSelector(state=>state.deliverymanRequest,shallowEqual);const[id,setId]=useState(null);const[details,setDetails]=useState(null);const[changeStatus,setChangeStatus]=useState(null);const data=activeMenu.data;const paramsData={perPage:data===null||data===void 0?void 0:data.perPage,page:data===null||data===void 0?void 0:data.page,search:data===null||data===void 0?void 0:data.search,columns:data===null||data===void 0?void 0:data.columns};useDidUpdate(()=>{dispatch(fetchDeliverymanRequest(paramsData));},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.data]);useEffect(()=>{if(activeMenu!==null&&activeMenu!==void 0&&activeMenu.refetch){dispatch(fetchDeliverymanRequest(paramsData));dispatch(disableRefetch(activeMenu));}},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.refetch]);const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};function onChangePagination(pagination,filter,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column,order}=sorter;const sort=formatSortType(order);dispatch(setMenuData({activeMenu,data:{...(activeMenu===null||activeMenu===void 0?void 0:activeMenu.data),perPage,page,column,sort}}));}const handleChangeStatus=(id,data)=>{const params={status_note:data===null||data===void 0?void 0:data.status_note,status:data===null||data===void 0?void 0:data.status};return requestAdminModelsService.changeStatus(id,params).then(()=>{setChangeStatus(null);toast.success(t('successfully.updated'));dispatch(fetchDeliverymanRequest(paramsData));dispatch(disableRefetch(activeMenu));});};const columns=[{title:t('id'),dataIndex:'id',key:'id',is_show:true},{title:t('name'),dataIndex:'name',key:'name',is_show:true,render:(_,row)=>{var _row$model,_row$model2;return(row===null||row===void 0?void 0:(_row$model=row.model)===null||_row$model===void 0?void 0:_row$model.firstname)+' '+(row===null||row===void 0?void 0:(_row$model2=row.model)===null||_row$model2===void 0?void 0:_row$model2.lastname);}},{title:t('delivery.man.setting'),dataIndex:'setting',key:'setting',is_show:true,render:(_,data)=>{var _data$data,_data$data2,_data$data3,_data$data4;return/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsxs(\"span\",{children:[t('brand'),\": \",data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.brand,/*#__PURE__*/_jsx(\"br\",{}),t('model'),\": \",data===null||data===void 0?void 0:(_data$data2=data.data)===null||_data$data2===void 0?void 0:_data$data2.model,/*#__PURE__*/_jsx(\"br\",{}),t('number'),\": \",data===null||data===void 0?void 0:(_data$data3=data.data)===null||_data$data3===void 0?void 0:_data$data3.number,/*#__PURE__*/_jsx(\"br\",{}),t('color'),\": \",data===null||data===void 0?void 0:(_data$data4=data.data)===null||_data$data4===void 0?void 0:_data$data4.color]})});}},{title:t('image'),dataIndex:'image',key:'image',is_show:true,render:(_,row)=>{var _row$data;return/*#__PURE__*/_jsx(Image,{src:(row===null||row===void 0?void 0:(_row$data=row.data)===null||_row$data===void 0?void 0:_row$data['images[0]'])||'https://via.placeholder.com/100',alt:'img',width:100,className:'rounded',preview:true,placeholder:true});}},{title:t('status'),dataIndex:'status',key:'status',is_show:true,render:(status,row)=>/*#__PURE__*/_jsxs(\"div\",{children:[status==='pending'?/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:t(status)}):status==='canceled'?/*#__PURE__*/_jsx(Tag,{color:\"error\",children:t(status)}):/*#__PURE__*/_jsx(Tag,{color:\"cyan\",children:t(status)}),!row.deleted_at?/*#__PURE__*/_jsx(EditOutlined,{onClick:()=>setChangeStatus(row)}):'']})},{title:t('options'),key:'options',dataIndex:'options',is_show:true,render:(_,row)=>{return/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(EyeOutlined,{}),onClick:e=>{e.stopPropagation();setDetails(row);}})});}}];return/*#__PURE__*/_jsxs(Card,{title:t('deliveryman.request'),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},rowSelection:rowSelection,columns:columns===null||columns===void 0?void 0:columns.filter(item=>item===null||item===void 0?void 0:item.is_show),dataSource:deliverymanRequestData,pagination:{pageSize:meta===null||meta===void 0?void 0:meta.perPage,total:meta===null||meta===void 0?void 0:meta.total,current:data===null||data===void 0?void 0:data.page,page:(data===null||data===void 0?void 0:data.page)||1,defaultCurrent:data===null||data===void 0?void 0:data.page},onChange:onChangePagination,rowKey:record=>record===null||record===void 0?void 0:record.id,loading:loading}),details?/*#__PURE__*/_jsx(DeliverymanRequestModal,{data:details,handleClose:()=>setDetails(null)}):null,changeStatus?/*#__PURE__*/_jsx(StatusChangeModal,{data:changeStatus,handleChange:handleChangeStatus,handleClose:()=>setChangeStatus(null)}):null]});}","map":null,"metadata":{},"sourceType":"module"}