{"ast":null,"code":"import React,{useState}from'react';import{Button,Card,Col,Form,Input,Modal,Row,Select,Switch}from'antd';import{useTranslation}from'react-i18next';import{toast}from'react-toastify';import LanguageList from'../language-list';import{shallowEqual,useSelector}from'react-redux';import TextArea from'antd/lib/input/TextArea';import MediaUpload from'../upload';import categoryService from'../../services/category';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CategoryModal(_ref){let{visible,handleCancel}=_ref;const{t}=useTranslation();const[form]=Form.useForm();const[loadingBtn,setLoadingBtn]=useState(false);const[error,setError]=useState(null);const[image,setImage]=useState([]);const{defaultLang,languages}=useSelector(state=>state.formLang,shallowEqual);const onFinish=values=>{var _values$parent_id,_values$parent_id2,_image$;setLoadingBtn(true);const body={...values,type:'shop',active:values.active?1:0,keywords:values.keywords.join(','),parent_id:((_values$parent_id=values.parent_id)===null||_values$parent_id===void 0?void 0:_values$parent_id.value)===0?null:(_values$parent_id2=values.parent_id)===null||_values$parent_id2===void 0?void 0:_values$parent_id2.value,'images[0]':(_image$=image[0])===null||_image$===void 0?void 0:_image$.name};categoryService.create(body).then(()=>{toast.success(t('successfully.created'));handleCancel();}).catch(err=>setError(err.response.data.params)).finally(()=>setLoadingBtn(false));};return/*#__PURE__*/_jsx(Modal,{title:t('add.client'),visible:visible,onCancel:handleCancel,style:{minWidth:'60vw'},footer:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>form.submit(),loading:loadingBtn,children:t('save')},'ok-button'),/*#__PURE__*/_jsx(Button,{onClick:handleCancel,children:t('cancel')},'cancel-button')],children:/*#__PURE__*/_jsx(Card,{title:t('add.category'),extra:/*#__PURE__*/_jsx(LanguageList,{}),children:/*#__PURE__*/_jsx(Form,{name:\"basic\",layout:\"vertical\",onFinish:onFinish,initialValues:{parent_id:{title:'---',value:0,key:0},active:true},form:form,children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:languages.map((item,index)=>/*#__PURE__*/_jsx(Form.Item,{label:t('name'),name:`title[${item.locale}]`,help:error?error[`title.${defaultLang}`]?error[`title.${defaultLang}`][0]:null:null,validateStatus:error?'error':'success',rules:[{required:item.locale===defaultLang,message:t('required')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{placeholder:t('name')})},item.title+index))}),/*#__PURE__*/_jsx(Col,{span:12,children:languages.map((item,index)=>/*#__PURE__*/_jsx(Form.Item,{label:t('description'),name:`description[${item.locale}]`,rules:[{required:item.locale===defaultLang,message:t('required')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(TextArea,{rows:4})},item.locale+index))}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('keywords'),name:\"keywords\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{mode:\"tags\",style:{width:'100%'}})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('parent.category'),name:\"parent_id\",rules:[{required:true,message:t('required')}],help:error?error.parent_id?error.parent_id[0]:null:null,validateStatus:error?'error':'success',children:/*#__PURE__*/_jsx(Select,{children:/*#__PURE__*/_jsx(Select.Option,{value:0,children:\"---\"})})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Form.Item,{label:t('image'),children:/*#__PURE__*/_jsx(MediaUpload,{type:\"categories\",imageList:image,setImageList:setImage,form:form,multiple:false})})}),/*#__PURE__*/_jsx(Col,{span:2,children:/*#__PURE__*/_jsx(Form.Item,{label:t('active'),name:\"active\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Switch,{})})})]})})})});}","map":null,"metadata":{},"sourceType":"module"}