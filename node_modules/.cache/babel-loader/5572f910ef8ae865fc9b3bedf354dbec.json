{"ast":null,"code":"import React,{useState}from'react';import{Button,Card,Col,Form,Input,Row,Select}from'antd';import{isArray}from'lodash';import userService from'../../../services/user';import{DebounceSelect}from'../../../components/search';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{setOrderCurrency,setOrderData}from'../../../redux/slices/order';import{useTranslation}from'react-i18next';import{PlusCircleOutlined}from'@ant-design/icons';import{addMenu}from'../../../redux/slices/menu';import{useNavigate}from'react-router-dom';import{AsyncSelect}from'../../../components/async-select';import paymentService from'../../../services/payment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const UserInfo=_ref=>{let{form}=_ref;const{t}=useTranslation();const dispatch=useDispatch();const navigate=useNavigate();const{currencies}=useSelector(state=>state.currency,shallowEqual);const[users,setUsers]=useState([]);async function getUsers(search){const params={search,perPage:10};return userService.search(params).then(_ref2=>{let{data}=_ref2;setUsers(data);return formatUser(data);});}async function fetchPaymentList(){return paymentService.getAll({perPage:100}).then(_ref3=>{let{data}=_ref3;return data.filter(el=>el.tag==='cash'||el.tag==='wallet').map(item=>({label:item.tag||'no name',value:item.id}));});}function formatUser(data){if(!data)return;if(isArray(data)){return data.map(item=>({label:`${item.firstname} ${item.lastname||''}`,value:item.id}));}else{return{label:`${data.firstname} ${data.lastname||''}`,value:data.id};}}function selectUser(userObj){const user=users.find(item=>item.id===userObj.value);dispatch(setOrderData({user:userObj,userUuid:user.uuid}));form.setFieldsValue({address:null});}function selectCurrency(item){const currency=currencies.find(el=>el.id===item);dispatch(setOrderCurrency(currency));}const goToAddClient=()=>{dispatch(addMenu({url:`user/add`,id:'user_add',name:'User add'}));navigate(`/user/add`);};return/*#__PURE__*/_jsx(Card,{title:t('customer.details'),children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:16,children:/*#__PURE__*/_jsx(Form.Item,{label:t('client'),name:\"user\",rules:[{required:true,message:''}],children:/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.client'),fetchOptions:getUsers,onSelect:selectUser})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Form.Item,{label:\"add\",className:\"label-hidden\",children:/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(PlusCircleOutlined,{}),onClick:goToAddClient,children:t('add')})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('currency'),name:\"currency_id\",rules:[{required:true,message:'missing_currency'}],children:/*#__PURE__*/_jsx(Select,{placeholder:t('select.currency'),onSelect:selectCurrency,children:currencies.map((item,index)=>/*#__PURE__*/_jsxs(Select.Option,{value:item.id,children:[item.title,\" (\",item===null||item===void 0?void 0:item.symbol,\")\"]},index))})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('payment.type'),name:\"payment_type\",rules:[{required:true,message:t('missing.payment.type')}],children:/*#__PURE__*/_jsx(AsyncSelect,{fetchOptions:fetchPaymentList,className:\"w-100\",placeholder:t('select.payment.type'),disabled:true})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('note'),name:\"note\",children:/*#__PURE__*/_jsx(Input,{})})})]})});};export default UserInfo;","map":null,"metadata":{},"sourceType":"module"}