{"ast":null,"code":"import{useState}from'react';import{Spin,Upload,message}from'antd';import{PlusOutlined}from'@ant-design/icons';import galleryService from'services/gallery';import{useTranslation}from'react-i18next';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ImageGallery=_ref=>{let{fileList=[],setFileList,type,id}=_ref;const{t}=useTranslation();const[loading,setLoading]=useState(false);const createImage=file=>{return{uid:file.title,name:file.title,status:'done',// done, uploading, error\nurl:file.title,created:true};};const createUploadData=(id,img)=>{const stockIndex=fileList.findIndex(item=>item.id===id);if(stockIndex>=0){const newArray=fileList.map(item=>{if(item.id===id){return{id,images:[...item.images,img]};}else{return item;}});setFileList(newArray);}else setFileList(prev=>[...prev,{id,images:[img]}]);};const handleUpload=_ref2=>{let{file,onSuccess}=_ref2;setLoading(true);const formData=new FormData();formData.append('image',file);formData.append('type',type);galleryService.upload(formData).then(_ref3=>{let{data}=_ref3;createUploadData(id,createImage(data));onSuccess('ok');}).finally(()=>{setLoading(false);});};const handleRemove=file=>{const updatedData=fileList.map(item=>{if(item.id===id){const updatedImages=item.images.filter(image=>image.uid!==file.uid);if(updatedImages.length===0){// If images array is empty, remove the object\nreturn null;}return{...item,images:updatedImages};}return item;}).filter(item=>item!==null);setFileList(updatedData);};const uploadButton=loading?/*#__PURE__*/_jsx(Spin,{}):/*#__PURE__*/_jsx(PlusOutlined,{});const currentFileList=fileList.find(item=>item.id===id)||[];return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Upload,{listType:\"picture-card\",fileList:(currentFileList===null||currentFileList===void 0?void 0:currentFileList.galleries)||(currentFileList===null||currentFileList===void 0?void 0:currentFileList.images),customRequest:handleUpload,onRemove:handleRemove,showUploadList:true,accept:\".png,.jpg,.jpeg,.webp\",beforeUpload:file=>{const isItAtLeast2MB=file.size/1024/1024<2;if(!isItAtLeast2MB){message.error(t('max.2.mb'));return false;}return true;},children:uploadButton})});};export default ImageGallery;","map":null,"metadata":{},"sourceType":"module"}