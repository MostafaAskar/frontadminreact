{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Form,Input,Card,Button,Row,Col,Switch,Select,InputNumber}from'antd';import{useNavigate,useParams}from'react-router-dom';import{toast}from'react-toastify';import currencyService from'../../services/currency';import{useDispatch,useSelector}from'react-redux';import{disableRefetch,removeFromMenu,setMenuData}from'../../redux/slices/menu';import{fetchCurrencies}from'../../redux/slices/currency';import{useTranslation}from'react-i18next';import currency from'../../helpers/currnecy.json';import Loading from'../../components/loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CurrencyEdit(){const{t}=useTranslation();const[loading,setLoading]=useState(false);const[loadingBtn,setLoadingBtn]=useState(false);const[form]=Form.useForm();const navigate=useNavigate();const{id}=useParams();const dispatch=useDispatch();const{activeMenu}=useSelector(state=>state.menu);useEffect(()=>{return()=>{const data=form.getFieldsValue(true);dispatch(setMenuData({activeMenu,data}));};},[]);const fetchCurrency=id=>{setLoading(true);currencyService.getById(id).then(_ref=>{let{data}=_ref;return form.setFieldsValue(data);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const onFinish=values=>{setLoadingBtn(true);const body={title:values.title,symbol:values.symbol,rate:values.rate,active:Number(values.active),position:values.position};const nextUrl='currencies';currencyService.update(id,body).then(()=>{toast.success(t('successfully.updated'));dispatch(removeFromMenu({...activeMenu,nextUrl}));navigate(`/${nextUrl}`);dispatch(fetchCurrencies({}));}).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(activeMenu.refetch){fetchCurrency(id);}},[activeMenu.refetch]);const options=currency.map(item=>({label:(item===null||item===void 0?void 0:item.name.toUpperCase())+' '+`( ${item.symbol_native} )`,value:item.code,symbol:item.symbol_native}));return/*#__PURE__*/_jsx(Card,{title:t('edit.currency'),children:loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(Form,{name:\"currency-add\",onFinish:onFinish,form:form,layout:\"vertical\",initialValues:{...activeMenu.data,active:true,position:'before'},children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('title'),name:\"title\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{onChange:(e,i)=>form.setFieldsValue({symbol:i.symbol}),filterOption:(input,option)=>{var _option$label;return((_option$label=option===null||option===void 0?void 0:option.label)!==null&&_option$label!==void 0?_option$label:'').includes(input);},filterSort:(optionA,optionB)=>{var _optionA$label,_optionB$label;return((_optionA$label=optionA===null||optionA===void 0?void 0:optionA.label)!==null&&_optionA$label!==void 0?_optionA$label:'').toUpperCase().localeCompare(((_optionB$label=optionB===null||optionB===void 0?void 0:optionB.label)!==null&&_optionB$label!==void 0?_optionB$label:'').toUpperCase());},showSearch:true,allowClear:true,options:options})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('symbol'),name:\"symbol\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{disabled:true})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('rate'),name:\"rate\",rules:[{required:true,message:t('required')},{type:'number',min:0,message:t('must.be.positive')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('symbol_position'),name:\"position\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{onChange:value=>form.setFieldsValue({position:value}),options:[{label:t('after'),value:'after'},{label:t('before'),value:'before'}]})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('active'),name:\"active\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Switch,{})})})]}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('submit')})]})});}","map":null,"metadata":{},"sourceType":"module"}