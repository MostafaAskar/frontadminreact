{"ast":null,"code":"import React,{Fragment,useEffect,useState}from'react';import{Button,Card,Image,Space,Table,Tag}from'antd';import{useTranslation}from'react-i18next';import useDidUpdate from'helpers/useDidUpdate';import{useSelector,useDispatch,shallowEqual,batch}from'react-redux';import{fetchSellerDeliverymans}from'redux/slices/deliveryman';import{addMenu,disableRefetch,setMenuData}from'redux/slices/menu';import useDemo from'helpers/useDemo';import hideEmail from'components/hideEmail';import{IMG_URL}from'configs/app-global';import{DeleteOutlined,EditOutlined}from'@ant-design/icons';import DeleteButton from'components/delete-button';import SearchInput from'components/search-input';import DeliverymenStatusModal from'./status-change-modal';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;function SellerDeliverymen(){var _activeMenu$data$sear,_activeMenu$data,_paramsData$search,_activeMenu$data2;const{t}=useTranslation();const dispatch=useDispatch();const navigate=useNavigate();const{isDemo}=useDemo();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{deliverymans,params,loading,meta}=useSelector(state=>state.deliveryman,shallowEqual);const{myShop}=useSelector(state=>state.myShop,shallowEqual);const[id,setId]=useState(null);const[statusChange,setStatusChange]=useState(null);const paramsData={search:(_activeMenu$data$sear=activeMenu===null||activeMenu===void 0?void 0:(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.search)!==null&&_activeMenu$data$sear!==void 0?_activeMenu$data$sear:null,...params};if(!(paramsData!==null&&paramsData!==void 0&&(_paramsData$search=paramsData.search)!==null&&_paramsData$search!==void 0&&_paramsData$search.length))paramsData===null||paramsData===void 0?true:delete paramsData.search;const columns=[{title:t('id'),is_show:true,dataIndex:'id',key:'id'},{title:t('image'),dataIndex:'img',is_show:true,render:img=>{return/*#__PURE__*/_jsx(Image,{width:100,src:IMG_URL+img,placeholder:true,style:{borderRadius:4}});}},{title:t('name'),dataIndex:'name',key:'name',is_show:true,render:(_,row)=>((row===null||row===void 0?void 0:row.firstname)||'')+' '+((row===null||row===void 0?void 0:row.lastname)||'')},{title:t('email'),dataIndex:'email',key:'email',is_show:true,render:email=>isDemo||ReactAppIsDemo==='true'?hideEmail(email):email},{title:t('status'),dataIndex:'status',key:'status',is_show:true,render:(_,row)=>{var _row$invitations,_row$invitations$filt;const invite=row===null||row===void 0?void 0:(_row$invitations=row.invitations)===null||_row$invitations===void 0?void 0:(_row$invitations$filt=_row$invitations.filter(item=>(item===null||item===void 0?void 0:item.shop_id)===(myShop===null||myShop===void 0?void 0:myShop.id)))===null||_row$invitations$filt===void 0?void 0:_row$invitations$filt[0];return/*#__PURE__*/_jsxs(\"div\",{children:[(invite===null||invite===void 0?void 0:invite.status)==='new'?/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:t(invite===null||invite===void 0?void 0:invite.status)}):(invite===null||invite===void 0?void 0:invite.status)==='rejected'?/*#__PURE__*/_jsx(Tag,{color:\"error\",children:t(invite===null||invite===void 0?void 0:invite.status)}):/*#__PURE__*/_jsx(Tag,{color:\"cyan\",children:t(invite===null||invite===void 0?void 0:invite.status)}),(myShop===null||myShop===void 0?void 0:myShop.delivery_type)===2&&/*#__PURE__*/_jsx(EditOutlined,{onClick:()=>setStatusChange({...row,invite})})]});}},{title:t('options'),dataIndex:'options',key:'options',is_show:false,render:()=>{return/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{})}),/*#__PURE__*/_jsx(DeleteButton,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{})})]});}}];useDidUpdate(()=>{dispatch(fetchSellerDeliverymans(paramsData));},[(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.search]);useEffect(()=>{if(activeMenu.refetch){batch(()=>{dispatch(fetchSellerDeliverymans(paramsData));dispatch(disableRefetch(activeMenu));});}},[activeMenu.refetch]);const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};const onChangePagination=_ref=>{let{pageSize,current}=_ref;const params={...paramsData,perPage:pageSize,page:current};dispatch(fetchSellerDeliverymans(params));};const handleFilter=items=>{const data=activeMenu.data;dispatch(setMenuData({activeMenu,data:{...data,...items}}));};const goToAdd=()=>{dispatch(addMenu({id:'seller-deliverymen-add',url:`seller/deliverymen/add`,name:t('add.deliveryman')}));navigate('add',{state:{paramsData}});};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Space,{wrap:true,size:[14,20],children:/*#__PURE__*/_jsx(SearchInput,{placeholder:t('search'),handleChange:e=>handleFilter({search:e})})}),(myShop===null||myShop===void 0?void 0:myShop.delivery_type)===2&&/*#__PURE__*/_jsx(Button,{style:{float:'right'},type:\"primary\",onClick:goToAdd,children:t('add.deliveryman')})]}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Table,{loading:loading,dataSource:deliverymans||[],columns:columns===null||columns===void 0?void 0:columns.filter(item=>item===null||item===void 0?void 0:item.is_show),scroll:{x:true},rowKey:row=>row.id// rowSelection={rowSelection}\n,pagination:{pageSize:meta===null||meta===void 0?void 0:meta.per_page,page:meta===null||meta===void 0?void 0:meta.current_page,total:meta===null||meta===void 0?void 0:meta.total},onChange:onChangePagination})}),statusChange&&/*#__PURE__*/_jsx(DeliverymenStatusModal,{data:statusChange,handleCancel:()=>setStatusChange(null),paramsData:paramsData})]});}export default SellerDeliverymen;","map":null,"metadata":{},"sourceType":"module"}