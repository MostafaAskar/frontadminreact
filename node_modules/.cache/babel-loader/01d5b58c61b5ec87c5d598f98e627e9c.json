{"ast":null,"code":"import React,{Fragment,useEffect,useState}from'react';import{Form}from'antd';import LooksForm from'./form';import getTranslationFields from'helpers/getTranslationFields';import looksService from'services/banner';import{shallowEqual,useSelector,useDispatch}from'react-redux';import{useParams}from'react-router-dom';import banner from'services/banner';import Loading from'components/loading';import{disableRefetch,setMenuData}from'redux/slices/menu';import{jsx as _jsx}from\"react/jsx-runtime\";export default function EditLook(){const dispatch=useDispatch();const[form]=Form.useForm();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{languages}=useSelector(state=>state.formLang,shallowEqual);const{id}=useParams();const[loading,setLoading]=useState(false);const fetchLook=id=>{setLoading(true);const params={type:'look'};banner.getById(id,params).then(res=>{var _data$translation,_data$translation2,_data$translation3,_data$translation4,_data$shop,_data$shop$translatio,_data$shop2,_data$shop3,_data$products,_data$galleries;const data=res===null||res===void 0?void 0:res.data;const body={[`title[${data===null||data===void 0?void 0:(_data$translation=data.translation)===null||_data$translation===void 0?void 0:_data$translation.locale}]`]:data===null||data===void 0?void 0:(_data$translation2=data.translation)===null||_data$translation2===void 0?void 0:_data$translation2.title,[`description[${data===null||data===void 0?void 0:(_data$translation3=data.translation)===null||_data$translation3===void 0?void 0:_data$translation3.locale}]`]:data===null||data===void 0?void 0:(_data$translation4=data.translation)===null||_data$translation4===void 0?void 0:_data$translation4.description,shop:{label:data===null||data===void 0?void 0:(_data$shop=data.shop)===null||_data$shop===void 0?void 0:(_data$shop$translatio=_data$shop.translation)===null||_data$shop$translatio===void 0?void 0:_data$shop$translatio.title,value:data===null||data===void 0?void 0:(_data$shop2=data.shop)===null||_data$shop2===void 0?void 0:_data$shop2.id,key:data===null||data===void 0?void 0:(_data$shop3=data.shop)===null||_data$shop3===void 0?void 0:_data$shop3.id},products:data===null||data===void 0?void 0:(_data$products=data.products)===null||_data$products===void 0?void 0:_data$products.map(product=>{var _product$translation;return{label:product===null||product===void 0?void 0:(_product$translation=product.translation)===null||_product$translation===void 0?void 0:_product$translation.title,value:product===null||product===void 0?void 0:product.id,key:product===null||product===void 0?void 0:product.id};}),image:data===null||data===void 0?void 0:(_data$galleries=data.galleries)===null||_data$galleries===void 0?void 0:_data$galleries.map(img=>({uid:img.id,name:img.path,url:img.path})),active:Boolean(data===null||data===void 0?void 0:data.active)};form.setFieldsValue(body);dispatch(setMenuData({activeMenu,data:body}));}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};useEffect(()=>{if(activeMenu.refetch){fetchLook(id);}},[activeMenu.refetch]);const handleSubmit=(values,image)=>{const body={type:'look',active:Number(values.active),shop_id:values.shop.value,title:getTranslationFields(languages,values,'title'),description:getTranslationFields(languages,values,'description'),products:values.products.map(i=>i.value),images:image.map(image=>image.name)};return looksService.update(id,body);};return/*#__PURE__*/_jsx(Fragment,{children:!loading?/*#__PURE__*/_jsx(LooksForm,{form:form,handleSubmit:handleSubmit}):/*#__PURE__*/_jsx(Loading,{})});}","map":null,"metadata":{},"sourceType":"module"}