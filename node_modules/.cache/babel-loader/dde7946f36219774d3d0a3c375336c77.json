{"ast":null,"code":"import React,{useEffect,useMemo,useState}from'react';import{QuestionCircleOutlined}from'@ant-design/icons';import{t}from'i18next';import{Badge,Button,Card,Col,Divider,Row,Space,Tooltip}from'antd';import{GetColorName}from'hex-color-to-color-name';import{shallowEqual,useSelector}from'react-redux';import MediaUploadExtrasImage from'components/upload/upload-extras-image';import productService from'services/product';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const text='In the process of internal desktop applications development';const ProductGallery=_ref=>{var _filteredExtras$value;let{prev,next}=_ref;const[fileList,setFileList]=useState([]);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{newExtras}=(activeMenu===null||activeMenu===void 0?void 0:activeMenu.data)||{};const filteredExtras=useMemo(()=>newExtras===null||newExtras===void 0?void 0:newExtras.find(item=>{var _item$group;return(item===null||item===void 0?void 0:(_item$group=item.group)===null||_item$group===void 0?void 0:_item$group.type)==='color';}),[newExtras]);const uniqueData=Array.from(new Set(filteredExtras===null||filteredExtras===void 0?void 0:(_filteredExtras$value=filteredExtras.values)===null||_filteredExtras$value===void 0?void 0:_filteredExtras$value.map(item=>item.value))).map(value=>{var _filteredExtras$value2;return filteredExtras===null||filteredExtras===void 0?void 0:(_filteredExtras$value2=filteredExtras.values)===null||_filteredExtras$value2===void 0?void 0:_filteredExtras$value2.find(item=>item.value===value);});const colorItems=uniqueData.filter(item=>item.group_type==='color');const createImage=file=>{return{uid:file.path,name:file.path,status:'done',// done, uploading, error\nurl:file.path,created:true};};const setInitialState=()=>{const newArray=activeMenu.data.stocks.map(_ref2=>{let{id,galleries}=_ref2;return{id,images:(galleries===null||galleries===void 0?void 0:galleries.map(createImage))||[]};});setFileList(newArray);};const updateStocks=()=>{if(!fileList.length){next();return;}const array=fileList.map(item=>{return{...item,images:item.images.map(img=>img.name)};});productService.updateStocks({data:array}).then(()=>{next();}).catch(error=>{console.log(error);});};useEffect(()=>{setInitialState();},[activeMenu.data]);return/*#__PURE__*/_jsxs(Card,{title:/*#__PURE__*/_jsx(Tooltip,{placement:\"topLeft\",title:text,children:/*#__PURE__*/_jsxs(Space,{children:[t('add.media.file'),/*#__PURE__*/_jsx(QuestionCircleOutlined,{style:{fontSize:16,cursor:'pointer'}})]})}),children:[/*#__PURE__*/_jsx(Row,{gutter:[24,24],children:colorItems===null||colorItems===void 0?void 0:colorItems.map(_ref3=>{let{label,stock_id,value}=_ref3;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Col,{span:24,children:[/*#__PURE__*/_jsx(Space,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Badge,{color:label||value,className:\"extras-color-badge\",text:`${label||value} - ${GetColorName(label||value)}`})}),/*#__PURE__*/_jsx(MediaUploadExtrasImage,{id:stock_id,fileList:fileList,setFileList:setFileList,type:\"stocks\"})]}),/*#__PURE__*/_jsx(Divider,{})]});})}),/*#__PURE__*/_jsxs(Space,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Button,{onClick:prev,children:t('prev')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",onClick:updateStocks,children:t('next')})]})]});};export default ProductGallery;","map":null,"metadata":{},"sourceType":"module"}