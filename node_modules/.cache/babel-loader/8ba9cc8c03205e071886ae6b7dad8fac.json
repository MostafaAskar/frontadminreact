{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import{Card,Form,Steps}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{removeFromMenu,setMenuData}from'../../../redux/slices/menu';import{useTranslation}from'react-i18next';import LanguageList from'../../../components/language-list';import sellerReceptService from'../../../services/seller/reciept';import{steps}from'./steps';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const{Step}=Steps;const ReceptAdd=()=>{var _activeMenu$data,_activeMenu$data2,_activeMenu$data3;const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const dispatch=useDispatch();const[form]=Form.useForm();const navigate=useNavigate();const[image,setImage]=useState((_activeMenu$data=activeMenu.data)!==null&&_activeMenu$data!==void 0&&_activeMenu$data.image?[(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.image]:[]);const[current,setCurrent]=useState(((_activeMenu$data3=activeMenu.data)===null||_activeMenu$data3===void 0?void 0:_activeMenu$data3.step)||0);const next=()=>{const step=current+1;setCurrent(step);};const prev=()=>{const step=current-1;setCurrent(step);};const[loadingBtn,setLoadingBtn]=useState(false);useEffect(()=>{return()=>{const data=form.getFieldsValue(true);dispatch(setMenuData({activeMenu,data}));};},[]);const onFinish=values=>{var _values$stocks,_values$nutrition;form.validateFields();const body={...values,total_time:values.total_time.toString(),active_time:values.active_time.toString(),images:image===null||image===void 0?void 0:image.map(img=>img.name),category_id:values.category_id.value,stocks:(_values$stocks=values.stocks)===null||_values$stocks===void 0?void 0:_values$stocks.map(stock=>({min_quantity:stock.min_quantity,stock_id:stock.stock_id.value})),nutrition:(_values$nutrition=values.nutrition)===null||_values$nutrition===void 0?void 0:_values$nutrition.map(nutrition=>({...nutrition,percentage:nutrition.percentage.toString(),weight:nutrition.weight.toString()}))};setLoadingBtn(true);const nextUrl='seller/recept';sellerReceptService.create(body).then(()=>{toast.success(t('successfully.created'));navigate(`/${nextUrl}`);dispatch(removeFromMenu({...activeMenu,nextUrl}));}).finally(()=>setLoadingBtn(false));};return/*#__PURE__*/_jsx(Card,{title:t('add.recepe'),extra:/*#__PURE__*/_jsx(LanguageList,{}),children:/*#__PURE__*/_jsxs(Form,{layout:\"vertical\",onFinish:onFinish,form:form,initialValues:{active:true,...activeMenu.data},children:[/*#__PURE__*/_jsx(Steps,{current:current,children:steps.map(item=>/*#__PURE__*/_jsx(Step,{title:t(item.title)},item.title))}),steps.map(item=>{const Component=item.content;return/*#__PURE__*/_jsx(\"div\",{className:`steps-content ${item.step!==current+1&&'hidden'}`,children:/*#__PURE__*/_jsx(Component,{next:next,prev:prev,loading:loadingBtn,image:image,setImage:setImage})},item.title);})]})});};export default ReceptAdd;","map":null,"metadata":{},"sourceType":"module"}