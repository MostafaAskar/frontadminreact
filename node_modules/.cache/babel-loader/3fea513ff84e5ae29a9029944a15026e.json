{"ast":null,"code":"import React,{useEffect}from'react';import{Card,Col,DatePicker,Form,Row,Select}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import{setOrderData}from'../../redux/slices/order';import{getCurrentShop}from'../../redux/selectors/orderSelector';import moment from'moment';import shopService from'../../services/restaurant';import{setMenuData}from'../../redux/slices/menu';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const weeks=[{title:'sunday'},{title:'monday'},{title:'tuesday'},{title:'wednesday'},{title:'thursday'},{title:'friday'},{title:'saturday'}];const DeliveryInfo=()=>{var _activeMenu$data,_activeMenu$data$Curr,_activeMenu$data$Curr2,_activeMenu$data2,_activeMenu$data2$Cur,_activeMenu$data2$Cur2;const{t}=useTranslation();const dispatch=useDispatch();const{data}=useSelector(state=>state.order,shallowEqual);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const date=new Date(data===null||data===void 0?void 0:data.delivery_date);const shopTime=(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:(_activeMenu$data$Curr=_activeMenu$data.CurrentShop)===null||_activeMenu$data$Curr===void 0?void 0:(_activeMenu$data$Curr2=_activeMenu$data$Curr.shop_working_days)===null||_activeMenu$data$Curr2===void 0?void 0:_activeMenu$data$Curr2.filter(item=>item.disabled!==true).find(item=>{var _weeks$date$getDay;return(item===null||item===void 0?void 0:item.day)===((_weeks$date$getDay=weeks[date.getDay()])===null||_weeks$date$getDay===void 0?void 0:_weeks$date$getDay.title);});const filter=(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:(_activeMenu$data2$Cur=_activeMenu$data2.CurrentShop)===null||_activeMenu$data2$Cur===void 0?void 0:(_activeMenu$data2$Cur2=_activeMenu$data2$Cur.shop_closed_date)===null||_activeMenu$data2$Cur2===void 0?void 0:_activeMenu$data2$Cur2.map(date=>date.day);function disabledDate(current){const a=filter===null||filter===void 0?void 0:filter.find(date=>date===moment(current).format('YYYY-MM-DD'));const b=moment().add(-1,'days')>=current;if(a){return a;}else{return b;}}const range=(start,end)=>{const x=parseInt(start);const y=parseInt(end);const number=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24];for(let i=x;i<=y;i++){delete number[i];}return number;};const middle=(start,end)=>{const result=[];for(let i=start;i<end;i++){result.push(i);}return result;};const disabledDateTime=()=>({disabledHours:()=>range((shopTime===null||shopTime===void 0?void 0:shopTime.from.substring(0,2))>=moment(new Date()).format('HH')?shopTime===null||shopTime===void 0?void 0:shopTime.from.substring(0,2):moment(new Date()).format('HH'),shopTime===null||shopTime===void 0?void 0:shopTime.to.substring(0,2)),disabledMinutes:()=>middle(0,60),disabledSeconds:()=>middle(0,60)});const fetchShop=uuid=>{shopService.getById(uuid).then(data=>{const currency_shop=data===null||data===void 0?void 0:data.data;dispatch(setOrderData({currency_shop}));dispatch(setMenuData({activeMenu,data:{...(activeMenu===null||activeMenu===void 0?void 0:activeMenu.data),CurrentShop:data===null||data===void 0?void 0:data.data}}));});};const setDeliveryPrice=delivery=>dispatch(setOrderData({delivery_fee:delivery===null||delivery===void 0?void 0:delivery.value}));useEffect(()=>{var _data$shop;if(data!==null&&data!==void 0&&(_data$shop=data.shop)!==null&&_data$shop!==void 0&&_data$shop.value){var _data$shop2;fetchShop(data===null||data===void 0?void 0:(_data$shop2=data.shop)===null||_data$shop2===void 0?void 0:_data$shop2.value);}},[data===null||data===void 0?void 0:data.shop]);return/*#__PURE__*/_jsx(Card,{title:t('shipping.info'),children:/*#__PURE__*/_jsx(Row,{gutter:12,children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{name:\"delivery_date\",label:t('delivery.date'),rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DatePicker,{placeholder:t('delivery.date'),className:\"w-100\",format:\"YYYY-MM-DD\",disabledDate:disabledDate,onChange:e=>{const delivery_date=moment(e).format('YYYY-MM-DD');dispatch(setOrderData({delivery_date}));}})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:`${t('delivery.time')} (${t('up.to')})`,name:\"delivery_time\",rules:[{required:false,message:t('required')}],children:/*#__PURE__*/_jsx(DatePicker,{disabled:!(data!==null&&data!==void 0&&data.delivery_date),picker:\"time\",placeholder:t('start.time'),className:\"w-100\",format:'HH:mm:ss',showNow:false,disabledTime:disabledDateTime,onChange:e=>{const delivery_time=moment(e).format('HH:mm:ss');dispatch(setOrderData({delivery_time}));}})})})]})})})});};export default DeliveryInfo;","map":null,"metadata":{},"sourceType":"module"}