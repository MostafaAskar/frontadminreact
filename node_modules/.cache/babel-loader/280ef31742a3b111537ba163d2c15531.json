{"ast":null,"code":"import React,{useState}from'react';import{Card,Col,Empty,Row,Space,Spin}from'antd';import brandService from'../../../services/rest/brand';import categoryService from'../../../services/rest/category';import Meta from'antd/lib/card/Meta';import getImage from'../../../helpers/getImage';import{PlusOutlined}from'@ant-design/icons';import OrderItems from'./orderItems';import{DebounceSelect}from'../../../components/search';import SearchInput from'../../../components/search-input';import ExtrasModal from'./extrasModal';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{toast}from'react-toastify';import{fetchSellerProducts}from'../../../redux/slices/product';import useDidUpdate from'../../../helpers/useDidUpdate';import RiveResult from'../../../components/rive-result';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ProductInfo=_ref=>{let{form}=_ref;const[brand,setBrand]=useState(null);const[category,setCategory]=useState(null);const[search,setSearch]=useState(null);const[extrasModal,setExtrasModal]=useState(null);const dispatch=useDispatch();const{data}=useSelector(state=>state.order,shallowEqual);const{products,loading}=useSelector(state=>state.product,shallowEqual);useDidUpdate(()=>{const params={perPage:10,page:1,brand_id:brand===null||brand===void 0?void 0:brand.value,category_id:category===null||category===void 0?void 0:category.value,search};dispatch(fetchSellerProducts(params));},[brand,category,search]);async function fetchBrands(search){return brandService.search(search).then(_ref2=>{let{data}=_ref2;return data.map(item=>({label:item.title,value:item.id}));});}async function fetchCategories(search){const params={search};return categoryService.search(params).then(_ref3=>{let{data}=_ref3;return data.map(item=>{var _item$translation;return{label:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item.id};});});}const addProductToCart=item=>{if(!data.currency){toast.warning('Please, select currency');return;}setExtrasModal(item);};return/*#__PURE__*/_jsxs(Card,{title:\"Order details\",extra:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(DebounceSelect,{placeholder:\"Select category\",fetchOptions:fetchCategories,style:{minWidth:150},onChange:value=>setCategory(value),value:category}),/*#__PURE__*/_jsx(DebounceSelect,{placeholder:\"Select brand\",fetchOptions:fetchBrands,style:{minWidth:150},onChange:value=>setBrand(value),value:brand})]}),children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end mb-4\",children:/*#__PURE__*/_jsx(SearchInput,{placeholder:\"Search...\",handleChange:setSearch})}),/*#__PURE__*/_jsxs(\"div\",{className:\"products-row order-items\",children:[products.length?products.map(item=>{var _item$translation2,_item$translation3,_item$stock;return/*#__PURE__*/_jsxs(Card,{className:\"products-col\",cover:/*#__PURE__*/_jsx(\"img\",{alt:(_item$translation2=item.translation)===null||_item$translation2===void 0?void 0:_item$translation2.title,src:getImage(item.img)}),onClick:()=>addProductToCart(item),children:[/*#__PURE__*/_jsx(Meta,{title:(_item$translation3=item.translation)===null||_item$translation3===void 0?void 0:_item$translation3.title,description:(_item$stock=item.stock)===null||_item$stock===void 0?void 0:_item$stock.price}),/*#__PURE__*/_jsx(\"div\",{className:\"preview\",children:/*#__PURE__*/_jsx(PlusOutlined,{})})]},item.id);}):/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(RiveResult,{id:\"nosell\"})})}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loader\",children:/*#__PURE__*/_jsx(Spin,{})})]}),extrasModal&&/*#__PURE__*/_jsx(ExtrasModal,{extrasModal:extrasModal,setExtrasModal:setExtrasModal}),/*#__PURE__*/_jsx(OrderItems,{form:form})]});};export default ProductInfo;","map":null,"metadata":{},"sourceType":"module"}