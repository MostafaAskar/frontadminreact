{"ast":null,"code":"import{Button,Card,Col,Form,Row,Space}from'antd';import React,{useState,useEffect}from'react';import{useTranslation}from'react-i18next';import{shallowEqual,useSelector}from'react-redux';import DrawingManager from'../../components/drawing-map';import{BsArrowsMove}from'react-icons/bs';import MapGif from'../../assets/video/map.gif';import deliveryZone from'../../services/zone';import Loading from'../../components/loading';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const Map=_ref=>{let{next,prev}=_ref;const{t}=useTranslation();const[form]=Form.useForm();const[triangleCoords,settriangleCoords]=useState([]);const[loadingBtn,setLoadingBtn]=useState(false);const[merge,setMerge]=useState(null);const[loading,setLoading]=useState(false);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);function getMap(id){setLoading(true);deliveryZone.getById(id).then(res=>{var _res$data,_res$data$address;settriangleCoords(res.data!==undefined?(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$address=_res$data.address)===null||_res$data$address===void 0?void 0:_res$data$address.map(item=>({lat:item[0],lng:item[1]})):[]);}).finally(()=>setLoading(false));}const onFinish=()=>{if(triangleCoords.length<3){toast.warning(t('place.selected.map'));return;}if(!merge){toast.warning(t('place.selected.map'));return;}setLoadingBtn(true);const body={shop_id:activeMenu.data.id,address:triangleCoords.map(item=>({0:item.lat,1:item.lng}))};deliveryZone.create(body).then(()=>next()).finally(()=>setLoadingBtn(false));};useEffect(()=>{var _activeMenu$data;if((_activeMenu$data=activeMenu.data)!==null&&_activeMenu$data!==void 0&&_activeMenu$data.id){var _activeMenu$data2;getMap((_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.id);}},[activeMenu.data]);return/*#__PURE__*/_jsx(Form,{form:form,name:\"map\",layout:\"vertical\",onFinish:onFinish,children:!loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Card,{title:/*#__PURE__*/_jsx(\"h3\",{className:\"p-0 m-0\",children:t('delivery.zone')}),children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsxs(Col,{span:24,className:'mb-3',children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Instructions\"}),\"Create zone by click on map and connect the dots together\"]}),/*#__PURE__*/_jsx(Col,{span:24,className:'mb-3',children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(BsArrowsMove,{size:25}),/*#__PURE__*/_jsx(\"p\",{children:t('delivery.zone.text')})]})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(\"img\",{src:MapGif,alt:\"map gif\",style:{object:'contain'}})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(DrawingManager,{triangleCoords:triangleCoords,settriangleCoords:settriangleCoords,setMerge:setMerge})})]})})})}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('next')}),/*#__PURE__*/_jsx(Button,{htmlType:\"submit\",onClick:()=>prev(),children:t('prev')})]})]}):/*#__PURE__*/_jsx(Loading,{})});};export default Map;","map":null,"metadata":{},"sourceType":"module"}