{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/product-bonus/product-bonus-edit.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { Card, Form } from 'antd';\nimport { batch, shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, removeFromMenu, setMenuData } from 'redux/slices/menu';\nimport { useTranslation } from 'react-i18next';\nimport moment from 'moment';\nimport { fetchBonus } from 'redux/slices/product-bonus';\nimport bonusService from 'services/seller/bonus';\nimport Loading from 'components/loading';\nimport ProductBonusForm from './product-bonus-form';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProductBonusAdd = () => {\n  _s();\n\n  const {\n    t\n  } = useTranslation();\n  const {\n    activeMenu\n  } = useSelector(state => state.menu, shallowEqual);\n  const dispatch = useDispatch();\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const {\n    id\n  } = useParams();\n\n  function getProducts(bonus) {\n    var _bonus$stock, _bonus$stock$product, _bonus$stock$product$, _bonus$stock2, _bonus$stock2$extras, _bonus$stock3, _bonus$stock3$extras, _bonus$stock4, _bonus$stock5, _bonus$bonusStock, _bonus$bonusStock$pro, _bonus$bonusStock$pro2, _bonus$bonusStock2, _bonus$bonusStock2$ex, _bonus$bonusStock3, _bonus$bonusStock3$ex, _bonus$bonusStock4, _bonus$bonusStock5;\n\n    const data = {\n      status: bonus === null || bonus === void 0 ? void 0 : bonus.status,\n      expired_at: moment(bonus === null || bonus === void 0 ? void 0 : bonus.expired_at, 'YYYY-MM-DD'),\n      stock: {\n        label: (bonus === null || bonus === void 0 ? void 0 : (_bonus$stock = bonus.stock) === null || _bonus$stock === void 0 ? void 0 : (_bonus$stock$product = _bonus$stock.product) === null || _bonus$stock$product === void 0 ? void 0 : (_bonus$stock$product$ = _bonus$stock$product.translation) === null || _bonus$stock$product$ === void 0 ? void 0 : _bonus$stock$product$.title) + `${(bonus === null || bonus === void 0 ? void 0 : (_bonus$stock2 = bonus.stock) === null || _bonus$stock2 === void 0 ? void 0 : (_bonus$stock2$extras = _bonus$stock2.extras) === null || _bonus$stock2$extras === void 0 ? void 0 : _bonus$stock2$extras.length) > 0 ? `: ${bonus === null || bonus === void 0 ? void 0 : (_bonus$stock3 = bonus.stock) === null || _bonus$stock3 === void 0 ? void 0 : (_bonus$stock3$extras = _bonus$stock3.extras) === null || _bonus$stock3$extras === void 0 ? void 0 : _bonus$stock3$extras.map(ext => {\n          var _ext$value;\n\n          return ext === null || ext === void 0 ? void 0 : (_ext$value = ext.value) === null || _ext$value === void 0 ? void 0 : _ext$value.value;\n        }).join(', ')}` : ''}`,\n        value: bonus === null || bonus === void 0 ? void 0 : (_bonus$stock4 = bonus.stock) === null || _bonus$stock4 === void 0 ? void 0 : _bonus$stock4.id,\n        key: bonus === null || bonus === void 0 ? void 0 : (_bonus$stock5 = bonus.stock) === null || _bonus$stock5 === void 0 ? void 0 : _bonus$stock5.id\n      },\n      stock_quantity: bonus === null || bonus === void 0 ? void 0 : bonus.value,\n      bonus_stock: {\n        label: (bonus === null || bonus === void 0 ? void 0 : (_bonus$bonusStock = bonus.bonusStock) === null || _bonus$bonusStock === void 0 ? void 0 : (_bonus$bonusStock$pro = _bonus$bonusStock.product) === null || _bonus$bonusStock$pro === void 0 ? void 0 : (_bonus$bonusStock$pro2 = _bonus$bonusStock$pro.translation) === null || _bonus$bonusStock$pro2 === void 0 ? void 0 : _bonus$bonusStock$pro2.title) + `${(bonus === null || bonus === void 0 ? void 0 : (_bonus$bonusStock2 = bonus.bonusStock) === null || _bonus$bonusStock2 === void 0 ? void 0 : (_bonus$bonusStock2$ex = _bonus$bonusStock2.extras) === null || _bonus$bonusStock2$ex === void 0 ? void 0 : _bonus$bonusStock2$ex.length) > 0 ? `: ${bonus === null || bonus === void 0 ? void 0 : (_bonus$bonusStock3 = bonus.bonusStock) === null || _bonus$bonusStock3 === void 0 ? void 0 : (_bonus$bonusStock3$ex = _bonus$bonusStock3.extras) === null || _bonus$bonusStock3$ex === void 0 ? void 0 : _bonus$bonusStock3$ex.map(ext => {\n          var _ext$value2;\n\n          return ext === null || ext === void 0 ? void 0 : (_ext$value2 = ext.value) === null || _ext$value2 === void 0 ? void 0 : _ext$value2.value;\n        }).join(', ')}` : ''}`,\n        value: bonus === null || bonus === void 0 ? void 0 : (_bonus$bonusStock4 = bonus.bonusStock) === null || _bonus$bonusStock4 === void 0 ? void 0 : _bonus$bonusStock4.id,\n        key: bonus === null || bonus === void 0 ? void 0 : (_bonus$bonusStock5 = bonus.bonusStock) === null || _bonus$bonusStock5 === void 0 ? void 0 : _bonus$bonusStock5.id\n      },\n      bonus_stock_quantity: bonus === null || bonus === void 0 ? void 0 : bonus.bonus_quantity\n    };\n    console.log('data', data);\n    form.setFieldsValue(data);\n    dispatch(setMenuData({\n      activeMenu,\n      data: { ...data,\n        expired_at: bonus === null || bonus === void 0 ? void 0 : bonus.expired_at\n      }\n    }));\n    setLoading(false);\n  }\n\n  const getBonus = id => {\n    setLoading(true);\n    bonusService.getById(id).then(res => getProducts(res.data)).finally(() => dispatch(disableRefetch(activeMenu)));\n  };\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      getBonus(id);\n    }\n  }, [activeMenu.refetch]);\n\n  const onFinish = values => {\n    const nextUrl = 'seller/bonus/product';\n    return bonusService.update(id, values).then(() => {\n      toast.success(t('successfully.created'));\n      batch(() => {\n        dispatch(removeFromMenu({ ...activeMenu,\n          nextUrl\n        }));\n        dispatch(fetchBonus({}));\n      });\n      navigate(`/${nextUrl}`);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    title: t('edit.bonus'),\n    className: \"h-100\",\n    children: !loading ? /*#__PURE__*/_jsxDEV(ProductBonusForm, {\n      form: form,\n      handleSubmit: onFinish\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProductBonusAdd, \"83YnX7UN7yLTbhqf7H49mL6yYfw=\", false, function () {\n  return [useTranslation, useSelector, useDispatch, Form.useForm, useNavigate, useParams];\n});\n\n_c = ProductBonusAdd;\nexport default ProductBonusAdd;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductBonusAdd\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useParams","toast","Card","Form","batch","shallowEqual","useDispatch","useSelector","disableRefetch","removeFromMenu","setMenuData","useTranslation","moment","fetchBonus","bonusService","Loading","ProductBonusForm","ProductBonusAdd","t","activeMenu","state","menu","dispatch","form","useForm","navigate","loading","setLoading","id","getProducts","bonus","data","status","expired_at","stock","label","product","translation","title","extras","length","map","ext","value","join","key","stock_quantity","bonus_stock","bonusStock","bonus_stock_quantity","bonus_quantity","console","log","setFieldsValue","getBonus","getById","then","res","finally","refetch","onFinish","values","nextUrl","update","success"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/views/seller-views/product-bonus/product-bonus-edit.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { Card, Form } from 'antd';\nimport { batch, shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { disableRefetch, removeFromMenu, setMenuData } from 'redux/slices/menu';\nimport { useTranslation } from 'react-i18next';\nimport moment from 'moment';\nimport { fetchBonus } from 'redux/slices/product-bonus';\nimport bonusService from 'services/seller/bonus';\nimport Loading from 'components/loading';\nimport ProductBonusForm from './product-bonus-form';\n\nconst ProductBonusAdd = () => {\n  const { t } = useTranslation();\n  const { activeMenu } = useSelector((state) => state.menu, shallowEqual);\n  const dispatch = useDispatch();\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const { id } = useParams();\n\n  function getProducts(bonus) {\n    const data = {\n      status: bonus?.status,\n      expired_at: moment(bonus?.expired_at, 'YYYY-MM-DD'),\n      stock: {\n        label:\n          bonus?.stock?.product?.translation?.title +\n          `${\n            bonus?.stock?.extras?.length > 0\n              ? `: ${bonus?.stock?.extras\n                  ?.map((ext) => ext?.value?.value)\n                  .join(', ')}`\n              : ''\n          }`,\n        value: bonus?.stock?.id,\n        key: bonus?.stock?.id,\n      },\n      stock_quantity: bonus?.value,\n      bonus_stock: {\n        label:\n          bonus?.bonusStock?.product?.translation?.title +\n          `${\n            bonus?.bonusStock?.extras?.length > 0\n              ? `: ${bonus?.bonusStock?.extras\n                  ?.map((ext) => ext?.value?.value)\n                  .join(', ')}`\n              : ''\n          }`,\n        value: bonus?.bonusStock?.id,\n        key: bonus?.bonusStock?.id,\n      },\n      bonus_stock_quantity: bonus?.bonus_quantity,\n    };\n    console.log('data', data);\n    form.setFieldsValue(data);\n    dispatch(\n      setMenuData({\n        activeMenu,\n        data: { ...data, expired_at: bonus?.expired_at },\n      }),\n    );\n    setLoading(false);\n  }\n\n  const getBonus = (id) => {\n    setLoading(true);\n    bonusService\n      .getById(id)\n      .then((res) => getProducts(res.data))\n      .finally(() => dispatch(disableRefetch(activeMenu)));\n  };\n\n  useEffect(() => {\n    if (activeMenu.refetch) {\n      getBonus(id);\n    }\n  }, [activeMenu.refetch]);\n\n  const onFinish = (values) => {\n    const nextUrl = 'seller/bonus/product';\n\n    return bonusService.update(id, values).then(() => {\n      toast.success(t('successfully.created'));\n      batch(() => {\n        dispatch(removeFromMenu({ ...activeMenu, nextUrl }));\n        dispatch(fetchBonus({}));\n      });\n      navigate(`/${nextUrl}`);\n    });\n  };\n\n  return (\n    <Card title={t('edit.bonus')} className='h-100'>\n      {!loading ? (\n        <ProductBonusForm form={form} handleSubmit={onFinish} />\n      ) : (\n        <Loading />\n      )}\n    </Card>\n  );\n};\n\nexport default ProductBonusAdd;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}