{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Card,Col,Row,Space,Spin}from'antd';import RiveResult from'components/rive-result';import getImage from'helpers/getImage';import Meta from'antd/es/card/Meta';import{PlusOutlined}from'@ant-design/icons';import{fetchRestProducts}from'redux/slices/product';import{shallowEqual,useSelector,useDispatch}from'react-redux';import{useTranslation}from'react-i18next';import{DebounceSelect}from'components/search';import shopService from'services/shop';import categoryService from'services/category';import brandService from'services/brand';import SearchInput from'components/search-input';import ProductModal from'./product-modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ProductCards(){const{t}=useTranslation();const dispatch=useDispatch();const{products,loading}=useSelector(state=>state.product,shallowEqual);const[search,setSearch]=useState(null);const[shop,setShop]=useState(null);const[brand,setBrand]=useState(null);const[category,setCategory]=useState(null);const[productModal,setProductModal]=useState(null);async function fetchShops(search){const params={search,status:'approved'};return shopService.getAll(params).then(_ref=>{let{data}=_ref;return data.map(item=>{var _item$translation;return{label:item===null||item===void 0?void 0:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item===null||item===void 0?void 0:item.id,key:item===null||item===void 0?void 0:item.id};});});}async function fetchCategories(search){const params={search,type:'main'};return categoryService.search(params).then(_ref2=>{let{data}=_ref2;return data.map(item=>{var _item$translation2;return{label:item===null||item===void 0?void 0:(_item$translation2=item.translation)===null||_item$translation2===void 0?void 0:_item$translation2.title,value:item===null||item===void 0?void 0:item.id,key:item===null||item===void 0?void 0:item.id};});});}async function fetchBrands(search){return brandService.search(search).then(_ref3=>{let{data}=_ref3;return data.map(item=>{var _item$title;return{label:(_item$title=item===null||item===void 0?void 0:item.title)!==null&&_item$title!==void 0?_item$title:'--',value:item===null||item===void 0?void 0:item.id,key:item===null||item===void 0?void 0:item.id};});});}useEffect(()=>{const params={perPage:10,page:1,brand_id:brand===null||brand===void 0?void 0:brand.value,category_id:category===null||category===void 0?void 0:category.value,search,shop_id:shop===null||shop===void 0?void 0:shop.value,active:1};dispatch(fetchRestProducts(params));},[brand,category,search,shop]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{title:t('products'),className:'order-add',children:[/*#__PURE__*/_jsxs(Space,{wrap:true,className:'mb-4',children:[/*#__PURE__*/_jsx(SearchInput,{placeholder:t('search'),handleChange:value=>setSearch(value),defaultValue:search}),/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.shop'),fetchOptions:fetchShops,style:{minWidth:150},onChange:value=>setShop(value),value:shop}),/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.category'),fetchOptions:fetchCategories,style:{minWidth:150},onChange:value=>setCategory(value),value:category}),/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.brand'),fetchOptions:fetchBrands,style:{minWidth:150},onChange:value=>setBrand(value),value:brand})]}),products.length===0?/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(RiveResult,{id:\"nosell\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"products-row order-items\",children:[products.length?products.map(item=>{var _item$translation3,_item$translation4;return/*#__PURE__*/_jsxs(Card,{className:\"products-col\",cover:/*#__PURE__*/_jsx(\"img\",{alt:item===null||item===void 0?void 0:(_item$translation3=item.translation)===null||_item$translation3===void 0?void 0:_item$translation3.title,src:getImage(item===null||item===void 0?void 0:item.img)}),onClick:()=>setProductModal(item),children:[/*#__PURE__*/_jsx(Meta,{title:item===null||item===void 0?void 0:(_item$translation4=item.translation)===null||_item$translation4===void 0?void 0:_item$translation4.title}),/*#__PURE__*/_jsx(\"div\",{className:\"preview\",children:/*#__PURE__*/_jsx(PlusOutlined,{})})]},item.id);}):/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(RiveResult,{id:\"nosell\"})})}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loader\",children:/*#__PURE__*/_jsx(Spin,{})})]})]}),productModal&&/*#__PURE__*/_jsx(ProductModal,{productData:productModal,setProductData:setProductModal})]});}","map":null,"metadata":{},"sourceType":"module"}