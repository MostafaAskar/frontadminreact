{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/components/upload/upload-extras-image.js\",\n    _s = $RefreshSig$();\n\nimport { useState } from 'react';\nimport { Spin, Upload, message } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport galleryService from 'services/gallery';\nimport { useTranslation } from 'react-i18next';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ImageGallery = _ref => {\n  _s();\n\n  let {\n    fileList = [],\n    setFileList,\n    type,\n    id\n  } = _ref;\n  const {\n    t\n  } = useTranslation();\n  const [loading, setLoading] = useState(false);\n\n  const createImage = file => {\n    return {\n      uid: file.title,\n      name: file.title,\n      status: 'done',\n      // done, uploading, error\n      url: file.title,\n      created: true\n    };\n  };\n\n  const createUploadData = (id, img) => {\n    const stockIndex = fileList.findIndex(item => item.id === id);\n\n    if (stockIndex >= 0) {\n      const newArray = fileList.map(item => {\n        if (item.id === id) {\n          return {\n            id,\n            images: [...item.images, img]\n          };\n        } else {\n          return item;\n        }\n      });\n      setFileList(newArray);\n    } else setFileList(prev => [...prev, {\n      id,\n      images: [img]\n    }]);\n  };\n\n  const handleUpload = _ref2 => {\n    let {\n      file,\n      onSuccess\n    } = _ref2;\n    setLoading(true);\n    const formData = new FormData();\n    formData.append('image', file);\n    formData.append('type', type);\n    galleryService.upload(formData).then(_ref3 => {\n      let {\n        data\n      } = _ref3;\n      createUploadData(id, createImage(data));\n      onSuccess('ok');\n    }).finally(() => {\n      setLoading(false);\n    });\n  };\n\n  const handleRemove = file => {\n    const updatedData = fileList.map(item => {\n      if (item.id === id) {\n        const updatedImages = item.images.filter(image => image.uid !== file.uid);\n\n        if (updatedImages.length === 0) {\n          // If images array is empty, remove the object\n          return null;\n        }\n\n        return { ...item,\n          images: updatedImages\n        };\n      }\n\n      return item;\n    }).filter(item => item !== null);\n    setFileList(updatedData);\n  };\n\n  const uploadButton = loading ? /*#__PURE__*/_jsxDEV(Spin, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 34\n  }, this) : /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 45\n  }, this);\n  const currentFileList = fileList.find(item => item.id === id) || [];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Upload, {\n      listType: \"picture-card\",\n      fileList: (currentFileList === null || currentFileList === void 0 ? void 0 : currentFileList.galleries) || (currentFileList === null || currentFileList === void 0 ? void 0 : currentFileList.images),\n      customRequest: handleUpload,\n      onRemove: handleRemove,\n      showUploadList: true,\n      accept: \".png,.jpg,.jpeg,.webp\",\n      beforeUpload: file => {\n        const isItAtLeast2MB = file.size / 1024 / 1024 < 2;\n\n        if (!isItAtLeast2MB) {\n          message.error(t('max.2.mb'));\n          return false;\n        }\n\n        return true;\n      },\n      children: uploadButton\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(ImageGallery, \"aocHWkQvqqvab0vEvuTvY+o4aVQ=\", false, function () {\n  return [useTranslation];\n});\n\n_c = ImageGallery;\nexport default ImageGallery;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImageGallery\");","map":{"version":3,"names":["useState","Spin","Upload","message","PlusOutlined","galleryService","useTranslation","ImageGallery","fileList","setFileList","type","id","t","loading","setLoading","createImage","file","uid","title","name","status","url","created","createUploadData","img","stockIndex","findIndex","item","newArray","map","images","prev","handleUpload","onSuccess","formData","FormData","append","upload","then","data","finally","handleRemove","updatedData","updatedImages","filter","image","length","uploadButton","currentFileList","find","galleries","isItAtLeast2MB","size","error"],"sources":["/home/mostafa/Magde/new uzmart/admin/uzmart-admin-main/src/components/upload/upload-extras-image.js"],"sourcesContent":["import { useState } from 'react';\nimport { Spin, Upload, message } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport galleryService from 'services/gallery';\nimport { useTranslation } from 'react-i18next';\n\nconst ImageGallery = ({ fileList = [], setFileList, type, id }) => {\n  const { t } = useTranslation();\n  const [loading, setLoading] = useState(false);\n  const createImage = (file) => {\n    return {\n      uid: file.title,\n      name: file.title,\n      status: 'done', // done, uploading, error\n      url: file.title,\n      created: true,\n    };\n  };\n\n  const createUploadData = (id, img) => {\n    const stockIndex = fileList.findIndex((item) => item.id === id);\n\n    if (stockIndex >= 0) {\n      const newArray = fileList.map((item) => {\n        if (item.id === id) {\n          return {\n            id,\n            images: [...item.images, img],\n          };\n        } else {\n          return item;\n        }\n      });\n      setFileList(newArray);\n    } else setFileList((prev) => [...prev, { id, images: [img] }]);\n  };\n  const handleUpload = ({ file, onSuccess }) => {\n    setLoading(true);\n    const formData = new FormData();\n    formData.append('image', file);\n    formData.append('type', type);\n    galleryService\n      .upload(formData)\n      .then(({ data }) => {\n        createUploadData(id, createImage(data));\n        onSuccess('ok');\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  const handleRemove = (file) => {\n    const updatedData = fileList\n      .map((item) => {\n        if (item.id === id) {\n          const updatedImages = item.images.filter(\n            (image) => image.uid !== file.uid\n          );\n          if (updatedImages.length === 0) {\n            // If images array is empty, remove the object\n            return null;\n          }\n          return { ...item, images: updatedImages };\n        }\n        return item;\n      })\n      .filter((item) => item !== null);\n\n    setFileList(updatedData);\n  };\n\n  const uploadButton = loading ? <Spin /> : <PlusOutlined />;\n  const currentFileList = fileList.find((item) => item.id === id) || [];\n\n  return (\n    <>\n      <Upload\n        listType='picture-card'\n        fileList={currentFileList?.galleries || currentFileList?.images}\n        customRequest={handleUpload}\n        onRemove={handleRemove}\n        showUploadList={true}\n        accept='.png,.jpg,.jpeg,.webp'\n        beforeUpload={(file) => {\n          const isItAtLeast2MB = file.size / 1024 / 1024 < 2;\n          if (!isItAtLeast2MB) {\n            message.error(t('max.2.mb'));\n            return false;\n          }\n          return true;\n        }}\n      >\n        {uploadButton}\n      </Upload>\n    </>\n  );\n};\n\nexport default ImageGallery;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}