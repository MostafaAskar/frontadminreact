{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Col,Form,Input,Modal,Row}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import{setRefetch}from'../../redux/slices/menu';import paymentService from'../../services/payment';import Loading from'../../components/loading';import LanguageList from'../../components/language-list';import getTranslationFields from'../../helpers/getTranslationFields';import getLanguageFields from'../../helpers/getLanguageFields';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function PaymentEditModal(_ref){let{modal,handleCancel}=_ref;const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{languages,defaultLang}=useSelector(state=>state.formLang,shallowEqual);const[form]=Form.useForm();const dispatch=useDispatch();const{t}=useTranslation();const[loading,setLoading]=useState(false);const[loadingBtn,setLoadingBtn]=useState(false);function fetchPayment(id){setLoading(true);paymentService.getById(id).then(_ref2=>{let{data}=_ref2;const fields=['title','client_title','secret_title'];const translations=getLanguageFields(languages,data,fields);form.setFieldsValue({...data,...translations});}).finally(()=>setLoading(false));}useEffect(()=>{if(modal){fetchPayment(modal.id);}},[modal]);const onFinish=values=>{const params={client_id:values.client_id,secret_id:values.secret_id,title:getTranslationFields(languages,values,'title'),client_title:getTranslationFields(languages,values,'client_title'),secret_title:getTranslationFields(languages,values,'secret_title')};setLoadingBtn(true);paymentService.update(modal.id,params).then(()=>{handleCancel();dispatch(setRefetch(activeMenu));}).finally(()=>setLoadingBtn(false));};return/*#__PURE__*/_jsx(Modal,{visible:!!modal,title:t('edit.payment'),onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>form.submit(),loading:loadingBtn,children:t('save')},'save-btn'),/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancel-btn')],children:!loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsx(LanguageList,{})}),/*#__PURE__*/_jsx(Form,{form:form,layout:\"vertical\",onFinish:onFinish,children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:24,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('title'),name:`title[${item.locale}]`,rules:[{required:item.locale===defaultLang,message:t('required')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{})}))}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('client.title'),name:`client_title[${item.locale}]`,rules:[{required:item.locale===defaultLang,message:t('required')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{})}))}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('secret.title'),name:`secret_title[${item.locale}]`,rules:[{required:item.locale===defaultLang,message:t('requried')}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{})}))}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('client.id'),name:\"client_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('secret.id'),name:\"secret_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{})})})]})})]}):/*#__PURE__*/_jsx(Loading,{})});}","map":null,"metadata":{},"sourceType":"module"}