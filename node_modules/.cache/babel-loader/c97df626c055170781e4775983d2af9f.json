{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,Col,Image,Modal,Row,Space,Tag}from'antd';import{useParams}from'react-router-dom';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch}from'../../redux/slices/menu';import categoryService from'../../services/category';import{IMG_URL}from'../../configs/app-global';import{useTranslation}from'react-i18next';import CategoryList from'./category-list';import SubcategoryAdd from'./subcategory-add';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const CategoryShow=()=>{var _data$translation,_data$keywords,_data$parent,_data$parent$translat,_data$image;const{t}=useTranslation();const{uuid}=useParams();const dispatch=useDispatch();const[categoryId,setCategoryId]=useState(null);const[data,setData]=useState({});const[id,setId]=useState(null);const[isRefetch,setIsRefetch]=useState(null);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[loading,setLoading]=useState(false);const{languages,defaultLang}=useSelector(state=>state.formLang,shallowEqual);const createImage=name=>{return{name,url:IMG_URL+name};};function getLanguageFields(data){if(!data){return{};}const{translations}=data;const result=languages.map(item=>{var _translations$find,_translations$find2;return{[`title[${item.locale}]`]:(_translations$find=translations.find(el=>el.locale===item.locale))===null||_translations$find===void 0?void 0:_translations$find.title,[`description[${item.locale}]`]:(_translations$find2=translations.find(el=>el.locale===item.locale))===null||_translations$find2===void 0?void 0:_translations$find2.description};});return Object.assign({},...result);}const getCategory=alias=>{setLoading(true);categoryService.getById(alias).then(res=>{var _category$keywords,_category$parent,_category$parent$tran;let category=res.data;const body={...category,...getLanguageFields(category),image:[createImage(category.img)],keywords:category===null||category===void 0?void 0:(_category$keywords=category.keywords)===null||_category$keywords===void 0?void 0:_category$keywords.split(','),parent_id:{label:(_category$parent=category.parent)===null||_category$parent===void 0?void 0:(_category$parent$tran=_category$parent.translation)===null||_category$parent$tran===void 0?void 0:_category$parent$tran.title,value:category.parent_id,key:category.parent_id}};setData(body);setCategoryId(category.id);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const handleAddAction=id=>{setId(id);};const handleCancel=()=>{setId(null);};useEffect(()=>{if(uuid)getCategory(uuid);},[activeMenu.refetch,uuid]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{gutter:24,className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{title:t('basic.info'),style:{height:'100%'},loading:loading,children:/*#__PURE__*/_jsxs(Row,{gutter:[24,24],children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('category.name'),\":\"]}),/*#__PURE__*/_jsx(\"span\",{children:data===null||data===void 0?void 0:(_data$translation=data.translation)===null||_data$translation===void 0?void 0:_data$translation.title})]})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('category.description'),\":\"]}),/*#__PURE__*/_jsx(\"span\",{children:data[`description[${defaultLang||'en'}]`]})]})})]})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{title:t('organization'),style:{height:'100%'},loading:loading,children:/*#__PURE__*/_jsxs(Row,{gutter:[24,24],children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('keyword'),\":\"]}),data===null||data===void 0?void 0:(_data$keywords=data.keywords)===null||_data$keywords===void 0?void 0:_data$keywords.map((item,key)=>/*#__PURE__*/_jsx(Tag,{children:item},key))]})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('parent.category'),\":\"]}),/*#__PURE__*/_jsx(\"span\",{children:data===null||data===void 0?void 0:(_data$parent=data.parent)===null||_data$parent===void 0?void 0:(_data$parent$translat=_data$parent.translation)===null||_data$parent$translat===void 0?void 0:_data$parent$translat.title})]})})]})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{title:t('media'),style:{height:'100%'},loading:loading,children:/*#__PURE__*/_jsx(Space,{wrap:true,children:data===null||data===void 0?void 0:(_data$image=data.image)===null||_data$image===void 0?void 0:_data$image.map(item=>/*#__PURE__*/_jsx(Image,{src:item.url,width:100,height:100}))})})})]}),!!categoryId&&/*#__PURE__*/_jsx(CategoryList,{type:(data===null||data===void 0?void 0:data.type)==='main'?'sub_main':'child',parent_type:data===null||data===void 0?void 0:data.type,parentId:categoryId,handleAddAction:handleAddAction,isRefetch:isRefetch}),/*#__PURE__*/_jsx(Modal,{title:t('add.subcategory'),visible:id,onCancel:handleCancel,centered:true,footer:null,destroyOnClose:true,children:/*#__PURE__*/_jsx(SubcategoryAdd,{setId:setId,id:id,setIsRefetch:setIsRefetch,parent:{parent_id:{label:data[`title[${defaultLang}]`],value:data===null||data===void 0?void 0:data.id},id:data===null||data===void 0?void 0:data.id,type:data===null||data===void 0?void 0:data.type}})})]});};export default CategoryShow;","map":null,"metadata":{},"sourceType":"module"}