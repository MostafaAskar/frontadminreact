{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Card,Form,Tabs}from'antd';import{useParams}from'react-router-dom';import moment from'moment';import userService from'../../services/user';import Loading from'../../components/loading';import UserEditForm from'./userEditForm';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,setMenuData}from'../../redux/slices/menu';import{useTranslation}from'react-i18next';import UserOrders from'./userOrders';import WalletHistory from'./walletHistory';import createImage from'../../helpers/createImage';import UserPassword from'./userPassword';import DelivertSettingCreate from'./add-deliveryman-settings';import useDemo from'../../helpers/useDemo';import hideEmail from'../../components/hideEmail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;const{TabPane}=Tabs;const UserEdit=()=>{var _activeMenu$data;const{t}=useTranslation();const[form]=Form.useForm();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const dispatch=useDispatch();const{uuid}=useParams();const[loading,setLoading]=useState(false);const[tab,setTab]=useState('edit');const[image,setImage]=useState([]);const[id,setId]=useState(null);const role=activeMenu===null||activeMenu===void 0?void 0:(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.role;const{isDemo}=useDemo();const showUserData=uuid=>{setLoading(true);userService.getById(uuid).then(res=>{var _data$invitations,_data$invitations2,_res$data,_res$data$delivery_ma;const data=res.data;const payload={...data,image:data.img?createImage(data.img):[]};dispatch(setMenuData({activeMenu,data:payload}));form.setFieldsValue({firstname:data.firstname,lastname:data.lastname,email:isDemo?hideEmail(data.email):data.email,phone:data.phone,birthday:moment(data===null||data===void 0?void 0:data.birthday).format('YYYY-MM-DD'),gender:data.gender,password_confirmation:data.password_confirmation,password:data.password,shop_id:(data===null||data===void 0?void 0:(_data$invitations=data.invitations)===null||_data$invitations===void 0?void 0:_data$invitations.length)!==0?data===null||data===void 0?void 0:(_data$invitations2=data.invitations)===null||_data$invitations2===void 0?void 0:_data$invitations2.map(i=>{var _i$shop,_i$shop$translation,_i$shop2,_i$shop3;return{label:(_i$shop=i.shop)===null||_i$shop===void 0?void 0:(_i$shop$translation=_i$shop.translation)===null||_i$shop$translation===void 0?void 0:_i$shop$translation.title,value:(_i$shop2=i.shop)===null||_i$shop2===void 0?void 0:_i$shop2.id,key:(_i$shop3=i.shop)===null||_i$shop3===void 0?void 0:_i$shop3.id};}):undefined});setImage(data.img?[createImage(data.img)]:[]);setId((_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$delivery_ma=_res$data.delivery_man_setting)===null||_res$data$delivery_ma===void 0?void 0:_res$data$delivery_ma.id);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};useEffect(()=>{if(activeMenu!==null&&activeMenu!==void 0&&activeMenu.refetch)showUserData(uuid);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.refetch]);const onChange=key=>setTab(key);return/*#__PURE__*/_jsx(Card,{title:t('user.settings'),children:!loading?/*#__PURE__*/_jsxs(Tabs,{activeKey:tab,onChange:onChange,tabPosition:\"left\",size:\"small\",children:[/*#__PURE__*/_jsx(TabPane,{tab:t('edit.user'),children:/*#__PURE__*/_jsx(UserEditForm,{data:activeMenu===null||activeMenu===void 0?void 0:activeMenu.data,form:form,image:image,setImage:setImage,action_type:'edit'})},'edit'),role==='cook'&&/*#__PURE__*/_jsx(TabPane,{tab:t('orders'),children:/*#__PURE__*/_jsx(UserOrders,{data:activeMenu===null||activeMenu===void 0?void 0:activeMenu.data})},'order'),role==='deliveryman'&&/*#__PURE__*/_jsx(TabPane,{tab:t('deliveryman'),children:/*#__PURE__*/_jsx(DelivertSettingCreate,{id:id,data:activeMenu.data})},'delivery'),/*#__PURE__*/_jsx(TabPane,{tab:t('wallet'),children:/*#__PURE__*/_jsx(WalletHistory,{data:activeMenu===null||activeMenu===void 0?void 0:activeMenu.data})},'wallet'),/*#__PURE__*/_jsx(TabPane,{tab:t('password'),children:/*#__PURE__*/_jsx(UserPassword,{data:activeMenu===null||activeMenu===void 0?void 0:activeMenu.data})},'password')]}):/*#__PURE__*/_jsx(Loading,{})});};export default UserEdit;","map":null,"metadata":{},"sourceType":"module"}