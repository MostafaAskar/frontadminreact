{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import{Button,Card,Col,Form,Input,Row,Space,Switch}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{removeFromMenu,setMenuData}from'../../redux/slices/menu';import{fetchNotifications}from'../../redux/slices/notification';import blogService from'../../services/blog';import LanguageList from'../../components/language-list';import{useTranslation}from'react-i18next';import CkeEditor from'../../components/ckeEditor';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function NotificationAdd(){const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{languages,defaultLang}=useSelector(state=>state.formLang,shallowEqual);const dispatch=useDispatch();const[form]=Form.useForm();const navigate=useNavigate();const[loadingBtn,setLoadingBtn]=useState(false);useEffect(()=>{return()=>{const data=form.getFieldsValue(true);dispatch(setMenuData({activeMenu,data}));};},[]);function getTranslationFields(values){let field=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'title';const list=languages.map(item=>({[item.locale]:values[`${field}[${item.locale}]`]}));return Object.assign({},...list);}const onFinish=values=>{const body={type:'notification',title:getTranslationFields(values),description:getTranslationFields(values,'description'),short_desc:getTranslationFields(values,'short_desc')};setLoadingBtn(true);const nextUrl='notifications';blogService.create(body).then(()=>{toast.success(t('successfully.created'));dispatch(removeFromMenu({...activeMenu,nextUrl}));navigate(`/${nextUrl}`);dispatch(fetchNotifications({}));}).finally(()=>setLoadingBtn(false));};return/*#__PURE__*/_jsx(Card,{title:t('add.notification'),extra:/*#__PURE__*/_jsx(LanguageList,{}),children:/*#__PURE__*/_jsxs(Form,{name:\"notification-add\",layout:\"vertical\",onFinish:onFinish,form:form,initialValues:{active:true,...activeMenu.data},children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('title'),name:`title[${item.locale}]`,rules:[{validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{maxLength:50})},'title'+item.locale))}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('short.description'),name:`short_desc[${item.locale}]`,rules:[{validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<5){return Promise.reject(new Error(t('must.be.at.least.5')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{maxLength:50})},'short_desc'+item.locale))}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(CkeEditor,{form:form,languages:languages,lang:defaultLang})})]}),/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('save')})})]})});}","map":null,"metadata":{},"sourceType":"module"}