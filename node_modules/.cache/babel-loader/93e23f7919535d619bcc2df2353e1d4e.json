{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useSelector,useDispatch,shallowEqual}from'react-redux';import{disableRefetch}from'redux/slices/menu';import{useParams,useNavigate}from'react-router-dom';import{useTranslation}from'react-i18next';import{toast}from'react-toastify';import{Button,Card,Col,Descriptions,Row,Space,Spin,Alert}from'antd';import{IMG_URL}from'../../configs/app-global';import{removeFromMenu}from'../../redux/slices/menu';import{fetchRequestModels}from'redux/slices/request-models';import requestAdminModelsService from'services/request-models';import ProductRequestModal from'./product-request-modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const body={type:'product'};const ProductRequestDetail=()=>{var _changedInfo$shop,_changedInfo$category,_changedInfo$brand,_changedInfo$unit,_changedInfo$images,_changedInfo$stocks,_originalInfo$transla,_originalInfo$transla2,_originalInfo$shop,_originalInfo$categor,_originalInfo$brand,_originalInfo$unit,_originalInfo$galleri,_originalInfo$stocks;const dispatch=useDispatch();const navigate=useNavigate();const{t}=useTranslation();const{id}=useParams();const{activeMenu}=useSelector(state=>state.menu);const{defaultLang}=useSelector(state=>state.formLang,shallowEqual);const[loading,setLoading]=useState(false);const[isButtonLoading,setButtonLoading]=useState(false);const[data,setData]=useState({});const[model,setModel]=useState({});const[statusNote,setStatusNote]=useState('');const[modalVisible,setModalVisible]=useState(false);function fetchProductRequest(alias){setLoading(true);requestAdminModelsService.getById(alias).then(res=>{var _res$data;setData(res.data.data);setModel(res.data.model);setStatusNote((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.status_note);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});}function handleStatusUpdate(params){setButtonLoading(true);const nextUrl='catalog/products';requestAdminModelsService.changeStatus(id,params).then(()=>{navigate(`/${nextUrl}`,{state:{tab:'request'}});dispatch(removeFromMenu({...activeMenu,nextUrl}));toast.success(t('successfully.changed'));dispatch(fetchRequestModels(body));}).finally(()=>{setModalVisible(false);setButtonLoading(false);});}useEffect(()=>{fetchProductRequest(id);},[id]);const changedInfo=data;const originalInfo=model;return!loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Descriptions,{bordered:true,title:t('changed.info'),children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:`${t('title')} (${defaultLang})`,span:3,children:changedInfo[`title[${defaultLang}]`]}),/*#__PURE__*/_jsx(Descriptions.Item,{label:`${t('description')} (${defaultLang})`,span:3,children:changedInfo[`description[${defaultLang}]`]}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('shop'),span:1.5,children:changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$shop=changedInfo.shop)===null||_changedInfo$shop===void 0?void 0:_changedInfo$shop.translation.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('category'),span:1.5,children:changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$category=changedInfo.category)===null||_changedInfo$category===void 0?void 0:_changedInfo$category.label}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('brand'),span:1.5,children:changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$brand=changedInfo.brand)===null||_changedInfo$brand===void 0?void 0:_changedInfo$brand.label}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('unit'),span:1.5,children:changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$unit=changedInfo.unit)===null||_changedInfo$unit===void 0?void 0:_changedInfo$unit.label}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('images'),span:3,children:/*#__PURE__*/_jsx(Row,{gutter:12,children:changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$images=changedInfo.images)===null||_changedInfo$images===void 0?void 0:_changedInfo$images.map((item,idx)=>/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"img\",{width:80,alt:\"product\",src:item.url})},'image'+idx))})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('tax'),children:changedInfo===null||changedInfo===void 0?void 0:changedInfo.tax}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('min.quantity'),children:changedInfo===null||changedInfo===void 0?void 0:changedInfo.min_qty}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('max.quantity'),children:changedInfo===null||changedInfo===void 0?void 0:changedInfo.max_qty})]}),changedInfo===null||changedInfo===void 0?void 0:(_changedInfo$stocks=changedInfo.stocks)===null||_changedInfo$stocks===void 0?void 0:_changedInfo$stocks.map((item,idx)=>{var _item$ids;if(!item){return'';}return/*#__PURE__*/_jsxs(Descriptions,{bordered:true,className:\"mt-4\",children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:t('price'),span:2,children:item.price}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('quantity'),span:2,children:item.quantity}),item===null||item===void 0?void 0:(_item$ids=item.ids)===null||_item$ids===void 0?void 0:_item$ids.map((extra,idx)=>/*#__PURE__*/_jsx(Descriptions.Item,{label:changedInfo===null||changedInfo===void 0?void 0:changedInfo.extras[idx].label,children:extra===null||extra===void 0?void 0:extra.label},'extra'+idx))]},'desc'+idx);}),/*#__PURE__*/_jsxs(Descriptions,{bordered:true,className:\"mt-4\",title:t('original.info'),children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:`${t('title')} (${defaultLang})`,span:3,column:3,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$transla=originalInfo.translation)===null||_originalInfo$transla===void 0?void 0:_originalInfo$transla.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:`${t('description')} (${defaultLang})`,span:3,column:3,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$transla2=originalInfo.translation)===null||_originalInfo$transla2===void 0?void 0:_originalInfo$transla2.description}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('shop'),span:1.5,column:1.5,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$shop=originalInfo.shop)===null||_originalInfo$shop===void 0?void 0:_originalInfo$shop.translation.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('category'),span:1.5,column:1.5,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$categor=originalInfo.category)===null||_originalInfo$categor===void 0?void 0:_originalInfo$categor.translation.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('brand'),span:1.5,column:1.5,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$brand=originalInfo.brand)===null||_originalInfo$brand===void 0?void 0:_originalInfo$brand.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('unit'),span:1.5,column:1.5,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$unit=originalInfo.unit)===null||_originalInfo$unit===void 0?void 0:_originalInfo$unit.translation.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('images'),span:3,column:3,children:/*#__PURE__*/_jsx(Row,{gutter:12,children:originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$galleri=originalInfo.galleries)===null||_originalInfo$galleri===void 0?void 0:_originalInfo$galleri.map((item,idx)=>/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"img\",{width:80,alt:\"product\",src:IMG_URL+item.path})},'image'+idx))})}),/*#__PURE__*/_jsx(Descriptions.Item,{span:3,column:3,label:t('tax'),children:originalInfo===null||originalInfo===void 0?void 0:originalInfo.tax}),/*#__PURE__*/_jsx(Descriptions.Item,{span:3,column:3,label:t('min.quantity'),children:originalInfo===null||originalInfo===void 0?void 0:originalInfo.min_qty}),/*#__PURE__*/_jsx(Descriptions.Item,{span:3,column:3,label:t('max.quantity'),children:originalInfo===null||originalInfo===void 0?void 0:originalInfo.max_qty})]}),originalInfo===null||originalInfo===void 0?void 0:(_originalInfo$stocks=originalInfo.stocks)===null||_originalInfo$stocks===void 0?void 0:_originalInfo$stocks.map((item,idx)=>{var _item$extras;if(!item){return'';}return/*#__PURE__*/_jsxs(Descriptions,{bordered:true,className:\"mt-4\",children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:t('price'),span:2,column:2,children:item===null||item===void 0?void 0:item.price}),/*#__PURE__*/_jsx(Descriptions.Item,{label:t('quantity'),span:2,column:2,children:item===null||item===void 0?void 0:item.quantity}),item===null||item===void 0?void 0:(_item$extras=item.extras)===null||_item$extras===void 0?void 0:_item$extras.map((extra,idx)=>{var _extra$group,_extra$group$translat;return/*#__PURE__*/_jsx(Descriptions.Item,{label:extra===null||extra===void 0?void 0:(_extra$group=extra.group)===null||_extra$group===void 0?void 0:(_extra$group$translat=_extra$group.translation)===null||_extra$group$translat===void 0?void 0:_extra$group$translat.title,span:2,column:2,children:extra===null||extra===void 0?void 0:extra.value},'extra'+idx);})]},'desc'+idx);}),statusNote&&/*#__PURE__*/_jsx(Alert,{className:\"mt-4\",message:t('status.note'),description:statusNote,type:\"error\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end mt-4\",children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>{handleStatusUpdate({status:'approved'});},children:t('accept')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",danger:true,onClick:()=>{setModalVisible(true);},children:t('decline')})]})})]}),/*#__PURE__*/_jsx(ProductRequestModal,{data:{title:'decline'},visible:modalVisible,handleCancel:()=>setModalVisible(false),handleOk:handleStatusUpdate,laoding:isButtonLoading})]}):/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(Spin,{size:\"large\",className:\"py-5\"})});};export default ProductRequestDetail;","map":null,"metadata":{},"sourceType":"module"}