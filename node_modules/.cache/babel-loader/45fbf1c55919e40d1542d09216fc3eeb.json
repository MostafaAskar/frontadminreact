{"ast":null,"code":"import React,{useCallback,useEffect,useState}from'react';import{Card,Table,Image,Tag,Button,Space,Row,Col,Avatar,Typography,Skeleton,Spin,Badge,Steps,Divider}from'antd';import{CalendarOutlined,EditOutlined,SwapOutlined}from'@ant-design/icons';import{Link,useNavigate,useParams}from'react-router-dom';import orderService from'services/order';import getImage from'helpers/getImage';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{addMenu,disableRefetch,setMenuData}from'redux/slices/menu';import OrderStatusModal from'./orderStatusModal';import OrderDeliveryman from'./orderDeliveryman';import{useTranslation}from'react-i18next';import numberToPrice from'helpers/numberToPrice';import{clearOrder}from'redux/slices/order';import{MdEmail,MdLocationOn}from'react-icons/md';import ShowLocationsMap from'./show-locations.map';import{FiShoppingCart}from'react-icons/fi';import{IMG_URL}from'configs/app-global';import{BsCalendarDay,BsFillTelephoneFill,BsFillPersonFill}from'react-icons/bs';import{BiMessageDots,BiMoney}from'react-icons/bi';import moment from'moment';import{useRef}from'react';import{fetchOrderStatus}from'redux/slices/orderStatus';import useDemo from'helpers/useDemo';import hideEmail from'components/hideEmail';import QrCode from'components/qr-code';import hideNumber from'components/hideNumber';import TransactionStatusModal from'./transaction-status-modal';import{TrackingInfo}from'components/tracking-info';import{toast}from'react-toastify';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;export default function OrderDetails(){var _data$user,_data$user2,_data$details,_statusList$slice,_data$transaction,_data$transaction2,_data$transaction2$pa,_data$address$street_,_data$address,_ref2,_data$address$zipcode,_data$address2,_data$address3,_data$my_address$stre,_data$my_address,_data$my_address$zipc,_data$my_address2,_data$delivery_point$,_data$delivery_point,_data$delivery_point$2,_data$deliveryman,_data$deliveryman2,_data$deliveryman3,_data$deliveryman4,_data$deliveryman5,_data$deliveryman6,_data$deliveryman7,_data$user3,_data$user4,_data$user5,_data$user6,_data$user7,_data$user8,_data$user9,_data$user10,_data$user11,_data$user12,_data$user13,_data$review,_data$review2,_data$shop,_data$shop2,_data$shop3,_data$shop3$translati,_data$shop4,_data$shop5,_data$shop6,_data$shop7,_data$shop7$translati,_data$shop8,_data$shop8$translati,_activeMenu$data,_data$delivery_fee;const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{defaultCurrency}=useSelector(state=>state.currency,shallowEqual);const{defaultLang}=useSelector(state=>state.formLang,shallowEqual);const data=activeMenu.data;const{t}=useTranslation();const{id}=useParams();const dispatch=useDispatch();const navigate=useNavigate();const productListRef=useRef();const totalPriceRef=useRef();const{isDemo}=useDemo();const[locationsMap,setLocationsMap]=useState(null);const[loading,setLoading]=useState(false);const[transactionStatusModal,setTransactionStatusModal]=useState(false);const[orderId,setOrderId]=useState(null);const[orderDeliveryDetails,setOrderDeliveryDetails]=useState(null);const[isUpdating,setIsUpdating]=useState(false);const{statusList}=useSelector(state=>state.orderStatus,shallowEqual);const expandedRowRender=record=>{if(!(record!==null&&record!==void 0&&record.replace_stock))return;const columns=[{title:t('id'),dataIndex:'id',key:'id',render:(_,row)=>{var _row$replace_stock;return row===null||row===void 0?void 0:(_row$replace_stock=row.replace_stock)===null||_row$replace_stock===void 0?void 0:_row$replace_stock.id;}},{title:t('product.name'),dataIndex:'product',key:'product',render:(_,row)=>{var _row$replace_stock2,_row$replace_stock2$p,_row$replace_stock2$p2,_row$replace_stock3,_row$replace_stock3$e;return/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",className:\"relative\",children:[row===null||row===void 0?void 0:(_row$replace_stock2=row.replace_stock)===null||_row$replace_stock2===void 0?void 0:(_row$replace_stock2$p=_row$replace_stock2.product)===null||_row$replace_stock2$p===void 0?void 0:(_row$replace_stock2$p2=_row$replace_stock2$p.translation)===null||_row$replace_stock2$p2===void 0?void 0:_row$replace_stock2$p2.title,row===null||row===void 0?void 0:(_row$replace_stock3=row.replace_stock)===null||_row$replace_stock3===void 0?void 0:(_row$replace_stock3$e=_row$replace_stock3.extras)===null||_row$replace_stock3$e===void 0?void 0:_row$replace_stock3$e.map(extra=>{var _extra$group,_extra$group$translat,_extra$value;return/*#__PURE__*/_jsxs(Tag,{children:[extra===null||extra===void 0?void 0:(_extra$group=extra.group)===null||_extra$group===void 0?void 0:(_extra$group$translat=_extra$group.translation)===null||_extra$group$translat===void 0?void 0:_extra$group$translat.title,\": \",extra===null||extra===void 0?void 0:(_extra$value=extra.value)===null||_extra$value===void 0?void 0:_extra$value.value]},extra===null||extra===void 0?void 0:extra.id);})]});}},{title:t('image'),dataIndex:'img',key:'img',render:(_,row)=>{var _row$replace_stock4,_row$replace_stock4$p;return/*#__PURE__*/_jsx(Image,{src:getImage(row===null||row===void 0?void 0:(_row$replace_stock4=row.replace_stock)===null||_row$replace_stock4===void 0?void 0:(_row$replace_stock4$p=_row$replace_stock4.product)===null||_row$replace_stock4$p===void 0?void 0:_row$replace_stock4$p.img),alt:\"product\",width:100,height:\"auto\",className:\"rounded\",preview:true,placeholder:true});}},{title:t('price'),dataIndex:'price',key:'price',render:(_,row)=>{var _row$replace_stock5;return numberToPrice(row===null||row===void 0?void 0:(_row$replace_stock5=row.replace_stock)===null||_row$replace_stock5===void 0?void 0:_row$replace_stock5.price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('quantity'),dataIndex:'replace_quantity',key:'replace_quantity',render:(quantity,row)=>{var _row$replace_stock6,_row$replace_stock6$p;return/*#__PURE__*/_jsx(\"span\",{children:quantity*((row===null||row===void 0?void 0:(_row$replace_stock6=row.replace_stock)===null||_row$replace_stock6===void 0?void 0:(_row$replace_stock6$p=_row$replace_stock6.product)===null||_row$replace_stock6$p===void 0?void 0:_row$replace_stock6$p.interval)||1)});}},{title:t('discount'),dataIndex:'discount',key:'discount',render:(_,row)=>{var _row$replace_stock$di,_row$replace_stock7;return numberToPrice((_row$replace_stock$di=row===null||row===void 0?void 0:(_row$replace_stock7=row.replace_stock)===null||_row$replace_stock7===void 0?void 0:_row$replace_stock7.discount)!==null&&_row$replace_stock$di!==void 0?_row$replace_stock$di:0,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('tax'),dataIndex:'tax',key:'tax',render:(_,row)=>{var _row$replace_stock8;return numberToPrice(row===null||row===void 0?void 0:(_row$replace_stock8=row.replace_stock)===null||_row$replace_stock8===void 0?void 0:_row$replace_stock8.tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('total.price'),dataIndex:'total_price',key:'total_price',render:(_,row)=>{var _row$replace_stock9;return numberToPrice(row===null||row===void 0?void 0:(_row$replace_stock9=row.replace_stock)===null||_row$replace_stock9===void 0?void 0:_row$replace_stock9.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}}];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{display:'flex',justifyContent:'center',alignItems:'center'},children:/*#__PURE__*/_jsx(SwapOutlined,{style:{padding:'10px',margin:'10px 0 50px 0',border:'2px solid #cad2de',borderRadius:'30%'},rotate:90})}),/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:[record],pagination:false})]});};const columns=[{title:t('id'),dataIndex:'id',key:'id',render:(_,row)=>{var _row$stock;return row===null||row===void 0?void 0:(_row$stock=row.stock)===null||_row$stock===void 0?void 0:_row$stock.id;}},{title:t('product.name'),dataIndex:'product',key:'product',render:(_,row)=>{var _row$stock2,_row$stock2$product,_row$stock2$product$t,_row$stock3,_row$stock3$extras;return/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",className:\"relative\",children:[row===null||row===void 0?void 0:(_row$stock2=row.stock)===null||_row$stock2===void 0?void 0:(_row$stock2$product=_row$stock2.product)===null||_row$stock2$product===void 0?void 0:(_row$stock2$product$t=_row$stock2$product.translation)===null||_row$stock2$product$t===void 0?void 0:_row$stock2$product$t.title,row===null||row===void 0?void 0:(_row$stock3=row.stock)===null||_row$stock3===void 0?void 0:(_row$stock3$extras=_row$stock3.extras)===null||_row$stock3$extras===void 0?void 0:_row$stock3$extras.map(extra=>{var _extra$group2,_extra$group2$transla,_extra$value2;return/*#__PURE__*/_jsxs(Tag,{children:[(_extra$group2=extra.group)===null||_extra$group2===void 0?void 0:(_extra$group2$transla=_extra$group2.translation)===null||_extra$group2$transla===void 0?void 0:_extra$group2$transla.title,\": \",(_extra$value2=extra.value)===null||_extra$value2===void 0?void 0:_extra$value2.value]},extra===null||extra===void 0?void 0:extra.id);})]});}},{title:t('image'),dataIndex:'img',key:'img',render:(_,row)=>{var _row$stock4,_row$stock4$product;return/*#__PURE__*/_jsx(Image,{src:getImage(row===null||row===void 0?void 0:(_row$stock4=row.stock)===null||_row$stock4===void 0?void 0:(_row$stock4$product=_row$stock4.product)===null||_row$stock4$product===void 0?void 0:_row$stock4$product.img),alt:\"product\",width:100,height:\"auto\",className:\"rounded\",preview:true,placeholder:true});}},{title:t('price'),dataIndex:'origin_price',key:'origin_price',render:(_,row)=>{var _row$stock5;return numberToPrice(row===null||row===void 0?void 0:(_row$stock5=row.stock)===null||_row$stock5===void 0?void 0:_row$stock5.price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('quantity'),dataIndex:'quantity',key:'quantity',render:(quantity,row)=>{var _row$stock6,_row$stock6$product;return row!==null&&row!==void 0&&row.bonus?/*#__PURE__*/_jsx(Tag,{color:\"green\",children:t('bonus')}):/*#__PURE__*/_jsx(\"span\",{children:quantity*((row===null||row===void 0?void 0:(_row$stock6=row.stock)===null||_row$stock6===void 0?void 0:(_row$stock6$product=_row$stock6.product)===null||_row$stock6$product===void 0?void 0:_row$stock6$product.interval)||1)});}},{title:t('discount'),dataIndex:'rate_discount',key:'rate_discount',render:(_,row)=>{var _row$stock7;return numberToPrice(row===null||row===void 0?void 0:(_row$stock7=row.stock)===null||_row$stock7===void 0?void 0:_row$stock7.discount,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('tax'),dataIndex:'tax',key:'tax',render:(_,row)=>numberToPrice(row===null||row===void 0?void 0:row.tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)},{title:t('total.price'),dataIndex:'total_price',key:'total_price',render:(_,row)=>{return numberToPrice(row===null||row===void 0?void 0:row.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('actions'),dataIndex:'actions',key:'actions',render:(_,row)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:'primary',icon:/*#__PURE__*/_jsx(SwapOutlined,{}),onClick:()=>goToReplaceProduct(row),disabled:(data===null||data===void 0?void 0:data.status)!=='new'&&(data===null||data===void 0?void 0:data.status)!=='accepted'||(row===null||row===void 0?void 0:row.bonus)})})},{title:t('note'),dataIndex:'note',key:'note',render:note=>note||'--'}];const documentColumns=[{title:t('date'),dataIndex:'date',key:'date',render:date=>moment(date).format('YYYY-MM-DD HH:mm')},{title:t('document'),dataIndex:'document',key:'document'},{title:t('number'),dataIndex:'number',key:'number'},{title:t('total.price'),dataIndex:'price',key:'price'}];const documents=[{price:numberToPrice(data===null||data===void 0?void 0:data.total_price,defaultCurrency.symbol),number:/*#__PURE__*/_jsxs(Link,{to:`/orders/generate-invoice/${data===null||data===void 0?void 0:data.id}`,children:[\"#\",data===null||data===void 0?void 0:data.id]}),document:t('invoice'),date:moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')},{price:'-',number:/*#__PURE__*/_jsxs(Link,{to:`/orders/generate-invoice/${data===null||data===void 0?void 0:data.id}`,children:[\"#\",data===null||data===void 0?void 0:data.id]}),document:t('delivery.receipt'),date:moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')}];const handleCloseModal=()=>{setOrderId(null);setOrderDeliveryDetails(null);setLocationsMap(null);};function fetchOrder(){setLoading(true);orderService.getById(id).then(_ref=>{let{data}=_ref;dispatch(setMenuData({activeMenu,data}));}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});}const goToEdit=()=>{dispatch(clearOrder());dispatch(addMenu({url:`order/${id}`,id:'order_edit',name:t('edit.order')}));navigate(`/order/${id}`);};const handleUpdateTracking=useCallback(body=>{setIsUpdating(true);orderService.updateTracking(data===null||data===void 0?void 0:data.id,body).then(()=>{toast.success(t('successfully.updated'));fetchOrder();}).finally(()=>{setIsUpdating(false);});},[data===null||data===void 0?void 0:data.id]);const goToUser=()=>{dispatch(addMenu({url:`users/user/${data===null||data===void 0?void 0:data.user.uuid}`,id:'user_info',name:t('user.info')}));navigate(`/users/user/${data===null||data===void 0?void 0:data.user.uuid}`,{state:{user_id:data===null||data===void 0?void 0:data.user.id}});};const goToReplaceProduct=row=>{var _row$stock8,_row$stock9;dispatch(addMenu({url:`order/details/${data===null||data===void 0?void 0:data.id}/replace/${row===null||row===void 0?void 0:(_row$stock8=row.stock)===null||_row$stock8===void 0?void 0:_row$stock8.id}`,id:'replace_product',name:t('replace.product')}));navigate(`/order/details/${data===null||data===void 0?void 0:data.id}/replace/${row===null||row===void 0?void 0:(_row$stock9=row.stock)===null||_row$stock9===void 0?void 0:_row$stock9.id}`,{state:{data}});};useEffect(()=>{if(activeMenu.refetch){fetchOrder();if(statusList.length===0){dispatch(fetchOrderStatus({}));}}},[activeMenu.refetch]);return/*#__PURE__*/_jsxs(\"div\",{className:\"order_details\",children:[/*#__PURE__*/_jsx(Card,{className:\"order-details-info\",title:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FiShoppingCart,{className:\"mr-2 icon\"}),`${t('order')} ${data!==null&&data!==void 0&&data.id?`#${data===null||data===void 0?void 0:data.id} `:''}`,' ',t('from.order'),\" \",data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.firstname,' ',(data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.lastname)||'']}),extra:(data===null||data===void 0?void 0:data.status)!=='delivered'&&(data===null||data===void 0?void 0:data.status)!=='canceled'?/*#__PURE__*/_jsxs(Space,{children:[(data===null||data===void 0?void 0:data.status)!=='delivered'&&(data===null||data===void 0?void 0:data.status)!=='canceled'?/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>setOrderId(data===null||data===void 0?void 0:data.id),children:t('change.status')}):null,/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:goToEdit,children:t('edit')})]}):''}),/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Space,{className:\"justify-content-between w-100\",children:[/*#__PURE__*/_jsxs(Space,{className:\"align-items-start\",children:[/*#__PURE__*/_jsx(CalendarOutlined,{className:\"order-card-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(Typography.Text,{children:t('delivery.date')}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):/*#__PURE__*/_jsxs(Typography.Text,{className:\"order-card-title\",children:[data===null||data===void 0?void 0:data.delivery_date,\" \",data===null||data===void 0?void 0:data.delivery_time]})]})]}),/*#__PURE__*/_jsxs(Space,{className:\"align-items-start\",onClick:()=>totalPriceRef.current.scrollIntoView({behavior:'smooth'}),children:[/*#__PURE__*/_jsx(BiMoney,{className:\"order-card-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(Typography.Text,{children:t('total.price')}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16,loading:loading}):/*#__PURE__*/_jsx(Typography.Text,{className:\"order-card-title\",children:numberToPrice(data===null||data===void 0?void 0:data.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]})]}),/*#__PURE__*/_jsxs(Space,{className:\"align-items-start\",children:[/*#__PURE__*/_jsx(BiMessageDots,{className:\"order-card-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(Typography.Text,{children:t('messages')}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):/*#__PURE__*/_jsx(Typography.Text,{className:\"order-card-title\",children:data!==null&&data!==void 0&&data.review?1:0})]})]}),/*#__PURE__*/_jsxs(Space,{className:\"align-items-start\",onClick:()=>productListRef.current.scrollIntoView({behavior:'smooth'}),children:[/*#__PURE__*/_jsx(FiShoppingCart,{className:\"order-card-icon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(Typography.Text,{children:t('products')}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):/*#__PURE__*/_jsx(Typography.Text,{className:\"order-card-title\",children:data===null||data===void 0?void 0:(_data$details=data.details)===null||_data$details===void 0?void 0:_data$details.reduce((total,item)=>total+=item.quantity||0,0)})]})]})]})})}),(data===null||data===void 0?void 0:data.status)!=='canceled'&&/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Steps,{current:statusList===null||statusList===void 0?void 0:statusList.findIndex(item=>item.name===(data===null||data===void 0?void 0:data.status)),children:statusList===null||statusList===void 0?void 0:(_statusList$slice=statusList.slice(0,-1))===null||_statusList$slice===void 0?void 0:_statusList$slice.filter(item=>item===null||item===void 0?void 0:item.active).map(item=>/*#__PURE__*/_jsx(Steps.Step,{title:t(item.name)},item.id))})})}),/*#__PURE__*/_jsxs(Col,{span:16,children:[/*#__PURE__*/_jsx(Spin,{spinning:loading,children:/*#__PURE__*/_jsxs(Card,{style:{minHeight:'200px'},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[t('details'),\":\"]}),/*#__PURE__*/_jsxs(Row,{hidden:loading,className:\"mb-3 order_detail\",gutter:10,children:[/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsxs(\"div\",{children:[t('created.date.&.time'),\":\",/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[/*#__PURE__*/_jsx(BsCalendarDay,{className:\"mr-1\"}),' ',moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm'),' ']})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('delivery.date.&.time'),\":\",/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[/*#__PURE__*/_jsx(BsCalendarDay,{className:\"mr-1\"}),\" \",data===null||data===void 0?void 0:data.delivery_date,' ',data===null||data===void 0?void 0:data.delivery_time]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('payment.status'),\":\",/*#__PURE__*/_jsxs(\"span\",{style:{cursor:'pointer'},className:\"ml-2\",onClick:()=>setTransactionStatusModal(true),children:[t(data===null||data===void 0?void 0:(_data$transaction=data.transaction)===null||_data$transaction===void 0?void 0:_data$transaction.status),\" \",/*#__PURE__*/_jsx(EditOutlined,{})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('note'),\":\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:t(!!(data!==null&&data!==void 0&&data.note)?data===null||data===void 0?void 0:data.note:'')})]})]}),/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsxs(\"div\",{children:[t('status'),\":\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:(data===null||data===void 0?void 0:data.status)==='new'?/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:t(data===null||data===void 0?void 0:data.status)}):(data===null||data===void 0?void 0:data.status)==='canceled'?/*#__PURE__*/_jsx(Tag,{color:\"error\",children:t(data===null||data===void 0?void 0:data.status)}):/*#__PURE__*/_jsx(Tag,{color:\"cyan\",children:t(data===null||data===void 0?void 0:data.status)})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('delivery.type'),\":\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:data===null||data===void 0?void 0:data.delivery_type})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('payment.type'),\":\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:t(data===null||data===void 0?void 0:(_data$transaction2=data.transaction)===null||_data$transaction2===void 0?void 0:(_data$transaction2$pa=_data$transaction2.payment_system)===null||_data$transaction2$pa===void 0?void 0:_data$transaction2$pa.tag)})]}),/*#__PURE__*/_jsx(\"br\",{})]})]}),/*#__PURE__*/_jsxs(Row,{hidden:loading,className:\"mb-3 order_detail\",children:[/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsxs(\"h3\",{children:[t('delivery.address'),\":\"]}),/*#__PURE__*/_jsx(\"div\",{children:!!(data!==null&&data!==void 0&&data.address)?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[t('street.house.number'),\":\",' ',(_data$address$street_=data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.street_house_number)!==null&&_data$address$street_!==void 0?_data$address$street_:t('not.given')]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('zipcode'),\":\",' ',(_ref2=(_data$address$zipcode=data===null||data===void 0?void 0:(_data$address2=data.address)===null||_data$address2===void 0?void 0:_data$address2.zipcode)!==null&&_data$address$zipcode!==void 0?_data$address$zipcode:data===null||data===void 0?void 0:(_data$address3=data.address)===null||_data$address3===void 0?void 0:_data$address3.zip_code)!==null&&_ref2!==void 0?_ref2:t('not.given')]})]}):!!(data!==null&&data!==void 0&&data.my_address)?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[t('street.house.number'),\":\",' ',(_data$my_address$stre=data===null||data===void 0?void 0:(_data$my_address=data.my_address)===null||_data$my_address===void 0?void 0:_data$my_address.street_house_number)!==null&&_data$my_address$stre!==void 0?_data$my_address$stre:t('not.given')]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[t('zipcode'),\":\",' ',(_data$my_address$zipc=data===null||data===void 0?void 0:(_data$my_address2=data.my_address)===null||_data$my_address2===void 0?void 0:_data$my_address2.zipcode)!==null&&_data$my_address$zipc!==void 0?_data$my_address$zipc:t('not.given')]})]}):data!==null&&data!==void 0&&data.delivery_point?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[t('address'),\":\",' ',(_data$delivery_point$=data===null||data===void 0?void 0:(_data$delivery_point=data.delivery_point)===null||_data$delivery_point===void 0?void 0:(_data$delivery_point$2=_data$delivery_point.address)===null||_data$delivery_point$2===void 0?void 0:_data$delivery_point$2[defaultLang])!==null&&_data$delivery_point$!==void 0?_data$delivery_point$:t('no.address')]})}):(data===null||data===void 0?void 0:data.delivery_type)==='digital'?/*#__PURE__*/_jsx(\"div\",{children:t('digital.delivery')}):/*#__PURE__*/_jsx(\"div\",{children:t('no.address')})}),/*#__PURE__*/_jsxs(Button,{className:\"map_show mt-3\",onClick:()=>setLocationsMap(id),children:[/*#__PURE__*/_jsx(MdLocationOn,{style:{marginRight:'8px'}}),' ',t('show.locations')]})]}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(QrCode,{orderId:id})})]})]})}),/*#__PURE__*/_jsx(Card,{title:t('documents'),children:/*#__PURE__*/_jsx(Table,{columns:documentColumns,dataSource:documents,pagination:false,loading:loading})})]}),/*#__PURE__*/_jsxs(Col,{span:8,className:\"order_info\",children:[(data===null||data===void 0?void 0:data.delivery_type)==='delivery'&&/*#__PURE__*/_jsxs(Card,{title:t('deliveryman'),extra:(data===null||data===void 0?void 0:data.status)==='ready'&&(data===null||data===void 0?void 0:data.delivery_type)!=='pickup'&&/*#__PURE__*/_jsxs(Button,{onClick:()=>setOrderDeliveryDetails(data),children:[t('change'),/*#__PURE__*/_jsx(EditOutlined,{})]}),children:[(data===null||data===void 0?void 0:data.status)==='new'||(data===null||data===void 0?void 0:data.status)==='accepted'?/*#__PURE__*/_jsx(\"p\",{children:t('order_status_ready')}):'',(data===null||data===void 0?void 0:data.status)!=='new'&&(data===null||data===void 0?void 0:data.status)!=='accepted'&&!(data!==null&&data!==void 0&&data.deliveryman)?/*#__PURE__*/_jsx(\"p\",{children:t('The supplier is not assigned or delivery type pickup')}):'',(data===null||data===void 0?void 0:data.deliveryman)&&/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Avatar,{shape:\"square\",size:64,src:IMG_URL+(data===null||data===void 0?void 0:(_data$deliveryman=data.deliveryman)===null||_data$deliveryman===void 0?void 0:_data$deliveryman.img)}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[data===null||data===void 0?void 0:(_data$deliveryman2=data.deliveryman)===null||_data$deliveryman2===void 0?void 0:_data$deliveryman2.firstname,' ',(data===null||data===void 0?void 0:(_data$deliveryman3=data.deliveryman)===null||_data$deliveryman3===void 0?void 0:_data$deliveryman3.lastname)||'']}),/*#__PURE__*/_jsxs(\"span\",{className:\"delivery-info\",children:[/*#__PURE__*/_jsx(BsFillTelephoneFill,{}),data!==null&&data!==void 0&&(_data$deliveryman4=data.deliveryman)!==null&&_data$deliveryman4!==void 0&&_data$deliveryman4.phone?hideNumber(data===null||data===void 0?void 0:(_data$deliveryman5=data.deliveryman)===null||_data$deliveryman5===void 0?void 0:_data$deliveryman5.phone):t('no.phone')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-info\",children:[/*#__PURE__*/_jsx(\"b\",{children:/*#__PURE__*/_jsx(MdEmail,{size:16})}),/*#__PURE__*/_jsx(\"span\",{children:isDemo||ReactAppIsDemo?hideEmail(data===null||data===void 0?void 0:(_data$deliveryman6=data.deliveryman)===null||_data$deliveryman6===void 0?void 0:_data$deliveryman6.email):data===null||data===void 0?void 0:(_data$deliveryman7=data.deliveryman)===null||_data$deliveryman7===void 0?void 0:_data$deliveryman7.email})]})]})]})]}),(data===null||data===void 0?void 0:data.type)===2&&(data===null||data===void 0?void 0:data.delivery_type)==='delivery'&&/*#__PURE__*/_jsx(Card,{title:t('tracking.info'),children:/*#__PURE__*/_jsx(TrackingInfo,{onSubmit:handleUpdateTracking,isSubmitting:isUpdating,initialData:{track_name:data===null||data===void 0?void 0:data.track_name,track_id:data===null||data===void 0?void 0:data.track_id,track_url:data===null||data===void 0?void 0:data.track_url}})}),!!(data!==null&&data!==void 0&&data.username)&&/*#__PURE__*/_jsxs(Card,{title:t('order.receiver'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('name')}),/*#__PURE__*/_jsxs(\"span\",{className:\"description\",children:[/*#__PURE__*/_jsx(BsFillPersonFill,{}),data===null||data===void 0?void 0:data.username]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('phone')}),/*#__PURE__*/_jsxs(\"span\",{className:\"description\",children:[/*#__PURE__*/_jsx(BsFillTelephoneFill,{}),data===null||data===void 0?void 0:data.phone]})]})]}),!!(data!==null&&data!==void 0&&data.user)&&/*#__PURE__*/_jsx(Card,{title:/*#__PURE__*/_jsxs(Space,{children:[t('customer.info'),/*#__PURE__*/_jsx(EditOutlined,{onClick:()=>goToUser()})]}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex w-100 customer-info-container\",children:[loading?/*#__PURE__*/_jsx(Skeleton.Avatar,{size:64,shape:\"square\"}):/*#__PURE__*/_jsx(Avatar,{shape:\"square\",size:64,src:data===null||data===void 0?void 0:(_data$user3=data.user)===null||_data$user3===void 0?void 0:_data$user3.img}),/*#__PURE__*/_jsx(\"h5\",{className:\"customer-name\",children:loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:20,style:{width:70}}):(data===null||data===void 0?void 0:(_data$user4=data.user)===null||_data$user4===void 0?void 0:_data$user4.firstname)+' '+((data===null||data===void 0?void 0:(_data$user5=data.user)===null||_data$user5===void 0?void 0:_data$user5.lastname)||'')}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('phone')}),/*#__PURE__*/_jsxs(\"span\",{className:\"description\",children:[/*#__PURE__*/_jsx(BsFillTelephoneFill,{}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):data!==null&&data!==void 0&&(_data$user6=data.user)!==null&&_data$user6!==void 0&&_data$user6.phone?ReactAppIsDemo?hideNumber(data===null||data===void 0?void 0:(_data$user7=data.user)===null||_data$user7===void 0?void 0:_data$user7.phone):data===null||data===void 0?void 0:(_data$user8=data.user)===null||_data$user8===void 0?void 0:_data$user8.phone:t('no.phone')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('email')}),/*#__PURE__*/_jsxs(\"span\",{className:\"description\",children:[/*#__PURE__*/_jsx(MdEmail,{}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):isDemo||ReactAppIsDemo?hideEmail(data===null||data===void 0?void 0:(_data$user9=data.user)===null||_data$user9===void 0?void 0:_data$user9.email):data===null||data===void 0?void 0:(_data$user10=data.user)===null||_data$user10===void 0?void 0:_data$user10.email]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('registration.date')}),/*#__PURE__*/_jsxs(\"span\",{className:\"description\",children:[/*#__PURE__*/_jsx(BsCalendarDay,{}),loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):moment(data===null||data===void 0?void 0:(_data$user11=data.user)===null||_data$user11===void 0?void 0:_data$user11.created_at).format('DD-MM-YYYY, HH:mm')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('orders.count')}),/*#__PURE__*/_jsx(\"span\",{className:\"description\",children:loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):/*#__PURE__*/_jsx(Badge,{showZero:true,style:{backgroundColor:'#3d7de3'},count:(data===null||data===void 0?void 0:(_data$user12=data.user)===null||_data$user12===void 0?void 0:_data$user12.orders_count)||0})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:t('spent.since.registration')}),/*#__PURE__*/_jsx(\"span\",{className:\"description\",children:loading?/*#__PURE__*/_jsx(Skeleton.Button,{size:16}):/*#__PURE__*/_jsx(Badge,{showZero:true,style:{backgroundColor:'#48e33d'},count:numberToPrice(data===null||data===void 0?void 0:(_data$user13=data.user)===null||_data$user13===void 0?void 0:_data$user13.orders_sum_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})})]})]})]})}),(data===null||data===void 0?void 0:data.review)&&!loading&&/*#__PURE__*/_jsx(Card,{title:t('messages'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"order-message\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"message\",children:data===null||data===void 0?void 0:(_data$review=data.review)===null||_data$review===void 0?void 0:_data$review.comment}),/*#__PURE__*/_jsx(Space,{className:\"w-100 justify-content-end\",children:/*#__PURE__*/_jsx(\"span\",{className:\"date\",children:moment(data===null||data===void 0?void 0:(_data$review2=data.review)===null||_data$review2===void 0?void 0:_data$review2.created_at).format('YYYY-MM-DD HH:mm')})})]})}),(data===null||data===void 0?void 0:data.shop)&&/*#__PURE__*/_jsx(Card,{title:`${t('shop.details')}: #${data===null||data===void 0?void 0:(_data$shop=data.shop)===null||_data$shop===void 0?void 0:_data$shop.id}`,loading:loading,children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsxs(Col,{span:24,style:{display:'flex',columnGap:'20px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'100px',height:'100px',backgroundColor:'#f5f5f5',overflow:'hidden',borderRadius:'10px',position:'relative'},children:/*#__PURE__*/_jsx(Image,{alt:t('shop.logo'),style:{objectFit:'contain'},src:(data===null||data===void 0?void 0:(_data$shop2=data.shop)===null||_data$shop2===void 0?void 0:_data$shop2.logo_img)||'https://via.placeholder.com/150',width:100,height:100,preview:false})}),/*#__PURE__*/_jsxs(\"div\",{style:{width:`calc(100% - 100px - 20px)`},children:[/*#__PURE__*/_jsx(\"h5\",{style:{maxWidth:'100%',whiteSpace:'nowrap',overflow:'hidden',textOverflow:'ellipsis'},children:(data===null||data===void 0?void 0:(_data$shop3=data.shop)===null||_data$shop3===void 0?void 0:(_data$shop3$translati=_data$shop3.translation)===null||_data$shop3$translati===void 0?void 0:_data$shop3$translati.title)||'--'}),/*#__PURE__*/_jsx(\"p\",{children:data!==null&&data!==void 0&&(_data$shop4=data.shop)!==null&&_data$shop4!==void 0&&_data$shop4.open?/*#__PURE__*/_jsx(Tag,{color:\"green\",children:t('open')}):/*#__PURE__*/_jsx(Tag,{color:\"red\",children:t('closed')})})]})]}),/*#__PURE__*/_jsxs(Col,{span:24,children:[(data===null||data===void 0?void 0:(_data$shop5=data.shop)===null||_data$shop5===void 0?void 0:_data$shop5.phone)&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('phone'),\":\"]}),\" \",data===null||data===void 0?void 0:(_data$shop6=data.shop)===null||_data$shop6===void 0?void 0:_data$shop6.phone]}),(data===null||data===void 0?void 0:(_data$shop7=data.shop)===null||_data$shop7===void 0?void 0:(_data$shop7$translati=_data$shop7.translation)===null||_data$shop7$translati===void 0?void 0:_data$shop7$translati.address)&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('address'),\":\"]}),' ',data===null||data===void 0?void 0:(_data$shop8=data.shop)===null||_data$shop8===void 0?void 0:(_data$shop8$translati=_data$shop8.translation)===null||_data$shop8$translati===void 0?void 0:_data$shop8$translati.address]})]})]})})]}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsxs(Card,{className:\"w-100 order-table\",title:t('order.products'),children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Table,{ref:productListRef,scroll:{x:true},columns:columns,dataSource:((_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.details)||[],loading:loading,rowKey:record=>record===null||record===void 0?void 0:record.id,pagination:false,expandable:{expandedRowRender,expandIcon:_ref3=>{let{expanded,onExpand,record}=_ref3;return expanded?/*#__PURE__*/_jsx(SwapOutlined,{onClick:e=>onExpand(record,e),rotate:90}):/*#__PURE__*/_jsx(SwapOutlined,{onClick:e=>onExpand(record,e),rotate:90});},defaultExpandedRowKeys:['0']}}),/*#__PURE__*/_jsxs(Space,{size:100,className:\"d-flex justify-content-end w-100 order-table__summary\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.fee'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('order.tax'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('product'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('discount'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('service.fee'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('coupon.price'),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h3\",{children:[t('total.price'),\":\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:numberToPrice((_data$delivery_fee=data===null||data===void 0?void 0:data.delivery_fee)!==null&&_data$delivery_fee!==void 0?_data$delivery_fee:0,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:numberToPrice(data===null||data===void 0?void 0:data.tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:numberToPrice(data===null||data===void 0?void 0:data.origin_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:numberToPrice(data===null||data===void 0?void 0:data.total_discount,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:numberToPrice(data===null||data===void 0?void 0:data.service_fee,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:numberToPrice(data===null||data===void 0?void 0:data.coupon_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{ref:totalPriceRef,children:numberToPrice(data===null||data===void 0?void 0:data.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]})]})]})})]}),orderId&&/*#__PURE__*/_jsx(OrderStatusModal,{orderId:orderId,handleCancel:handleCloseModal,refetchPage:fetchOrder}),orderDeliveryDetails&&/*#__PURE__*/_jsx(OrderDeliveryman,{orderDetails:orderDeliveryDetails,handleCancel:handleCloseModal}),locationsMap&&/*#__PURE__*/_jsx(ShowLocationsMap,{id:locationsMap,handleCancel:handleCloseModal}),transactionStatusModal&&/*#__PURE__*/_jsx(TransactionStatusModal,{orderId:id,handleCancel:()=>setTransactionStatusModal(false),transactionDetails:data===null||data===void 0?void 0:data.transaction,fetchOrder:fetchOrder})]});}","map":null,"metadata":{},"sourceType":"module"}