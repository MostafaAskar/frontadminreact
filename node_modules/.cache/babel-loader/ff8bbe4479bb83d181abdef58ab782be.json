{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Card,Col,Pagination,Row,Spin}from'antd';import Meta from'antd/es/card/Meta';import{PlusOutlined}from'@ant-design/icons';import{shallowEqual,useDispatch,useSelector}from'react-redux';import getImage from'helpers/getImage';import{fetchRestProducts}from'redux/slices/product';import{toast}from'react-toastify';import ProductModal from'./product-modal';import{useTranslation}from'react-i18next';import{BsFillGiftFill}from'react-icons/bs';import{getCartData}from'redux/selectors/cartSelector';import RiveResult from'components/rive-result';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";export default function ProductCard(){const colLg={lg:8,xl:6,xxl:6};const{t}=useTranslation();const[extrasModal,setExtrasModal]=useState(null);const dispatch=useDispatch();const{products,loading,meta,params}=useSelector(state=>state.product,shallowEqual);const currentData=useSelector(state=>getCartData(state.cart));const{currency}=useSelector(state=>state.cart,shallowEqual);const{before_order_phone_required}=useSelector(state=>state.globalSettings.settings,shallowEqual);const{myShop}=useSelector(state=>state.myShop,shallowEqual);const paramsData={perPage:12,page:1,status:'published',active:1,shop_id:myShop===null||myShop===void 0?void 0:myShop.id};function onChangePagination(page){dispatch(fetchRestProducts({...paramsData,page}));}useEffect(()=>{dispatch(fetchRestProducts(paramsData));},[myShop===null||myShop===void 0?void 0:myShop.id]);const addProductToCart=item=>{var _currentData$user;if(!currency){toast.warning(t('please.select.currency'));return;}if((currentData===null||currentData===void 0?void 0:(_currentData$user=currentData.user)===null||_currentData$user===void 0?void 0:_currentData$user.length)===0){toast.warning(t('please.select.user'));return;}if(!(currentData!==null&&currentData!==void 0&&currentData.phone)&&before_order_phone_required==='1'){toast.warning(t('please.enter.phone'));return;}if(Number(currentData===null||currentData===void 0?void 0:currentData.phone)<0){toast.warning(t('invalid.phone.number'));return;}if(!currentData.address&&(currentData===null||currentData===void 0?void 0:currentData.delivery_type)==='delivery'){toast.warning(t('please.select.address'));return;}if(!currentData.delivery_point&&(currentData===null||currentData===void 0?void 0:currentData.delivery_type)==='point'){toast.warning(t('please.select.delivery.point'));return;}if(!(currentData!==null&&currentData!==void 0&&currentData.paymentType)){toast.warning(t('please.select.payment.type'));return;}if(!currentData.deliveries){toast.warning(t('please.select.delivery'));return;}if(!(currentData!==null&&currentData!==void 0&&currentData.delivery_date)){toast.warning(t('please.select.delivery.date'));return;}if((currentData===null||currentData===void 0?void 0:currentData.delivery_time)===null){toast.warning(t('please.select.delivery.time'));return;}setExtrasModal(item);};return/*#__PURE__*/_jsxs(\"div\",{className:\"px-2\",children:[loading?/*#__PURE__*/_jsx(Spin,{className:\"d-flex justify-content-center my-5\"}):/*#__PURE__*/_jsx(Row,{gutter:12,className:\"mt-4 product-card\",children:products.length===0?/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(RiveResult,{id:\"nosell\"})}):products.map((item,index)=>{var _item$translation;return/*#__PURE__*/_createElement(Col,{...colLg,key:index},/*#__PURE__*/_jsxs(Card,{className:\"products-col\",cover:/*#__PURE__*/_jsx(\"img\",{alt:item.name,src:getImage(item.img)}),onClick:()=>addProductToCart(item),children:[/*#__PURE__*/_jsx(Meta,{title:item===null||item===void 0?void 0:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title}),/*#__PURE__*/_jsx(\"div\",{className:\"preview\",children:/*#__PURE__*/_jsx(PlusOutlined,{})}),item.stocks.map(it=>{var _it$bonus,_it$bonus2;return/*#__PURE__*/_jsxs(\"span\",{className:it.bonus?'show-bonus':'d-none',children:[/*#__PURE__*/_jsx(BsFillGiftFill,{}),\" \",(_it$bonus=it.bonus)===null||_it$bonus===void 0?void 0:_it$bonus.value,'+',(_it$bonus2=it.bonus)===null||_it$bonus2===void 0?void 0:_it$bonus2.bonus_quantity]});})]},item.id));})}),extrasModal&&/*#__PURE__*/_jsx(ProductModal,{extrasModal:extrasModal,setExtrasModal:setExtrasModal}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end my-5\",children:/*#__PURE__*/_jsx(Pagination,{total:meta.total,current:params.page,pageSize:12,showSizeChanger:false,onChange:onChangePagination,active:1})})]});}","map":null,"metadata":{},"sourceType":"module"}