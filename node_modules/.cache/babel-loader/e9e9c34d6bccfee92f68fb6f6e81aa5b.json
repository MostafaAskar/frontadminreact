{"ast":null,"code":"import{Badge,Button,Checkbox,Empty,List,Modal,Space}from'antd';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import extraService from'services/extra';import ExtraValueModal from'./Extras/extra-value-modal';import{PlusOutlined}from'@ant-design/icons';import{GetColorName}from'hex-color-to-color-name';import Scrollbars from'react-custom-scrollbars';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ExtraValueSelectModal=_ref=>{let{extra,onClose,onSelect}=_ref;const{t}=useTranslation();const[loading,setLoading]=useState(false);const[extraValues,setExtraValues]=useState([]);const[selectedValues,setSelectedValues]=useState([]);const[isAddModalOpen,setIsAddModalOpen]=useState(false);const handleChange=values=>{setSelectedValues(values);};const handleSelect=()=>{const list=[];extraValues.forEach(extraValue=>{selectedValues.forEach(value=>{if(extraValue.value===value){list.push(extraValue);}});});onSelect(extra===null||extra===void 0?void 0:extra.value,list);onClose();};function fetchExtra(id){setLoading(true);extraService.getGroupById(id).then(res=>setExtraValues(res.data.extra_values.map(item=>({label:item.value,value:item.id,group_type:item.group.type})))).finally(()=>{setLoading(false);});}useEffect(()=>{if(!!(extra!==null&&extra!==void 0&&extra.value)&&!isAddModalOpen){var _extra$values;fetchExtra(extra.value);setSelectedValues((extra===null||extra===void 0?void 0:(_extra$values=extra.values)===null||_extra$values===void 0?void 0:_extra$values.map(value=>value.value))||[]);}},[extra===null||extra===void 0?void 0:extra.value,isAddModalOpen]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Modal,{visible:!!extra,onCancel:onClose,footer:[/*#__PURE__*/_jsx(Button,{onClick:onClose,children:t('cancel')}),!loading&&extraValues.length>0&&/*#__PURE__*/_jsx(Button,{onClick:handleSelect,type:\"primary\",children:t('save')})],children:[/*#__PURE__*/_jsx(Scrollbars,{autoHide:true,autoHeight:true,autoHeightMin:'60vh',autoHeightMax:'60vh',children:/*#__PURE__*/_jsx(Checkbox.Group,{value:selectedValues,onChange:handleChange,className:\"w-100\",children:(extraValues===null||extraValues===void 0?void 0:extraValues.length)===0&&!loading?/*#__PURE__*/_jsx(Empty,{}):/*#__PURE__*/_jsx(List,{dataSource:extraValues,loading:loading,renderItem:item=>/*#__PURE__*/_jsx(List.Item,{children:/*#__PURE__*/_jsx(Checkbox,{value:item.value,children:item.group_type==='color'?/*#__PURE__*/_jsxs(Space,{size:\"small\",children:[/*#__PURE__*/_jsx(Badge,{className:\"extras-color-badge\",color:item===null||item===void 0?void 0:item.label}),GetColorName(item===null||item===void 0?void 0:item.label),/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",item===null||item===void 0?void 0:item.label,\")\"]})]}):/*#__PURE__*/_jsx(\"span\",{children:item===null||item===void 0?void 0:item.label})})})})})}),!loading?/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:()=>setIsAddModalOpen(true),style:{paddingLeft:0},icon:/*#__PURE__*/_jsx(PlusOutlined,{}),children:t('add.new.extra')}):null]}),extra&&/*#__PURE__*/_jsx(ExtraValueModal,{isVisible:isAddModalOpen,modal:{label:extra===null||extra===void 0?void 0:extra.label,value:extra===null||extra===void 0?void 0:extra.id,key:extra===null||extra===void 0?void 0:extra.id},handleCancel:()=>setIsAddModalOpen(false),groupId:extra===null||extra===void 0?void 0:extra.value,onSuccess:()=>fetchExtra(extra===null||extra===void 0?void 0:extra.value)})]});};export default ExtraValueSelectModal;","map":null,"metadata":{},"sourceType":"module"}