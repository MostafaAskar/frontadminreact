{"ast":null,"code":"import{Button,Card,Space,Table,Tag,Divider}from'antd';import React,{useState,useEffect,useRef}from'react';import{useTranslation}from'react-i18next';import{useNavigate,useParams}from'react-router-dom';import orderService from'services/order';import Loading from'./loading';import{shallowEqual,useSelector,useDispatch}from'react-redux';import moment from'moment';import numberToPrice from'helpers/numberToPrice';import{PrinterOutlined}from'@ant-design/icons';import{useReactToPrint}from'react-to-print';import QrCode from'components/qr-code';import{disableRefetch}from'redux/slices/menu';import hideEmail from'components/hideEmail';import hideNumber from'./hideNumber';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;const Check=()=>{var _data$address,_data$address2,_data$user,_data$user2,_data$user3,_data$user$email,_data$user4,_data$user5,_data$user6,_data$user7,_data$user8,_data$note;const{t}=useTranslation();const dispatch=useDispatch();const componentRef=useRef();const navigate=useNavigate();const{id}=useParams();const{settings}=useSelector(state=>state.globalSettings);const{defaultCurrency}=useSelector(state=>state.currency,shallowEqual);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const[loading,setLoading]=useState(null);const[data,setData]=useState(null);const columns=[{title:t('id'),dataIndex:'id',key:'id',render:(_,row)=>{var _row$stock;return row===null||row===void 0?void 0:(_row$stock=row.stock)===null||_row$stock===void 0?void 0:_row$stock.id;}},{title:t('product.name'),dataIndex:'product',key:'product',render:(_,row)=>{var _row$stock$product$tr,_row$stock2,_row$stock2$product,_row$stock2$product$t;return(_row$stock$product$tr=(_row$stock2=row.stock)===null||_row$stock2===void 0?void 0:(_row$stock2$product=_row$stock2.product)===null||_row$stock2$product===void 0?void 0:(_row$stock2$product$t=_row$stock2$product.translation)===null||_row$stock2$product$t===void 0?void 0:_row$stock2$product$t.title)!==null&&_row$stock$product$tr!==void 0?_row$stock$product$tr:t('no.name');}},{title:t('price'),dataIndex:'price',key:'price',render:(_,row)=>{var _row$stock3,_row$stock$tax,_row$stock4;return numberToPrice((row===null||row===void 0?void 0:(_row$stock3=row.stock)===null||_row$stock3===void 0?void 0:_row$stock3.price)-((_row$stock$tax=row===null||row===void 0?void 0:(_row$stock4=row.stock)===null||_row$stock4===void 0?void 0:_row$stock4.tax)!==null&&_row$stock$tax!==void 0?_row$stock$tax:0),defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('quantity'),dataIndex:'quantity',key:'quantity',render:(quantity,row)=>{var _row$stock5,_row$stock5$product;return quantity*((row===null||row===void 0?void 0:(_row$stock5=row.stock)===null||_row$stock5===void 0?void 0:(_row$stock5$product=_row$stock5.product)===null||_row$stock5$product===void 0?void 0:_row$stock5$product.interval)||1);}},{title:t('tax'),dataIndex:'tax',key:'tax',render:tax=>numberToPrice(tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)},{title:t('discount'),dataIndex:'discount',key:'discount',render:(_,row)=>{var _row$stock6;return numberToPrice(row===null||row===void 0?void 0:(_row$stock6=row.stock)===null||_row$stock6===void 0?void 0:_row$stock6.discount,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol);}},{title:t('total.price'),dataIndex:'total_price',key:'total_price',render:total_price=>numberToPrice(total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)}];function fetchOrder(){setLoading(true);orderService.getById(id).then(_ref=>{let{data}=_ref;setData(data);}).finally(()=>{setLoading(false);});}useEffect(()=>{fetchOrder();dispatch(disableRefetch(activeMenu));},[]);useEffect(()=>{if(activeMenu.refetch){fetchOrder();dispatch(disableRefetch(activeMenu));}},[activeMenu.refetch]);const handlePrint=useReactToPrint({content:()=>componentRef.current});return/*#__PURE__*/_jsx(Card,{title:t('invoice'),extra:/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>navigate(-1),children:/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:t('back')})}),/*#__PURE__*/_jsxs(Button,{type:\"primary\",onClick:()=>handlePrint(),ref:componentRef,children:[/*#__PURE__*/_jsx(PrinterOutlined,{type:\"printer\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:t('print')})]})]}),children:loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"container_check\",ref:componentRef,children:[/*#__PURE__*/_jsxs(\"header\",{className:\"check_header\",children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"img\",{src:settings===null||settings===void 0?void 0:settings.favicon,alt:\"img\",className:\"check_icon overflow-hidden w-25 h-25 rounded\",width:'100%',height:'100%'})}),/*#__PURE__*/_jsxs(\"span\",{className:\"check_companyInfo\",children:[/*#__PURE__*/_jsx(\"h1\",{children:settings===null||settings===void 0?void 0:settings.title}),/*#__PURE__*/_jsx(\"h5\",{children:settings===null||settings===void 0?void 0:settings.address})]})]}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h4\",{children:[t('order.id'),\": \",data===null||data===void 0?void 0:data.id]}),/*#__PURE__*/_jsxs(\"h4\",{children:[t('date'),\":\",' ',moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')]}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.type'),\": \",data===null||data===void 0?void 0:data.delivery_type]}),(data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.city)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.address'),\": \",data===null||data===void 0?void 0:(_data$address2=data.address)===null||_data$address2===void 0?void 0:_data$address2.city]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.date'),\": \",data===null||data===void 0?void 0:data.delivery_date,' ',data===null||data===void 0?void 0:data.delivery_time]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('status'),\": \",/*#__PURE__*/_jsx(Tag,{color:\"green\",children:data===null||data===void 0?void 0:data.status})]})]})})]}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"shop_data\",children:t('user')}),/*#__PURE__*/_jsxs(\"span\",{children:[t('user.id'),\": \",data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.id]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('full.name'),\":\",' ',`${data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.firstname} ${data===null||data===void 0?void 0:(_data$user3=data.user)===null||_data$user3===void 0?void 0:_data$user3.lastname}`]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('email'),\":\",' ',((_data$user$email=data===null||data===void 0?void 0:(_data$user4=data.user)===null||_data$user4===void 0?void 0:_data$user4.email)!==null&&_data$user$email!==void 0?_data$user$email:ReactAppIsDemo)?hideEmail(data===null||data===void 0?void 0:(_data$user5=data.user)===null||_data$user5===void 0?void 0:_data$user5.email):data===null||data===void 0?void 0:(_data$user6=data.user)===null||_data$user6===void 0?void 0:_data$user6.email]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('phone'),\":\",' ',data!==null&&data!==void 0&&(_data$user7=data.user)!==null&&_data$user7!==void 0&&_data$user7.phone?hideNumber(data===null||data===void 0?void 0:(_data$user8=data.user)===null||_data$user8===void 0?void 0:_data$user8.phone):t('no.phone')]})]})})}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(QrCode,{orderId:id,showLink:false,size:1.5})})]}),/*#__PURE__*/_jsx(Table,{scroll:{x:true},columns:columns,dataSource:(data===null||data===void 0?void 0:data.details)||[],loading:loading,rowKey:record=>record.id,pagination:false,className:'check_table'}),/*#__PURE__*/_jsxs(\"footer\",{children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsxs(\"h3\",{children:[t('note'),\": \",(_data$note=data===null||data===void 0?void 0:data.note)!==null&&_data$note!==void 0?_data$note:t('no.note')]})}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('origin.price'),\":\"]}),/*#__PURE__*/_jsx(\"h4\",{children:numberToPrice(data===null||data===void 0?void 0:data.origin_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('total.tax'),\":\"]}),/*#__PURE__*/_jsx(\"h4\",{children:numberToPrice(data===null||data===void 0?void 0:data.tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('service.fee'),\":\"]}),/*#__PURE__*/_jsx(\"h4\",{children:numberToPrice(data===null||data===void 0?void 0:data.service_fee,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('delivery.fee'),\":\"]}),/*#__PURE__*/_jsx(\"h4\",{children:numberToPrice(data===null||data===void 0?void 0:data.delivery_fee,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('total.discount'),\":\"]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"- \",numberToPrice(data===null||data===void 0?void 0:data.total_discount)]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h5\",{children:[t('coupon'),\":\"]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"- \",numberToPrice(data===null||data===void 0?void 0:data.coupon_price)]})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsxs(\"h4\",{children:[t('total.price'),\":\"]}),/*#__PURE__*/_jsx(\"h3\",{children:numberToPrice(data===null||data===void 0?void 0:data.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)})]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"text-center\",children:[\"\\xA9 \",moment(new Date()).format('YYYY'),\" \",settings===null||settings===void 0?void 0:settings.title,\".\",' ',t('all.rights.reserved')]})]})});};export default Check;","map":null,"metadata":{},"sourceType":"module"}