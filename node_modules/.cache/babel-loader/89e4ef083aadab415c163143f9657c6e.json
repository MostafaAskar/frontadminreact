{"ast":null,"code":"import React,{useState}from'react';import{Button,Form,Modal,Row,Col}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import Map from'../../components/map';import getDefaultLocation from'../../helpers/getDefaultLocation';import{usePlacesWidget}from'react-google-autocomplete';import{MAP_API_KEY}from'../../configs/app-global';import{setMenuData}from'../../redux/slices/menu';import{setOrderData}from'../../redux/slices/order';import AddressForm from'../../components/forms/address-form';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserAddress(_ref){var _data$address,_activeMenu$data,_activeMenu$data$addr;let{uuid,handleCancel}=_ref;const{t}=useTranslation();const[form]=Form.useForm();const dispatch=useDispatch();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{settings}=useSelector(state=>state.globalSettings,shallowEqual);const{defaultLang}=useSelector(state=>state.formLang,shallowEqual);const{google_map_key}=useSelector(state=>state.globalSettings.settings,shallowEqual);const{data}=useSelector(state=>state.order,shallowEqual);const{ref}=usePlacesWidget({apiKey:google_map_key||MAP_API_KEY,onPlaceSelected:place=>{const location={lat:place===null||place===void 0?void 0:place.geometry.location.lat(),lng:place===null||place===void 0?void 0:place.geometry.location.lng()};setLocation(location);}});const[location,setLocation]=useState(data.address?{lat:data.address.lat,lng:data.address.lng}:getDefaultLocation(settings));const[value,setValue]=useState(data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.address);const onFinish=values=>{const address={...values,active:1,address:values===null||values===void 0?void 0:values[`address[${defaultLang}]`],lat:location.lat,lng:location.lng};dispatch(setOrderData({address}));dispatch(setMenuData({activeMenu,data:{...activeMenu.data,addressData:address}}));handleCancel();};return/*#__PURE__*/_jsx(Modal,{visible:!!uuid,title:t('create.address'),onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>form.submit(),children:t('save')},'saveBtn'),/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancelBtn')],children:/*#__PURE__*/_jsxs(Form,{layout:\"vertical\",name:\"user-address\",form:form,onFinish:onFinish,initialValues:{[`address[${defaultLang}]`]:activeMenu===null||activeMenu===void 0?void 0:(_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:(_activeMenu$data$addr=_activeMenu$data.addressData)===null||_activeMenu$data$addr===void 0?void 0:_activeMenu$data$addr.address},children:[/*#__PURE__*/_jsx(Row,{gutter:12,children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(AddressForm,{value:value,setValue:setValue,setLocation:setLocation})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('map'),children:/*#__PURE__*/_jsx(Map,{location:location,setLocation:setLocation,setAddress:value=>form.setFieldsValue({[`address[${defaultLang}]`]:value})})})})]})});}","map":null,"metadata":{},"sourceType":"module"}