{"ast":null,"code":"import GoogleMapReact from'google-map-react';import{Button,Card,Col,Modal,Row,Steps,Tag}from'antd';import React,{useState,useEffect}from'react';import{useTranslation}from'react-i18next';import orderService from'services/seller/order';import Loading from'components/loading';import{BsCalendar2Day,BsCheckLg}from'react-icons/bs';import{shallowEqual,useSelector}from'react-redux';import{MAP_API_KEY}from'configs/app-global';import FaUser from'assets/images/user.jpg';import getDefaultLocation from'helpers/getDefaultLocation';import{ShoppingCartOutlined}from'@ant-design/icons';import{MdRestaurant}from'react-icons/md';import{IoBicycleSharp,IoCheckmarkDoneSharp}from'react-icons/io5';import{AiOutlineCloseCircle}from'react-icons/ai';import moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const{Step}=Steps;const User=()=>/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',transform:'translate(-50%, -100%)'},children:/*#__PURE__*/_jsx(\"img\",{src:FaUser,width:\"50\",alt:\"Pin\"})});const ShowLocationsMap=_ref=>{var _data$transaction,_data$transaction$pay,_data$transaction2;let{id,handleCancel}=_ref;const{t}=useTranslation();const[loading,setLoading]=useState(null);const[data,setData]=useState(null);const[status,setStatus]=useState(null);const{settings}=useSelector(state=>state.globalSettings,shallowEqual);const center=getDefaultLocation(settings);const[current,setCurrent]=useState(0);const[userLocation,setUserLocation]=useState({lat:center===null||center===void 0?void 0:center.lat,lng:center===null||center===void 0?void 0:center.lng});const[steps,setSteps]=useState([{id:0,name:'new',icon:/*#__PURE__*/_jsx(ShoppingCartOutlined,{})},{id:1,name:'accepted',icon:/*#__PURE__*/_jsx(BsCheckLg,{})},{id:2,name:'ready',icon:/*#__PURE__*/_jsx(MdRestaurant,{})},{id:3,name:'on_a_way',icon:/*#__PURE__*/_jsx(IoBicycleSharp,{})},{id:4,name:'delivered',icon:/*#__PURE__*/_jsx(IoCheckmarkDoneSharp,{})}]);function fetchOrder(){setLoading(true);orderService.getById(id).then(_ref2=>{var _steps$find,_ref3,_ref4,_data$address$locatio,_data$address,_data$my_address,_data$delivery_point;let{data}=_ref2;setSteps(data.status==='canceled'?[{id:1,name:'new',icon:/*#__PURE__*/_jsx(ShoppingCartOutlined,{})},{id:5,name:'canceled',icon:/*#__PURE__*/_jsx(AiOutlineCloseCircle,{})}]:steps);setCurrent(data.status==='canceled'?1:(_steps$find=steps.find(item=>item.name===data.status))===null||_steps$find===void 0?void 0:_steps$find.id);const address=(_ref3=(_ref4=(_data$address$locatio=data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.location)!==null&&_data$address$locatio!==void 0?_data$address$locatio:data===null||data===void 0?void 0:(_data$my_address=data.my_address)===null||_data$my_address===void 0?void 0:_data$my_address.location)!==null&&_ref4!==void 0?_ref4:data===null||data===void 0?void 0:(_data$delivery_point=data.delivery_point)===null||_data$delivery_point===void 0?void 0:_data$delivery_point.location)!==null&&_ref3!==void 0?_ref3:{latitude:center===null||center===void 0?void 0:center.lat,longitude:center===null||center===void 0?void 0:center.lng};setUserLocation({lat:Number(address===null||address===void 0?void 0:address.latitude),lng:Number(address===null||address===void 0?void 0:address.longitude)});setStatus(data.status==='canceled'?'error':'success');setData(data);}).finally(()=>{setLoading(false);});}const{google_map_key}=useSelector(state=>state.globalSettings.settings,shallowEqual);useEffect(()=>{fetchOrder();},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Modal,{visible:!!id,title:t('show.locations'),closable:true,onCancel:handleCancel,style:{minWidth:'80vw'},footer:[/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancelBtn')],children:loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Steps,{current:current,status:status,className:\"mb-5\",children:steps===null||steps===void 0?void 0:steps.map((item,index)=>/*#__PURE__*/_jsx(Step,{title:t(item.name),icon:item===null||item===void 0?void 0:item.icon},item.id+index))}),/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsxs(\"h3\",{children:[t('order.id'),\" #\",data===null||data===void 0?void 0:data.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(BsCalendar2Day,{}),' ',moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('scheduled.at'),\" \",data===null||data===void 0?void 0:data.delivery_date]})]}),/*#__PURE__*/_jsxs(Col,{span:12,children:[/*#__PURE__*/_jsxs(\"p\",{children:[t('status'),' ',(data===null||data===void 0?void 0:data.status)==='new'?/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:t(data===null||data===void 0?void 0:data.status)}):(data===null||data===void 0?void 0:data.status)==='canceled'?/*#__PURE__*/_jsx(Tag,{color:\"error\",children:t(data===null||data===void 0?void 0:data.status)}):/*#__PURE__*/_jsx(Tag,{color:\"cyan\",children:t(data===null||data===void 0?void 0:data.status)})]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('payment.method'),' ',/*#__PURE__*/_jsx(\"strong\",{children:data===null||data===void 0?void 0:(_data$transaction=data.transaction)===null||_data$transaction===void 0?void 0:(_data$transaction$pay=_data$transaction.payment_system)===null||_data$transaction$pay===void 0?void 0:_data$transaction$pay.tag})]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('order.type'),\" \",/*#__PURE__*/_jsx(\"strong\",{children:data===null||data===void 0?void 0:data.delivery_type})]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('payment.type'),' ',/*#__PURE__*/_jsx(\"strong\",{children:data===null||data===void 0?void 0:(_data$transaction2=data.transaction)===null||_data$transaction2===void 0?void 0:_data$transaction2.status})]})]}),/*#__PURE__*/_jsxs(Col,{span:24,className:\"mt-5\",children:[/*#__PURE__*/_jsx(\"h4\",{children:t('map')}),/*#__PURE__*/_jsx(\"div\",{className:\"map-container\",style:{height:400,width:'100%'},children:/*#__PURE__*/_jsx(GoogleMapReact,{bootstrapURLKeys:{key:!!google_map_key?MAP_API_KEY:google_map_key},defaultZoom:10,center:userLocation!==null&&userLocation!==void 0?userLocation:center,options:{fullscreenControl:false},children:/*#__PURE__*/_jsx(User,{lat:userLocation===null||userLocation===void 0?void 0:userLocation.lat,lng:userLocation===null||userLocation===void 0?void 0:userLocation.lng})})})]})]})]})})});};export default ShowLocationsMap;","map":null,"metadata":{},"sourceType":"module"}