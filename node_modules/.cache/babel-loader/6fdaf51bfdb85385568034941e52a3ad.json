{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,Tabs}from'antd';import{useTranslation}from'react-i18next';import Setting from'./setting';import Locations from'./locations';import Footer from'./footer';import Reservation from'./reservation';import Permission from'./permission';import Auth from'./auth';import settingService from'../../../services/settings';import{shallowEqual,useSelector}from'react-redux';import{useDispatch}from'react-redux';import{disableRefetch,setMenuData}from'../../../redux/slices/menu';import createImage from'../../../helpers/createImage';import Loading from'../../../components/loading';import UiType from'./ui-type';import QrCode from'./qr-code';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const{TabPane}=Tabs;const defaultLocation={lat:47.4143302506288,lng:8.532059477976883};export default function GeneralSettings(){var _activeMenu$data,_activeMenu$data2,_activeMenu$data3;const{t}=useTranslation();const[tab,setTab]=useState('settings');const[loading,setLoading]=useState(false);const onChange=key=>setTab(key);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const dispatch=useDispatch();const[logo,setLogo]=useState(((_activeMenu$data=activeMenu.data)===null||_activeMenu$data===void 0?void 0:_activeMenu$data.logo)||null);const[favicon,setFavicon]=useState(((_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.favicon)||null);const[location,setLocation]=useState(((_activeMenu$data3=activeMenu.data)===null||_activeMenu$data3===void 0?void 0:_activeMenu$data3.location)||defaultLocation);const createSettings=list=>{const result=list.map(item=>({[item.key]:item.value}));return Object.assign({},...result);};function fetchSettings(){setLoading(true);settingService.get().then(res=>{var _data$location;const data=createSettings(res===null||res===void 0?void 0:res.data);const locationArray=data===null||data===void 0?void 0:(_data$location=data.location)===null||_data$location===void 0?void 0:_data$location.split(',');data.order_auto_delivery_man=data.order_auto_delivery_man==='1';data.order_auto_approved=data.order_auto_approved==='1';data.parcel_order_auto_approved=data.parcel_order_auto_approved==='1';data.system_refund=data.system_refund==='1';data.refund_delete=data.refund_delete==='1';data.prompt_email_modal=data.prompt_email_modal==='1';data.blog_active=data.blog_active==='1';data.referral_active=data.referral_active==='1';data.aws=data.aws==='1';data.group_order=data.group_order==='1';data.by_subscription=data.by_subscription==='1';data.reservation_enable_for_user=data.reservation_enable_for_user==='1';data.is_demo=data.is_demo==='1';data.product_auto_approve=(data===null||data===void 0?void 0:data.product_auto_approve)==='1';data.category_auto_approve=(data===null||data===void 0?void 0:data.category_auto_approve)==='1';data.before_order_phone_required=(data===null||data===void 0?void 0:data.before_order_phone_required)==='1';data.location={lat:Number(locationArray===null||locationArray===void 0?void 0:locationArray[0]),lng:Number(locationArray===null||locationArray===void 0?void 0:locationArray[1])};setLocation(data.location);data.logo=createImage(data.logo);data.favicon=createImage(data.favicon);setLogo(data.logo);setFavicon(data.favicon);dispatch(setMenuData({activeMenu,data}));}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});}useEffect(()=>{if(activeMenu.refetch){fetchSettings();}},[activeMenu.refetch]);return/*#__PURE__*/_jsx(Card,{title:t('project.settings'),children:loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(Tabs,{activeKey:tab,onChange:onChange,tabPosition:\"left\",size:\"small\",children:[/*#__PURE__*/_jsx(TabPane,{tab:t('settings'),children:/*#__PURE__*/_jsx(Setting,{logo:logo,setLogo:setLogo,favicon:favicon,setFavicon:setFavicon})},'settings'),/*#__PURE__*/_jsx(TabPane,{tab:t('location'),children:/*#__PURE__*/_jsx(Locations,{location:location,setLocation:setLocation})},'location'),/*#__PURE__*/_jsx(TabPane,{tab:t('permission'),children:/*#__PURE__*/_jsx(Permission,{})},'permission'),/*#__PURE__*/_jsx(TabPane,{tab:t('ui.type'),children:/*#__PURE__*/_jsx(UiType,{})},'ui_type'),/*#__PURE__*/_jsx(TabPane,{tab:t('auth.settings'),children:/*#__PURE__*/_jsx(Auth,{})},'auth'),/*#__PURE__*/_jsx(TabPane,{tab:t('footer'),children:/*#__PURE__*/_jsx(Footer,{})},'footer')]})});}","map":null,"metadata":{},"sourceType":"module"}