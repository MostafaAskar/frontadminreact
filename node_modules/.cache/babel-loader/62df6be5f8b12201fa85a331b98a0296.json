{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Col,Form,InputNumber,Modal,Row}from'antd';import{useTranslation}from'react-i18next';import pointService from'../../services/points';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{setRefetch}from'../../redux/slices/menu';import Loading from'../../components/loading';import shopService from'../../services/restaurant';import{DebounceSelect}from'../../components/search';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CashbackEditModal(_ref){let{visibility:id,handleCancel}=_ref;const[form]=Form.useForm();const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const dispatch=useDispatch();const[loading,setLoading]=useState(false);const[loadingBtn,setLoadingBtn]=useState(false);useEffect(()=>{setLoading(true);pointService.getById(id).then(_ref2=>{var _data$shop,_data$shop$translatio,_data$shop2;let{data}=_ref2;const body={...data,shop_id:{label:data===null||data===void 0?void 0:(_data$shop=data.shop)===null||_data$shop===void 0?void 0:(_data$shop$translatio=_data$shop.translation)===null||_data$shop$translatio===void 0?void 0:_data$shop$translatio.title,value:data===null||data===void 0?void 0:(_data$shop2=data.shop)===null||_data$shop2===void 0?void 0:_data$shop2.id}};form.setFieldsValue(body);}).finally(()=>setLoading(false));},[id]);async function fetchShops(search){const params={search,status:'approved'};return shopService.getAll(params).then(_ref3=>{let{data}=_ref3;return data.map(item=>{var _item$translation;return{label:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item.id};});});}const onFinish=values=>{setLoadingBtn(true);const payload={...values,type:'percent',shop_id:values.shop_id.value};pointService.update(id,payload).then(()=>{handleCancel();dispatch(setRefetch(activeMenu));}).finally(()=>setLoadingBtn(false));};return/*#__PURE__*/_jsx(Modal,{visible:!!id,title:t('edit.cashback'),onCancel:handleCancel,footer:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>form.submit(),loading:loadingBtn,children:t('save')},'save-cashback'),/*#__PURE__*/_jsx(Button,{type:\"default\",onClick:handleCancel,children:t('cancel')},'cancel-cashback')],children:!loading?/*#__PURE__*/_jsx(Form,{form:form,layout:\"vertical\",onFinish:onFinish,children:/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('shop/restaurant'),name:\"shop_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.shop'),fetchOptions:fetchShops,style:{minWidth:150},allowClear:false})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('cashback'),name:\"price\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{min:0,className:\"w-100\",addonAfter:\"%\"})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('min.amount'),name:\"value\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{min:0,className:\"w-100\"})})})]})}):/*#__PURE__*/_jsx(Loading,{})});}","map":null,"metadata":{},"sourceType":"module"}