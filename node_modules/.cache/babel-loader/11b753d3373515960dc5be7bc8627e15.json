{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Card,Modal,Spin,Table}from'antd';import orderService from'../../../services/seller/order';import Column from'antd/lib/table/Column';import{PrinterOutlined}from'@ant-design/icons';import moment from'moment';import numberToPrice from'../../../helpers/numberToPrice';import{useTranslation}from'react-i18next';import hideEmail from'components/hideEmail';import hideNumber from'components/hideNumber';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;const PreviewInfo=_ref=>{var _data$details$,_data$details$$delive,_data$details$$delive2,_data$details$2,_data$details$2$deliv,_data$details$3,_data$details$4,_data$user,_data$user2,_data$user3,_data$user4,_data$user5,_data$user6,_data$user7,_data$user8,_data$currency3,_data$currency4,_data$currency5,_data$currency6,_data$currency7;let{orderId,handleClose}=_ref;const{t}=useTranslation();const[loading,setLoading]=useState(false);const[data,setData]=useState(null);const[list,setList]=useState([]);function fetchOrderDetails(){setLoading(true);orderService.getById(orderId).then(res=>{setData(res.data);console.log('res.data',res);// const items = res.data.details.map((item) =>\n//   item.order_stocks.map((el) => ({\n//     ...el.stock,\n//     ...el,\n//     shop_id: item.shop_id,\n//   })),\n// );\nconst products=res.data.details;setList(products);}).finally(()=>setLoading(false));}useEffect(()=>{if(orderId){fetchOrderDetails();}},[orderId]);function calculateProductsPrice(){return data===null||data===void 0?void 0:data.details.reduce((total,item)=>total+=item.total_price,0);}function calculateTax(){return data===null||data===void 0?void 0:data.details.reduce((total,item)=>total+=item.tax,0);}function calculateCoupon(){return data===null||data===void 0?void 0:data.details.reduce((total,item)=>{var _item$coupon;return total+=(_item$coupon=item.coupon)===null||_item$coupon===void 0?void 0:_item$coupon.price;},0);}function calculateDeliveryPrice(){return data===null||data===void 0?void 0:data.details.reduce((total,item)=>total+=item.delivery_fee,0);}return/*#__PURE__*/_jsx(Modal,{visible:!!orderId,title:`Order created successfully`,onOk:handleClose,onCancel:handleClose,footer:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:t('back')}),/*#__PURE__*/_jsxs(Button,{type:\"primary\",onClick:()=>window.print(),children:[/*#__PURE__*/_jsx(PrinterOutlined,{type:\"printer\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:t('print')})]})],style:{minWidth:'80vw'},children:/*#__PURE__*/_jsx(\"div\",{className:\"py-4\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"w-100 text-center\",children:/*#__PURE__*/_jsx(Spin,{})}):/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-1 font-weight-semibold\",children:[t('invoice'),\" #\",data===null||data===void 0?void 0:data.id]}),/*#__PURE__*/_jsx(\"p\",{children:moment(data===null||data===void 0?void 0:data.created_at).format('DD/M/YYYY')}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.type'),\":\",' ',data===null||data===void 0?void 0:(_data$details$=data.details[0])===null||_data$details$===void 0?void 0:(_data$details$$delive=_data$details$.delivery_type)===null||_data$details$$delive===void 0?void 0:(_data$details$$delive2=_data$details$$delive.translation)===null||_data$details$$delive2===void 0?void 0:_data$details$$delive2.title]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.address'),\":\",' ',data===null||data===void 0?void 0:(_data$details$2=data.details[0])===null||_data$details$2===void 0?void 0:(_data$details$2$deliv=_data$details$2.delivery_address)===null||_data$details$2$deliv===void 0?void 0:_data$details$2$deliv.address]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.date'),\": \",data===null||data===void 0?void 0:(_data$details$3=data.details[0])===null||_data$details$3===void 0?void 0:_data$details$3.delivery_date,' ',data===null||data===void 0?void 0:(_data$details$4=data.details[0])===null||_data$details$4===void 0?void 0:_data$details$4.delivery_time]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('note'),\": \",data===null||data===void 0?void 0:data.note]})]})})]}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-weight-semibold text-dark font-size-md\",children:[data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.firstname,\" \",data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.lastname]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('phone'),\":\",' ',data!==null&&data!==void 0&&(_data$user3=data.user)!==null&&_data$user3!==void 0&&_data$user3.phone?ReactAppIsDemo?hideNumber(data===null||data===void 0?void 0:(_data$user4=data.user)===null||_data$user4===void 0?void 0:_data$user4.phone):data===null||data===void 0?void 0:(_data$user5=data.user)===null||_data$user5===void 0?void 0:_data$user5.phone:t('no.phone')]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('email'),\":\",' ',data!==null&&data!==void 0&&(_data$user6=data.user)!==null&&_data$user6!==void 0&&_data$user6.email?ReactAppIsDemo?hideEmail(data===null||data===void 0?void 0:(_data$user7=data.user)===null||_data$user7===void 0?void 0:_data$user7.email):data===null||data===void 0?void 0:(_data$user8=data.user)===null||_data$user8===void 0?void 0:_data$user8.email:t('no.email')]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsxs(Table,{scroll:{x:true},dataSource:list,pagination:false,className:\"mb-5\",children:[/*#__PURE__*/_jsx(Column,{title:\"No.\",dataIndex:\"id\"},'id'),/*#__PURE__*/_jsx(Column,{title:\"Product\",dataIndex:\"product\",render:(product,row)=>{var _row$stock,_row$stock$product,_row$stock$product$tr;return row===null||row===void 0?void 0:(_row$stock=row.stock)===null||_row$stock===void 0?void 0:(_row$stock$product=_row$stock.product)===null||_row$stock$product===void 0?void 0:(_row$stock$product$tr=_row$stock$product.translation)===null||_row$stock$product$tr===void 0?void 0:_row$stock$product$tr.title;}},'product'),/*#__PURE__*/_jsx(Column,{title:t('quantity'),dataIndex:\"quantity\",render:(_,row)=>{var _row$stock2,_row$stock2$product,_row$stock3,_row$stock3$product,_row$stock3$product$u,_row$stock3$product$u2;return/*#__PURE__*/_jsxs(\"span\",{children:[row.quantity*((row===null||row===void 0?void 0:(_row$stock2=row.stock)===null||_row$stock2===void 0?void 0:(_row$stock2$product=_row$stock2.product)===null||_row$stock2$product===void 0?void 0:_row$stock2$product.interval)||1),row===null||row===void 0?void 0:(_row$stock3=row.stock)===null||_row$stock3===void 0?void 0:(_row$stock3$product=_row$stock3.product)===null||_row$stock3$product===void 0?void 0:(_row$stock3$product$u=_row$stock3$product.unit)===null||_row$stock3$product$u===void 0?void 0:(_row$stock3$product$u2=_row$stock3$product$u.translation)===null||_row$stock3$product$u2===void 0?void 0:_row$stock3$product$u2.title]});}},'quantity'),/*#__PURE__*/_jsx(Column,{title:t('discount'),dataIndex:\"discount\",render:discount=>{var _data$currency;return numberToPrice(discount,data===null||data===void 0?void 0:(_data$currency=data.currency)===null||_data$currency===void 0?void 0:_data$currency.symbol);}},'discount'),/*#__PURE__*/_jsx(Column,{title:t('price'),dataIndex:\"total_price\",render:total_price=>{var _data$currency2;return numberToPrice(total_price,data===null||data===void 0?void 0:(_data$currency2=data.currency)===null||_data$currency2===void 0?void 0:_data$currency2.symbol);}},'total_price')]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-right \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-bottom\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('sub-total.amount'),\": \"]}),numberToPrice(calculateProductsPrice(),data===null||data===void 0?void 0:(_data$currency3=data.currency)===null||_data$currency3===void 0?void 0:_data$currency3.symbol)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('delivery.price'),\":\",' ',numberToPrice(calculateDeliveryPrice(),data===null||data===void 0?void 0:(_data$currency4=data.currency)===null||_data$currency4===void 0?void 0:_data$currency4.symbol)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('tax'),\":\",' ',numberToPrice(calculateTax(),data===null||data===void 0?void 0:(_data$currency5=data.currency)===null||_data$currency5===void 0?void 0:_data$currency5.symbol)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('coupon'),\":\",' ',numberToPrice(calculateCoupon(),data===null||data===void 0?void 0:(_data$currency6=data.currency)===null||_data$currency6===void 0?void 0:_data$currency6.symbol)]})]}),/*#__PURE__*/_jsxs(\"h2\",{className:\"font-weight-semibold mt-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"mr-1\",children:[t('grand.total'),\": \"]}),numberToPrice(data===null||data===void 0?void 0:data.total_price,data===null||data===void 0?void 0:(_data$currency7=data.currency)===null||_data$currency7===void 0?void 0:_data$currency7.symbol)]})]})})]})]})})});};export default PreviewInfo;","map":null,"metadata":{},"sourceType":"module"}