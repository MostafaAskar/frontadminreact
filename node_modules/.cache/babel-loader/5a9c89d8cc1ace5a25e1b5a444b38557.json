{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Button,Card,Col,Form,Input,Row,Select,Space,Switch}from'antd';import{useTranslation}from'react-i18next';import smsService from'../../services/smsPayloads';import{fetchSms}from'../../redux/slices/sms-geteways';import{shallowEqual,useDispatch}from'react-redux';import{toast}from'react-toastify';import{disableRefetch,removeFromMenu}from'../../redux/slices/menu';import{useNavigate,useParams}from'react-router-dom';import{useSelector}from'react-redux';import Loading from'../../components/loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const options=[{title:'firebase',value:'firebase'},{title:'twilio',value:'twilio'}];export default function SmsPayloadEdit(){const[form]=Form.useForm();const{t}=useTranslation();const[loadingBtn,setLoadingBtn]=useState(false);const[loading,setLoading]=useState(false);const dispatch=useDispatch();const navigate=useNavigate();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{type}=useParams();const[typeList,setTypeList]=useState(null);const{smsGatewaysList}=useSelector(state=>state.sms,shallowEqual);const fetchSmsPayload=type=>{setLoading(true);smsService.getById(type).then(res=>{console.log('res',res.data);const data=res.data;form.setFieldsValue({default:Boolean(data.default),...data.payload});setTypeList(data.type);}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const onFinish=values=>{setLoadingBtn(true);const data={type:typeList,default:Number(values.default),payload:{type:undefined,default:undefined,...values}};const nextUrl='settings/sms-payload';smsService.update(type,data).then(()=>{dispatch(fetchSms());toast.success(t('successfully.updated'));dispatch(removeFromMenu({...activeMenu,nextUrl}));navigate(`/${nextUrl}`);}).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(activeMenu.refetch){fetchSmsPayload(type);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[activeMenu.refetch]);const handleChange=value=>setTypeList(value);return/*#__PURE__*/_jsx(Card,{title:t('edit.sms.payload'),className:\"h-100\",children:loading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsx(Form,{form:form,layout:\"vertical\",onFinish:onFinish,children:/*#__PURE__*/_jsxs(Card,{title:t('add.sms.payload'),children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('select.type'),rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{disabled:true,className:\"w-100\",onChange:handleChange,value:typeList,options:options.filter(i=>!smsGatewaysList.some(e=>e.type===i.value))})})}),type==='firebase'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('android_api_key'),name:\"android_api_key\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('api_key'),name:\"api_key\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('app_id'),name:\"app_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('auth_domain'),name:\"auth_domain\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('ios_api_key'),name:\"ios_api_key\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('measurement_id'),name:\"measurement_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('message_sender_id'),name:\"message_sender_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('project_id'),name:\"project_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('server_key'),name:\"server_key\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('storage_bucket'),name:\"storage_bucket\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('vapid_key'),name:\"vapid_key\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('default'),name:\"default\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Switch,{})})})]}),type==='twilio'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('twilio_auth_token'),name:\"twilio_auth_token\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{min:0,className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('twilio_account_id'),name:\"twilio_account_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('twilio_number'),name:\"twilio_number\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Input,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('default'),name:\"default\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Switch,{})})})]})]}),/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('submit')})})]})})});}","map":null,"metadata":{},"sourceType":"module"}