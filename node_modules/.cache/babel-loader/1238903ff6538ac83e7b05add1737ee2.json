{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{Button,Card,Space,Switch,Table}from'antd';import{Context}from'context/context';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,setMenuData}from'redux/slices/menu';import{toast}from'react-toastify';import{useTranslation}from'react-i18next';import{fetchArea}from'redux/slices/deliveryzone/area';import SearchInput from'components/search-input';import useDidUpdate from'helpers/useDidUpdate';import areaService from'services/deliveryzone/area';import{useSearchParams}from'react-router-dom';import AreaForm from'./area-form';import{DeleteOutlined,EditOutlined}from'@ant-design/icons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Area=()=>{const{t}=useTranslation();const dispatch=useDispatch();let[searchParams,setSearchParams]=useSearchParams();const{setIsModalVisible}=useContext(Context);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const data=activeMenu===null||activeMenu===void 0?void 0:activeMenu.data;const city_id=searchParams.get('city_id');const{list,meta,loading}=useSelector(state=>state.deliveryArea,shallowEqual);const[selectedId,setSeletedId]=useState(false);const[visible,setVisible]=useState(false);const[deleting,setDeleting]=useState(false);const[id,setId]=useState(null);const handleActive=id=>{setSeletedId(id);areaService.status(id).then(()=>{setIsModalVisible(false);dispatch(fetchArea({city_id}));toast.success(t('successfully.updated'));}).finally(()=>{setSeletedId(null);});};const handleDelete=id=>{setDeleting(id);areaService.delete(id).then(()=>{dispatch(fetchArea());toast.success(t('successfully.deleted'));}).finally(()=>{setDeleting(false);});};const handleEdit=id=>{setVisible(true);setId(id);};const columns=[{title:t('id'),dataIndex:'id',key:'id'},{title:t('name'),dataIndex:'translation',key:'translation',render:(translation,row)=>(translation===null||translation===void 0?void 0:translation.title)||'-'},{title:t('active'),dataIndex:'active',key:'active',render:(active,row)=>{return/*#__PURE__*/_jsx(Switch,{onChange:()=>handleActive(row.id),checked:active,loading:Boolean(selectedId===row.id)},row.id);}},{title:t('options'),dataIndex:'options',is_show:true,render:(_,row)=>{return/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>handleEdit(row.id)}),/*#__PURE__*/_jsx(Button,{loading:Boolean(deleting===row.id),icon:/*#__PURE__*/_jsx(DeleteOutlined,{onClick:()=>handleDelete(row.id)})})]});}}];useEffect(()=>{if(activeMenu.refetch){dispatch(fetchArea({city_id}));dispatch(disableRefetch(activeMenu));}},[activeMenu.refetch]);useDidUpdate(()=>{const paramsData={search:data===null||data===void 0?void 0:data.search,city_id};dispatch(fetchArea(paramsData));},[activeMenu===null||activeMenu===void 0?void 0:activeMenu.data]);const onChangePagination=pageNumber=>{const{pageSize,current}=pageNumber;dispatch(fetchArea({perPage:pageSize,page:current,city_id}));};const handleFilter=(item,name)=>{dispatch(setMenuData({activeMenu,data:{...data,[name]:item}}));};return/*#__PURE__*/_jsxs(Card,{title:t('areas'),extra:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(SearchInput,{placeholder:t('search'),handleChange:search=>handleFilter(search,'search'),defaultValue:data===null||data===void 0?void 0:data.search,resetSearch:!(data!==null&&data!==void 0&&data.search)}),/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>setVisible(true),children:t('add.area')})]}),children:[/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:list,pagination:{pageSize:meta.per_page,page:meta.current_page,total:meta.total},rowKey:record=>record.id,loading:loading,onChange:onChangePagination}),/*#__PURE__*/_jsx(AreaForm,{visible:visible,setVisible:setVisible,id:id,setId:setId})]});};export default Area;","map":null,"metadata":{},"sourceType":"module"}