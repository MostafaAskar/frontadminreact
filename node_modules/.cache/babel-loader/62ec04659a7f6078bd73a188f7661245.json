{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import{toast}from'react-toastify';import{Button,Card,Col,Form,Input,InputNumber,Row}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{disableRefetch,removeFromMenu,setMenuData}from'../../../redux/slices/menu';import{useTranslation}from'react-i18next';import LanguageList from'../../../components/language-list';import bookingZoneService from'../../../services/seller/booking-zone';import MediaUpload from'components/upload';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BookingZoneEdit=()=>{var _activeMenu$data,_activeMenu$data2;const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{id}=useParams();const dispatch=useDispatch();const{defaultLang,languages}=useSelector(state=>state.formLang,shallowEqual);const[image,setImage]=useState((_activeMenu$data=activeMenu.data)!==null&&_activeMenu$data!==void 0&&_activeMenu$data.image?[(_activeMenu$data2=activeMenu.data)===null||_activeMenu$data2===void 0?void 0:_activeMenu$data2.image]:[]);const[form]=Form.useForm();const navigate=useNavigate();const[loading,setLoading]=useState(false);const[loadingBtn,setLoadingBtn]=useState(false);useEffect(()=>{return()=>{const data=form.getFieldsValue(true);dispatch(setMenuData({activeMenu,data}));};},[]);const createImages=items=>items.map(item=>({uid:item.id,name:item.path,url:item.path}));const fetchBox=id=>{setLoading(true);bookingZoneService.getById(id).then(res=>{let data=res.data;form.setFieldsValue({...data,title:{[defaultLang]:data.translation.title},area:Number(data.area)});setImage(createImages(data.galleries));}).finally(()=>{setLoading(false);dispatch(disableRefetch(activeMenu));});};const onFinish=values=>{const body={...values,area:String(values.area),images:image===null||image===void 0?void 0:image.map(img=>img.name)};setLoadingBtn(true);const nextUrl='seller/booking/zone';bookingZoneService.update(id,body).then(()=>{toast.success(t('successfully.created'));navigate(`/${nextUrl}`);dispatch(removeFromMenu({...activeMenu,nextUrl}));}).finally(()=>setLoadingBtn(false));};useEffect(()=>{if(activeMenu.refetch){fetchBox(id);}},[activeMenu.refetch]);return/*#__PURE__*/_jsx(Card,{title:t('add.booking.zone'),extra:/*#__PURE__*/_jsx(LanguageList,{}),loading:loading,children:/*#__PURE__*/_jsxs(Form,{name:\"basic\",layout:\"vertical\",onFinish:onFinish,form:form,initialValues:{active:true,...activeMenu.data},children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:12,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('title'),name:['title',item.locale],rules:[{validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{})},'title'+item.id))}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('area'),name:\"area\",rules:[{required:true,message:t('required')},{type:'number',min:1,message:t('must.be.at.least.1')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\"})})}),/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.Item,{label:t('image'),name:\"images\",rules:[{required:(image===null||image===void 0?void 0:image.length)===0,message:t('required')}],children:/*#__PURE__*/_jsx(MediaUpload,{type:\"shop-galleries\",imageList:image,setImageList:setImage,form:form,multiple:true})})})]}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loadingBtn,children:t('submit')})]})});};export default BookingZoneEdit;","map":null,"metadata":{},"sourceType":"module"}