{"ast":null,"code":"import{Empty,Spin}from'antd';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import{shallowEqual,useSelector}from'react-redux';import BookingModal from'./booking-modal';import{fetchBookingTable}from'redux/slices/booking-tables';import{useDispatch}from'react-redux';import useDidUpdate from'helpers/useDidUpdate';import{disableRefetch}from'redux/slices/menu';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function BookingTableCard(){var _data$free_from;const{t}=useTranslation();const[openModal,setOpenModal]=useState(null);const dispatch=useDispatch();const{tables,loading}=useSelector(state=>state.bookingTable,shallowEqual);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{data}=useSelector(state=>state.booking,shallowEqual);const{current_zone}=useSelector(state=>state.bookingZone,shallowEqual);const max_count={count:Math.max(...(tables===null||tables===void 0?void 0:tables.map(c=>c===null||c===void 0?void 0:c.chair_count))),percent:33};const params={shop_section_id:current_zone===null||current_zone===void 0?void 0:current_zone.id,status:data.current_tab==='all'?undefined:data.current_tab,free_from:(data===null||data===void 0?void 0:(_data$free_from=data.free_from)===null||_data$free_from===void 0?void 0:_data$free_from.length)>2?JSON.parse(data===null||data===void 0?void 0:data.free_from):undefined};useDidUpdate(()=>{dispatch(fetchBookingTable(params));},[current_zone,data]);useEffect(()=>{if(activeMenu.refetch&&current_zone!==null&&current_zone!==void 0&&current_zone.id){dispatch(fetchBookingTable(params));dispatch(disableRefetch(activeMenu));}},[activeMenu.refetch]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table_main\",children:[loading?/*#__PURE__*/_jsx(\"div\",{className:\"empty\",children:/*#__PURE__*/_jsx(Spin,{style:{height:'120px'}})}):tables===null||tables===void 0?void 0:tables.map((item,idx)=>{const residual=item.chair_count>=12?2:1;return/*#__PURE__*/_jsxs(\"div\",{className:\"table_container\",onClick:()=>setOpenModal(item),style:{width:`${item.chair_count<=3?10:item.chair_count/max_count.count*max_count.percent}%`},children:[/*#__PURE__*/_jsx(\"div\",{className:\"table_chair_top\",children:Array.from({length:Math.ceil(item.chair_count/2)-residual},(_,y)=>/*#__PURE__*/_jsx(\"span\",{},y))}),/*#__PURE__*/_jsxs(\"div\",{className:\"table_card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"table_chair_left\",children:Array.from({length:residual},(_,y)=>/*#__PURE__*/_jsx(\"span\",{},y))}),item.name,item.chair_count>1&&/*#__PURE__*/_jsx(\"div\",{className:\"table_chair_right\",children:Array.from({length:residual},(_,y)=>/*#__PURE__*/_jsx(\"span\",{},y))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table_chair_bottom\",children:Array.from({length:Math.floor(item.chair_count/2)-residual},(_,y)=>/*#__PURE__*/_jsx(\"span\",{},y))})]},item.name+'_'+idx);}),!tables.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"empty\",children:/*#__PURE__*/_jsx(Empty,{image:\"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg\",description:/*#__PURE__*/_jsx(\"span\",{children:t('no.data')}),style:{height:'120px'}})})]}),openModal&&/*#__PURE__*/_jsx(BookingModal,{visible:openModal,handleCancel:()=>setOpenModal(null)})]});}","map":null,"metadata":{},"sourceType":"module"}