{"ast":null,"code":"import React from'react';import{Button,Col,Form,Input,InputNumber,Row,Select}from'antd';import{shallowEqual,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import MediaUpload from'../../components/upload';import shopService from'../../services/restaurant';import{DebounceSelect}from'../../components/search';import categoryService from'../../services/category';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const{TextArea}=Input;const ReceptMain=_ref=>{let{next,image,setImage,back,setBack}=_ref;const{t}=useTranslation();const form=Form.useFormInstance();const{defaultLang,languages}=useSelector(state=>state.formLang,shallowEqual);function fetchCategory(search){const params={active:1,type:'receipt',search};return categoryService.getAll(params).then(res=>{return res.data.map(category=>({label:category.translation.title,value:category.id}));});}async function fetchShops(search){const params={search,status:'approved'};return shopService.getAll(params).then(_ref2=>{let{data}=_ref2;return data.map(item=>{var _item$translation;return{label:(_item$translation=item.translation)===null||_item$translation===void 0?void 0:_item$translation.title,value:item.id};});});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{gutter:12,children:[/*#__PURE__*/_jsx(Col,{span:8,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('name'),name:['title',item.locale],rules:[{validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(Input,{})},'name'+item.id))}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Form.Item,{label:t('shop/restaurant'),name:\"shop_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DebounceSelect,{placeholder:t('select.shop'),fetchOptions:fetchShops,style:{minWidth:150},allowClear:false})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Form.Item,{label:t('category'),name:\"category_id\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(DebounceSelect,{fetchOptions:fetchCategory,placeholder:t('select.category'),style:{minWidth:150}})},'category_id')}),/*#__PURE__*/_jsx(Col,{span:24,children:languages.map(item=>/*#__PURE__*/_jsx(Form.Item,{label:t('description'),name:['description',item.locale],rules:[{validator(_,value){if(!value&&(item===null||item===void 0?void 0:item.locale)===defaultLang){return Promise.reject(new Error(t('required')));}else if(value&&(value===null||value===void 0?void 0:value.trim())===''){return Promise.reject(new Error(t('no.empty.space')));}else if(value&&(value===null||value===void 0?void 0:value.trim().length)<2){return Promise.reject(new Error(t('must.be.at.least.2')));}return Promise.resolve();}}],hidden:item.locale!==defaultLang,children:/*#__PURE__*/_jsx(TextArea,{rows:3})},'description'+item.id))}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Form.Item,{label:t('calories'),name:\"calories\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",min:0})},'calories')}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Form.Item,{label:t('servings'),name:\"servings\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",min:0})},'servings')}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Form.Item,{label:t('active.time'),name:\"active_time\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",min:0})},'active_time')}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Form.Item,{label:t('total.time'),name:\"total_time\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",min:0})},'total_time')}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('discount.type'),name:\"discount_type\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(Select,{options:[{label:t('fix'),value:'fix'},{label:t('percent'),value:'percent'}]})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('discount.price'),name:\"discount_price\",rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\",min:0})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('background'),name:\"back_img\",rules:[{validator(_,value){if((back===null||back===void 0?void 0:back.length)===0){return Promise.reject(new Error(t('required')));}return Promise.resolve();}}],children:/*#__PURE__*/_jsx(MediaUpload,{type:\"receipts\",imageList:back,setImageList:setBack,form:form,multiple:false})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:t('image'),name:\"image\",rules:[{validator(_,value){if((image===null||image===void 0?void 0:image.length)===0){return Promise.reject(new Error(t('required')));}return Promise.resolve();}}],children:/*#__PURE__*/_jsx(MediaUpload,{type:\"receipts\",imageList:image,setImageList:setImage,form:form,multiple:false})})})]}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"button\",onClick:()=>{form.validateFields([['title',defaultLang],['description',defaultLang],'calories','servings','active_time','total_time','discount_type','discount_price','category_id','shop_id','back_img','image']).then(value=>{next();});},children:t('next')})]});};export default ReceptMain;","map":null,"metadata":{},"sourceType":"module"}