{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import{Button,Space,Table,Card}from'antd';import{useNavigate}from'react-router-dom';import{DeleteOutlined,EyeOutlined}from'@ant-design/icons';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{addMenu,setMenuData}from'../../redux/slices/menu';import{useTranslation}from'react-i18next';import numberToPrice from'../../helpers/numberToPrice';import{fetchUserOrders}from'../../redux/slices/orders';import formatSortType from'../../helpers/formatSortType';import{Context}from'../../context/context';import{toast}from'react-toastify';import DeleteButton from'../../components/delete-button';import CustomModal from'../../components/modal';import orderService from'../../services/order';import FilterColumns from'../../components/filter-column';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function UserOrders(_ref){let{data}=_ref;const dispatch=useDispatch();const navigate=useNavigate();const{t}=useTranslation();const[id,setId]=useState(null);const[text,setText]=useState(null);const{setIsModalVisible}=useContext(Context);const[loadingBtn,setLoadingBtn]=useState(false);const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{orders,meta,loading,params}=useSelector(state=>state.orders,shallowEqual);const{defaultCurrency}=useSelector(state=>state.currency,shallowEqual);const orderDelete=()=>{setLoadingBtn(true);const params={...Object.assign({},...id.map((item,index)=>({[`ids[${index}]`]:item})))};orderService.delete(params).then(()=>{toast.success(t('successfully.deleted'));setIsModalVisible(false);dispatch(fetchUserOrders());setText(null);}).finally(()=>setLoadingBtn(false));};const goToShow=row=>{dispatch(addMenu({url:`order/details/${row.id}`,id:'order_details',name:t('order.details')}));navigate(`/order/details/${row.id}`);};const[columns,setColumns]=useState([{title:t('id'),is_show:true,dataIndex:'id',key:'id',sorter:true},{title:t('client'),is_show:true,dataIndex:'user',key:'user',render:user=>/*#__PURE__*/_jsxs(\"div\",{children:[user===null||user===void 0?void 0:user.firstname,\" \",(user===null||user===void 0?void 0:user.lastname)||'']})},{title:t('number.of.products'),is_show:true,dataIndex:'order_details_count',key:'order_details_count',render:order_details_count=>/*#__PURE__*/_jsxs(\"div\",{className:\"text-lowercase\",children:[order_details_count||0,\" \",t('products')]})},{title:t('amount'),is_show:true,dataIndex:'total_price',key:'total_price',render:total_price=>numberToPrice(total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol)},{title:t('payment.type'),is_show:true,dataIndex:'transaction',key:'transaction',render:transaction=>{var _transaction$payment_;return t(transaction===null||transaction===void 0?void 0:(_transaction$payment_=transaction.payment_system)===null||_transaction$payment_===void 0?void 0:_transaction$payment_.tag)||'-';}},{title:t('created.at'),is_show:true,dataIndex:'created_at',key:'created_at'},{title:t('options'),is_show:true,key:'options',render:(_,row)=>{return/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(EyeOutlined,{}),onClick:()=>goToShow(row)}),/*#__PURE__*/_jsx(DeleteButton,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:()=>{setId([row.id]);setIsModalVisible(true);setText(true);}})]});}}]);function onChangePagination(pagination,filter,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column,order}=sorter;const sort=formatSortType(order);dispatch(setMenuData({activeMenu,data:{...activeMenu.data,perPage,page,column,sort}}));}useEffect(()=>{const params={user_id:data===null||data===void 0?void 0:data.uuid,page:1,perPage:10};dispatch(fetchUserOrders(params));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);const rowSelection={selectedRowKeys:id,onChange:key=>{setId(key);}};const allDelete=()=>{if(id===null||id.length===0){toast.warning(t('select.the.product'));}else{setIsModalVisible(true);setText(false);}};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Card,{title:t('orders'),extra:/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(DeleteButton,{type:\"danger\",onClick:allDelete,children:t('delete.all')}),/*#__PURE__*/_jsx(FilterColumns,{setColumns:setColumns,columns:columns})]}),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},rowSelection:rowSelection,columns:columns===null||columns===void 0?void 0:columns.filter(items=>items.is_show),dataSource:orders,loading:loading,pagination:{pageSize:params.perPage,page:params.page,total:meta.total,defaultCurrent:params.page},rowKey:record=>record.id,onChange:onChangePagination}),/*#__PURE__*/_jsx(CustomModal,{click:orderDelete,text:text?t('delete'):t('all.delete'),loading:loadingBtn,setText:setId})]})});}","map":null,"metadata":{},"sourceType":"module"}