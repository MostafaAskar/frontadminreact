{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{Button,Card,Space,Table,Tag}from'antd';import inviteService from'../../../services/seller/invites';import InviteModal from'./invite-modal';import{Context}from'../../../context/context';import CustomModal from'../../../components/modal';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{fetchInvites}from'../../../redux/slices/invite';import{disableRefetch,setMenuData}from'../../../redux/slices/menu';import formatSortType from'../../../helpers/formatSortType';import useDidUpdate from'../../../helpers/useDidUpdate';import{useTranslation}from'react-i18next';import FilterColumns from'../../../components/filter-column';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function Invites(){const{t}=useTranslation();const dispatch=useDispatch();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const{loading,invites,params,meta}=useSelector(state=>state.invite,shallowEqual);const[inviteId,setInviteId]=useState(null);const{setIsModalVisible}=useContext(Context);const[id,setId]=useState(null);const[loadingBtn,setLoadingBtn]=useState(false);const[columns,setColumns]=useState([{title:t('id'),dataIndex:'id',key:'id',sorter:true,is_show:true},{title:t('fullname'),dataIndex:'user',key:'user',is_show:true,render:user=>/*#__PURE__*/_jsxs(_Fragment,{children:[user===null||user===void 0?void 0:user.firstname,\" \",(user===null||user===void 0?void 0:user.lastname)||'']})},{title:t('role'),dataIndex:'role',key:'role',is_show:true},{title:t('status'),dataIndex:'status',key:'status',is_show:true,render:status=>/*#__PURE__*/_jsx(Tag,{color:status==='rejected'?'red':status==='new'?'blue':'cyan',children:t(status)})},{title:t('created.at'),dataIndex:'created_at',key:'created_at',is_show:true},{title:t('options'),key:'options',dataIndex:'options',is_show:true,render:(data,row)=>{return/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>setInviteId(row),disabled:row.status==='excepted',children:t('accept')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",danger:true,onClick:()=>{setIsModalVisible(true);setId(row.id);},disabled:row.status==='rejected',children:t('reject')})]});}}]);useEffect(()=>{if(activeMenu.refetch){dispatch(fetchInvites());dispatch(disableRefetch(activeMenu));}},[activeMenu.refetch]);function onChangePagination(pagination,filters,sorter){const{pageSize:perPage,current:page}=pagination;const{field:column,order}=sorter;const sort=formatSortType(order);dispatch(setMenuData({activeMenu,data:{perPage,page,column,sort}}));}useDidUpdate(()=>{const data=activeMenu.data;const paramsData={sort:data===null||data===void 0?void 0:data.sort,column:data===null||data===void 0?void 0:data.column,perPage:data===null||data===void 0?void 0:data.perPage,page:data===null||data===void 0?void 0:data.page};dispatch(fetchInvites(paramsData));},[activeMenu.data]);function rejectInvite(){setLoadingBtn(true);inviteService.statusUpdate(id).then(()=>{setIsModalVisible(false);setId(null);dispatch(fetchInvites());}).finally(()=>setLoadingBtn(false));}return/*#__PURE__*/_jsxs(Card,{title:t('invites'),extra:/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(FilterColumns,{columns:columns,setColumns:setColumns})}),children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},columns:columns===null||columns===void 0?void 0:columns.filter(item=>item.is_show),dataSource:invites,pagination:{pageSize:params.perPage,page:params.page,total:meta.total,defaultCurrent:params.page},rowKey:record=>record.id,onChange:onChangePagination,loading:loading}),!!inviteId&&/*#__PURE__*/_jsx(InviteModal,{inviteId:inviteId,handleCancel:()=>setInviteId(null)}),/*#__PURE__*/_jsx(CustomModal,{click:rejectInvite,text:t('reject.invite'),loading:loadingBtn})]});}","map":null,"metadata":{},"sourceType":"module"}