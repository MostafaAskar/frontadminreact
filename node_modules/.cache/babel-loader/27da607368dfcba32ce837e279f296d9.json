{"ast":null,"code":"import{DeleteOutlined,PlusOutlined}from'@ant-design/icons';import{Button,Col,Form,InputNumber,Row,Space}from'antd';import React from'react';import{useTranslation}from'react-i18next';import{AsyncSelect}from'../../../components/async-select';import productService from'../../../services/seller/product';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ReceptStocks=_ref=>{let{next,prev}=_ref;const{t}=useTranslation();const form=Form.useFormInstance();const stocks=Form.useWatch('stocks',form);function fetchProductsStock(search){const params={perPage:10,page:1,search,active:1};return productService.getStock(params).then(res=>res.data.filter(stock=>!stocks.map(item=>{var _item$stock_id;return item===null||item===void 0?void 0:(_item$stock_id=item.stock_id)===null||_item$stock_id===void 0?void 0:_item$stock_id.value;}).includes(stock.id)).map(stock=>({label:stock.product.translation.title+' '+stock.extras.map(ext=>ext.value).join(', '),value:stock.id})));}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{gutter:12,children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(Form.List,{name:\"stocks\",initialValue:[{stock_id:undefined,min_quantity:undefined}],children:(fields,_ref2)=>{let{add,remove}=_ref2;return/*#__PURE__*/_jsxs(_Fragment,{children:[fields.map((_ref3,i)=>{let{key,name,...restField}=_ref3;return/*#__PURE__*/_jsxs(Row,{gutter:12,align:\"middle\",children:[/*#__PURE__*/_jsx(Col,{span:11,children:/*#__PURE__*/_jsx(Form.Item,{...restField,label:t('stock'),name:[name,'stock_id'],rules:[{required:true,message:t('required')}],children:/*#__PURE__*/_jsx(AsyncSelect,{fetchOptions:fetchProductsStock,debounceTimeout:200})})}),/*#__PURE__*/_jsx(Col,{span:11,children:/*#__PURE__*/_jsx(Form.Item,{...restField,label:t('min.quantity'),name:[name,'min_quantity'],rules:[{required:true,message:t('required')},{type:'number',min:1,message:t('must.be.at.least.1')}],children:/*#__PURE__*/_jsx(InputNumber,{className:\"w-100\"})})}),i!==0&&/*#__PURE__*/_jsx(Col,{span:2,className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsx(Button,{onClick:()=>remove(name),danger:true,className:\"w-100\",type:\"primary\",icon:/*#__PURE__*/_jsx(DeleteOutlined,{})})})]});}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>add(),block:true,icon:/*#__PURE__*/_jsx(PlusOutlined,{}),children:t('add.stock')})})]});}})})}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"button\",onClick:()=>prev(),children:t('prev')}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"button\",onClick:()=>{form.validateFields(stocks.flatMap((stock,i)=>[['stocks',i,'stock_id'],['stocks',i,'min_quantity']])).then(()=>{next();});},children:t('next')})]})]});};export default ReceptStocks;","map":null,"metadata":{},"sourceType":"module"}