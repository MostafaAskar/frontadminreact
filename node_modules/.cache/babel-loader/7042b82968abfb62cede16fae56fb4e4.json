{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Card,Modal,Space,Spin,Table,Tag}from'antd';import Column from'antd/lib/table/Column';import{PrinterOutlined}from'@ant-design/icons';import moment from'moment';import numberToPrice from'helpers/numberToPrice';import{useTranslation}from'react-i18next';import{shallowEqual,useSelector}from'react-redux';import{GetColorName}from'hex-color-to-color-name';import hideNumber from'components/hideNumber';import hideEmail from'components/hideEmail';import useDemo from'helpers/useDemo';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;const PreviewInfo=_ref=>{var _data$delivery_point,_data$delivery_point2,_data$delivery_point3,_data$address,_data$details$,_data$note,_data$user,_data$user2,_data$user3,_data$user4,_data$user5,_data$user6,_data$user7,_data$user8,_data$currency,_data$currency2,_data$currency3,_data$currency4,_data$currency5,_data$currency6,_data$currency7,_data$currency8,_data$currency9,_data$currency10,_data$coupon,_data$currency11,_data$currency12,_data$currency13,_data$currency14;let{handleClose}=_ref;const{t}=useTranslation();const{cartOrder}=useSelector(state=>state.cart,shallowEqual);const{defaultLang}=useSelector(state=>state.formLang,shallowEqual);const{isDemo}=useDemo();const[data,setData]=useState();const[list,setList]=useState();function calculateProductsPrice(){return data===null||data===void 0?void 0:data.details.reduce((total,item)=>total+=(item===null||item===void 0?void 0:item.total_price)||0,0);}useEffect(()=>{if(cartOrder){var _cartOrder$filter;const data=cartOrder===null||cartOrder===void 0?void 0:(_cartOrder$filter=cartOrder.filter(item=>!(item!==null&&item!==void 0&&item.parent_id)))===null||_cartOrder$filter===void 0?void 0:_cartOrder$filter[0];setList(cartOrder===null||cartOrder===void 0?void 0:cartOrder.map(item=>item===null||item===void 0?void 0:item.details).flat());setData(data);}},[cartOrder]);return/*#__PURE__*/_jsx(Modal,{visible:!!cartOrder,title:t('order.created.successfully'),onOk:handleClose,onCancel:handleClose,footer:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,children:t('back')}),/*#__PURE__*/_jsxs(Button,{type:\"primary\",onClick:()=>window.print(),children:[/*#__PURE__*/_jsx(PrinterOutlined,{type:\"printer\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:t('print')})]})],width:1000,children:/*#__PURE__*/_jsx(\"div\",{className:\"py-4 order-preview\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-1 font-weight-semibold\",children:[t('invoice'),\" #\",data===null||data===void 0?void 0:data.id]}),/*#__PURE__*/_jsx(\"p\",{children:moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.type'),\": \",data===null||data===void 0?void 0:data.delivery_type]}),/*#__PURE__*/_jsx(\"br\",{}),(data===null||data===void 0?void 0:data.delivery_type)==='point'&&(data===null||data===void 0?void 0:(_data$delivery_point=data.delivery_point)===null||_data$delivery_point===void 0?void 0:_data$delivery_point.address)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('point'),\":\",' ',data===null||data===void 0?void 0:(_data$delivery_point2=data.delivery_point)===null||_data$delivery_point2===void 0?void 0:(_data$delivery_point3=_data$delivery_point2.address)===null||_data$delivery_point3===void 0?void 0:_data$delivery_point3[defaultLang]]}),/*#__PURE__*/_jsx(\"br\",{})]}),' ',(data===null||data===void 0?void 0:data.delivery_type)==='delivery'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.address'),\": \",data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.address]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.date'),\": \",data===null||data===void 0?void 0:data.delivery_date,' ',data===null||data===void 0?void 0:(_data$details$=data.details[0])===null||_data$details$===void 0?void 0:_data$details$.delivery_time]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('note'),\": \",(_data$note=data===null||data===void 0?void 0:data.note)!==null&&_data$note!==void 0?_data$note:'--']})]})})]}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-weight-semibold text-dark font-size-md\",children:[data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.firstname,\" \",(data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.lastname)||'']}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('phone'),\":\",' ',data!==null&&data!==void 0&&(_data$user3=data.user)!==null&&_data$user3!==void 0&&_data$user3.phone?ReactAppIsDemo==='true'||isDemo?hideNumber(data===null||data===void 0?void 0:(_data$user4=data.user)===null||_data$user4===void 0?void 0:_data$user4.phone):data===null||data===void 0?void 0:(_data$user5=data.user)===null||_data$user5===void 0?void 0:_data$user5.phone:t('no.phone')]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('email'),\":\",' ',data!==null&&data!==void 0&&(_data$user6=data.user)!==null&&_data$user6!==void 0&&_data$user6.email?ReactAppIsDemo==='true'||isDemo?hideEmail(data===null||data===void 0?void 0:(_data$user7=data.user)===null||_data$user7===void 0?void 0:_data$user7.email):data===null||data===void 0?void 0:(_data$user8=data.user)===null||_data$user8===void 0?void 0:_data$user8.email:t('no.email')]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsxs(Table,{scroll:{x:true},dataSource:list,pagination:false,className:\"mb-5\",children:[/*#__PURE__*/_jsx(Column,{title:\"No.\",dataIndex:\"id\"},'id'),/*#__PURE__*/_jsx(Column,{title:t('product'),dataIndex:\"stock\",render:stock=>{var _stock$product,_stock$product$transl,_stock$extras;return/*#__PURE__*/_jsxs(Space,{wrap:true,children:[/*#__PURE__*/_jsx(\"span\",{children:stock===null||stock===void 0?void 0:(_stock$product=stock.product)===null||_stock$product===void 0?void 0:(_stock$product$transl=_stock$product.translation)===null||_stock$product$transl===void 0?void 0:_stock$product$transl.title}),stock===null||stock===void 0?void 0:(_stock$extras=stock.extras)===null||_stock$extras===void 0?void 0:_stock$extras.map(extra=>{var _extra$group,_extra$group2,_extra$group2$transla,_extra$value,_extra$group3,_extra$group3$transla,_extra$value2;return((_extra$group=extra.group)===null||_extra$group===void 0?void 0:_extra$group.type)==='color'?/*#__PURE__*/_jsxs(Tag,{children:[(_extra$group2=extra.group)===null||_extra$group2===void 0?void 0:(_extra$group2$transla=_extra$group2.translation)===null||_extra$group2$transla===void 0?void 0:_extra$group2$transla.title,\":\",' ',GetColorName((_extra$value=extra.value)===null||_extra$value===void 0?void 0:_extra$value.value)]},extra===null||extra===void 0?void 0:extra.id):/*#__PURE__*/_jsxs(Tag,{children:[(_extra$group3=extra.group)===null||_extra$group3===void 0?void 0:(_extra$group3$transla=_extra$group3.translation)===null||_extra$group3$transla===void 0?void 0:_extra$group3$transla.title,\":\",' ',(_extra$value2=extra.value)===null||_extra$value2===void 0?void 0:_extra$value2.value]},extra===null||extra===void 0?void 0:extra.id);})]});}},'product'),/*#__PURE__*/_jsx(Column,{title:t('quantity'),dataIndex:\"numberQuantity\",render:(_,row)=>{var _row$stock,_row$stock$product,_row$stock2,_row$stock2$product,_row$stock2$product$u,_row$stock2$product$u2;return/*#__PURE__*/_jsxs(\"span\",{children:[row.quantity*(((_row$stock=row.stock)===null||_row$stock===void 0?void 0:(_row$stock$product=_row$stock.product)===null||_row$stock$product===void 0?void 0:_row$stock$product.interval)||1),row===null||row===void 0?void 0:(_row$stock2=row.stock)===null||_row$stock2===void 0?void 0:(_row$stock2$product=_row$stock2.product)===null||_row$stock2$product===void 0?void 0:(_row$stock2$product$u=_row$stock2$product.unit)===null||_row$stock2$product$u===void 0?void 0:(_row$stock2$product$u2=_row$stock2$product$u.translation)===null||_row$stock2$product$u2===void 0?void 0:_row$stock2$product$u2.title]});}},'numberQuantity'),/*#__PURE__*/_jsx(Column,{title:t('discount'),dataIndex:\"discount\",render:(_,row)=>{var _row$stock3,_row$currency,_row$currency2;return row!==null&&row!==void 0&&row.bonus?0:numberToPrice((row===null||row===void 0?void 0:(_row$stock3=row.stock)===null||_row$stock3===void 0?void 0:_row$stock3.discount)||0,row===null||row===void 0?void 0:(_row$currency=row.currency)===null||_row$currency===void 0?void 0:_row$currency.symbol,row===null||row===void 0?void 0:(_row$currency2=row.currency)===null||_row$currency2===void 0?void 0:_row$currency2.position);}},'discount'),/*#__PURE__*/_jsx(Column,{title:t('price'),dataIndex:\"total_price\",render:(total_price,row)=>{var _row$currency3,_row$currency4;return numberToPrice(total_price||0,row===null||row===void 0?void 0:(_row$currency3=row.currency)===null||_row$currency3===void 0?void 0:_row$currency3.symbol,row===null||row===void 0?void 0:(_row$currency4=row.currency)===null||_row$currency4===void 0?void 0:_row$currency4.position);}},'total_price')]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-right \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-bottom\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('products'),\": \"]}),numberToPrice(calculateProductsPrice(),data===null||data===void 0?void 0:(_data$currency=data.currency)===null||_data$currency===void 0?void 0:_data$currency.symbol,data===null||data===void 0?void 0:(_data$currency2=data.currency)===null||_data$currency2===void 0?void 0:_data$currency2.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('delivery.fee'),\" :\",' ',numberToPrice((data===null||data===void 0?void 0:data.delivery_fee)||0,data===null||data===void 0?void 0:(_data$currency3=data.currency)===null||_data$currency3===void 0?void 0:_data$currency3.symbol,data===null||data===void 0?void 0:(_data$currency4=data.currency)===null||_data$currency4===void 0?void 0:_data$currency4.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('service.fee'),\" :\",' ',numberToPrice((data===null||data===void 0?void 0:data.service_fee)||0,data===null||data===void 0?void 0:(_data$currency5=data.currency)===null||_data$currency5===void 0?void 0:_data$currency5.symbol,data===null||data===void 0?void 0:(_data$currency6=data.currency)===null||_data$currency6===void 0?void 0:_data$currency6.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('tax'),\" :\",' ',numberToPrice((data===null||data===void 0?void 0:data.total_tax)||0,data===null||data===void 0?void 0:(_data$currency7=data.currency)===null||_data$currency7===void 0?void 0:_data$currency7.symbol,data===null||data===void 0?void 0:(_data$currency8=data.currency)===null||_data$currency8===void 0?void 0:_data$currency8.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('discount'),\" : -\",numberToPrice((data===null||data===void 0?void 0:data.total_discount)||0,data===null||data===void 0?void 0:(_data$currency9=data.currency)===null||_data$currency9===void 0?void 0:_data$currency9.symbol,data===null||data===void 0?void 0:(_data$currency10=data.currency)===null||_data$currency10===void 0?void 0:_data$currency10.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('coupon'),\" : -\",numberToPrice((data===null||data===void 0?void 0:(_data$coupon=data.coupon)===null||_data$coupon===void 0?void 0:_data$coupon.price)||0,data===null||data===void 0?void 0:(_data$currency11=data.currency)===null||_data$currency11===void 0?void 0:_data$currency11.symbol,data===null||data===void 0?void 0:(_data$currency12=data.currency)===null||_data$currency12===void 0?void 0:_data$currency12.position)]})]}),/*#__PURE__*/_jsxs(\"h2\",{className:\"font-weight-semibold mt-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"mr-1\",children:[t('grand.total'),\": \"]}),numberToPrice((data===null||data===void 0?void 0:data.total_price)||0,data===null||data===void 0?void 0:(_data$currency13=data.currency)===null||_data$currency13===void 0?void 0:_data$currency13.symbol,data===null||data===void 0?void 0:(_data$currency14=data.currency)===null||_data$currency14===void 0?void 0:_data$currency14.position)]})]})})]})]})})});};export default PreviewInfo;","map":null,"metadata":{},"sourceType":"module"}