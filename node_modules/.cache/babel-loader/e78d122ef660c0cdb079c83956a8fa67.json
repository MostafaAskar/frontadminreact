{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Card,Image,Modal,Space,Table,Tag}from'antd';import{PrinterOutlined}from'@ant-design/icons';import moment from'moment';import numberToPrice from'helpers/numberToPrice';import{useTranslation}from'react-i18next';import'assets/scss/components/print.scss';import getImage from'helpers/getImage';import{shallowEqual,useSelector}from'react-redux';import{GetColorName}from'hex-color-to-color-name';import hideNumber from'components/hideNumber';import hideEmail from'components/hideEmail';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ReactAppIsDemo=process.env.REACT_APP_IS_DEMO;const PreviewInfo=_ref=>{var _cartOrder$reduce,_cartOrder$reduce2,_cartOrder$reduce3,_cartOrder$reduce4,_data$delivery_point,_data$delivery_point$,_data$address,_data$note,_data$user,_data$user2,_data$user3,_data$user4,_data$user5,_data$user6;let{handleClose}=_ref;const{t}=useTranslation();const{cartOrder}=useSelector(state=>state.cart,shallowEqual);const{defaultCurrency}=useSelector(state=>state.currency,shallowEqual);const{defaultLang}=useSelector(state=>state.formLang,shallowEqual);const[parentOrder,setParentOrder]=useState();const[data,setData]=useState();const[list,setList]=useState();useEffect(()=>{if(cartOrder){var _cartOrder$filter;const data=cartOrder===null||cartOrder===void 0?void 0:(_cartOrder$filter=cartOrder.filter(item=>!(item!==null&&item!==void 0&&item.parent_id)))===null||_cartOrder$filter===void 0?void 0:_cartOrder$filter[0];setParentOrder(data);setList(cartOrder===null||cartOrder===void 0?void 0:cartOrder.map(item=>item===null||item===void 0?void 0:item.details).flat());setData(data);}},[cartOrder]);const columns=[{title:t('id'),dataIndex:'id',key:'id',render:(_,row)=>{var _row$stock;return(_row$stock=row.stock)===null||_row$stock===void 0?void 0:_row$stock.id;}},{title:t('product.name'),dataIndex:'product',key:'product',render:(_,row)=>{var _row$stock2,_row$stock2$product,_row$stock2$product$t,_row$stock3,_row$stock3$extras;return/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",className:\"relative\",children:[(_row$stock2=row.stock)===null||_row$stock2===void 0?void 0:(_row$stock2$product=_row$stock2.product)===null||_row$stock2$product===void 0?void 0:(_row$stock2$product$t=_row$stock2$product.translation)===null||_row$stock2$product$t===void 0?void 0:_row$stock2$product$t.title,(_row$stock3=row.stock)===null||_row$stock3===void 0?void 0:(_row$stock3$extras=_row$stock3.extras)===null||_row$stock3$extras===void 0?void 0:_row$stock3$extras.map(extra=>{var _extra$group,_extra$group2,_extra$group2$transla,_extra$value,_extra$group3,_extra$group3$transla,_extra$value2;return((_extra$group=extra.group)===null||_extra$group===void 0?void 0:_extra$group.type)==='color'?/*#__PURE__*/_jsxs(Tag,{children:[(_extra$group2=extra.group)===null||_extra$group2===void 0?void 0:(_extra$group2$transla=_extra$group2.translation)===null||_extra$group2$transla===void 0?void 0:_extra$group2$transla.title,\":\",' ',GetColorName((_extra$value=extra.value)===null||_extra$value===void 0?void 0:_extra$value.value)]},extra===null||extra===void 0?void 0:extra.id):/*#__PURE__*/_jsxs(Tag,{children:[(_extra$group3=extra.group)===null||_extra$group3===void 0?void 0:(_extra$group3$transla=_extra$group3.translation)===null||_extra$group3$transla===void 0?void 0:_extra$group3$transla.title,\": \",(_extra$value2=extra.value)===null||_extra$value2===void 0?void 0:_extra$value2.value]},extra===null||extra===void 0?void 0:extra.id);})]});}},{title:t('image'),dataIndex:'img',key:'img',render:(_,row)=>{var _row$stock4,_row$stock4$product;return/*#__PURE__*/_jsx(Image,{src:getImage((_row$stock4=row.stock)===null||_row$stock4===void 0?void 0:(_row$stock4$product=_row$stock4.product)===null||_row$stock4$product===void 0?void 0:_row$stock4$product.img),alt:\"product\",width:100,height:\"auto\",className:\"rounded\",preview:true,placeholder:true});}},{title:t('price'),dataIndex:'origin_price',key:'origin_price',render:(_,row)=>{var _row$stock5,_row$stock$tax,_row$stock6;return numberToPrice((row===null||row===void 0?void 0:(_row$stock5=row.stock)===null||_row$stock5===void 0?void 0:_row$stock5.price)-((_row$stock$tax=row===null||row===void 0?void 0:(_row$stock6=row.stock)===null||_row$stock6===void 0?void 0:_row$stock6.tax)!==null&&_row$stock$tax!==void 0?_row$stock$tax:0),defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position);}},{title:t('quantity'),dataIndex:'quantity',key:'quantity',render:(quantity,row)=>{var _row$stock7,_row$stock7$product;console.log('row',row);return/*#__PURE__*/_jsx(\"span\",{children:quantity*(row===null||row===void 0?void 0:(_row$stock7=row.stock)===null||_row$stock7===void 0?void 0:(_row$stock7$product=_row$stock7.product)===null||_row$stock7$product===void 0?void 0:_row$stock7$product.interval)});}},{title:t('discount'),dataIndex:'rate_discount',key:'rate_discount',render:(_,row)=>{var _row$stock8;return numberToPrice(row===null||row===void 0?void 0:(_row$stock8=row.stock)===null||_row$stock8===void 0?void 0:_row$stock8.discount,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position);}},{title:t('tax'),dataIndex:'tax',key:'tax',render:tax=>numberToPrice(tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)},{title:t('total.price'),dataIndex:'total_price',key:'total_price',render:(_,row)=>{return numberToPrice(row===null||row===void 0?void 0:row.total_price,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position);}}];const totalPrices={products:(_cartOrder$reduce=cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$origin_price;return total+=(_item$origin_price=item===null||item===void 0?void 0:item.origin_price)!==null&&_item$origin_price!==void 0?_item$origin_price:0;},0))!==null&&_cartOrder$reduce!==void 0?_cartOrder$reduce:0,deliveryFee:(_cartOrder$reduce2=cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$delivery_fee;return total+=(_item$delivery_fee=item===null||item===void 0?void 0:item.delivery_fee)!==null&&_item$delivery_fee!==void 0?_item$delivery_fee:0;},0))!==null&&_cartOrder$reduce2!==void 0?_cartOrder$reduce2:0,serviceFee:(_cartOrder$reduce3=cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$service_fee;return total+=(_item$service_fee=item===null||item===void 0?void 0:item.service_fee)!==null&&_item$service_fee!==void 0?_item$service_fee:0;},0))!==null&&_cartOrder$reduce3!==void 0?_cartOrder$reduce3:0,tax:(_cartOrder$reduce4=cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$tax;return total+=(_item$tax=item===null||item===void 0?void 0:item.tax)!==null&&_item$tax!==void 0?_item$tax:0;},0))!==null&&_cartOrder$reduce4!==void 0?_cartOrder$reduce4:0,discount:cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$total_discount;return total+=(_item$total_discount=item===null||item===void 0?void 0:item.total_discount)!==null&&_item$total_discount!==void 0?_item$total_discount:0;},0),couponPrice:cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$coupon$price,_item$coupon;return total+=(_item$coupon$price=item===null||item===void 0?void 0:(_item$coupon=item.coupon)===null||_item$coupon===void 0?void 0:_item$coupon.price)!==null&&_item$coupon$price!==void 0?_item$coupon$price:0;},0),totalPrice:cartOrder===null||cartOrder===void 0?void 0:cartOrder.reduce((total,item)=>{var _item$total_price;return total+=(_item$total_price=item===null||item===void 0?void 0:item.total_price)!==null&&_item$total_price!==void 0?_item$total_price:0;},0)};return/*#__PURE__*/_jsx(Modal,{visible:!!cartOrder,title:t('order.created.successfully'),onOk:handleClose,onCancel:handleClose,footer:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,className:\"buttons\",children:t('back')}),/*#__PURE__*/_jsxs(Button,{type:\"primary\",onClick:()=>window.print(),className:\"buttons\",children:[/*#__PURE__*/_jsx(PrinterOutlined,{type:\"printer\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:t('print')})]})],width:1000,children:/*#__PURE__*/_jsx(\"div\",{className:\"py-4 order-preview\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-1 font-weight-semibold\",children:[t('invoice'),\" #\",parentOrder===null||parentOrder===void 0?void 0:parentOrder.id]}),/*#__PURE__*/_jsx(\"p\",{children:moment(data===null||data===void 0?void 0:data.created_at).format('YYYY-MM-DD HH:mm')}),/*#__PURE__*/_jsx(\"address\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.type'),\": \",data===null||data===void 0?void 0:data.delivery_type]}),/*#__PURE__*/_jsx(\"br\",{}),(data===null||data===void 0?void 0:data.delivery_type)==='point'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('point'),\":\",' ',data===null||data===void 0?void 0:(_data$delivery_point=data.delivery_point)===null||_data$delivery_point===void 0?void 0:(_data$delivery_point$=_data$delivery_point.address)===null||_data$delivery_point$===void 0?void 0:_data$delivery_point$[defaultLang]]}),/*#__PURE__*/_jsx(\"br\",{})]}),' ',(data===null||data===void 0?void 0:data.delivery_type)==='delivery'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.address'),\": \",data===null||data===void 0?void 0:(_data$address=data.address)===null||_data$address===void 0?void 0:_data$address.address]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"span\",{children:[t('delivery.date'),\": \",data===null||data===void 0?void 0:data.delivery_date,' ',data===null||data===void 0?void 0:data.delivery_time]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('note'),\": \",(_data$note=data===null||data===void 0?void 0:data.note)!==null&&_data$note!==void 0?_data$note:'--']})]})})]}),/*#__PURE__*/_jsxs(\"address\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-1 font-weight-semibold\",children:[t('user'),\" #\",data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-weight-semibold text-dark font-size-md\",children:[data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.firstname,\" \",data===null||data===void 0?void 0:(_data$user3=data.user)===null||_data$user3===void 0?void 0:_data$user3.lastname]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('phone'),\":\",' ',data!==null&&data!==void 0&&data.phone?ReactAppIsDemo?hideNumber(data===null||data===void 0?void 0:data.phone):data===null||data===void 0?void 0:data.phone:t('no.phone')]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{children:[t('email'),\":\",' ',data!==null&&data!==void 0&&(_data$user4=data.user)!==null&&_data$user4!==void 0&&_data$user4.email?ReactAppIsDemo?hideEmail(data===null||data===void 0?void 0:(_data$user5=data.user)===null||_data$user5===void 0?void 0:_data$user5.email):data===null||data===void 0?void 0:(_data$user6=data.user)===null||_data$user6===void 0?void 0:_data$user6.email:t('no.email')]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Table,{scroll:{x:true},columns:columns,dataSource:list||[],rowKey:record=>record.id,pagination:false}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-right \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-bottom\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[t('products'),\": \"]}),numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.products,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('delivery.fee'),\" :\",' ',numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.deliveryFee,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('service.fee'),\" :\",' ',numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.serviceFee,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('tax'),\" :\",' ',numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.tax,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('discount'),\" : -\",numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.discount,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]}),/*#__PURE__*/_jsxs(\"p\",{children:[t('coupon'),\" : -\",numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.couponPrice,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"font-weight-semibold mt-3\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"mr-1\",children:[t('grand.total'),\":\",' ',/*#__PURE__*/_jsx(\"div\",{className:\"ml-2 font-weight-bold\",children:numberToPrice(totalPrices===null||totalPrices===void 0?void 0:totalPrices.totalPrice,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.symbol,defaultCurrency===null||defaultCurrency===void 0?void 0:defaultCurrency.position)})]})})]})})]})]})})});};export default PreviewInfo;","map":null,"metadata":{},"sourceType":"module"}