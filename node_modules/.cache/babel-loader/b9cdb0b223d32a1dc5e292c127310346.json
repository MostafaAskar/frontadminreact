{"ast":null,"code":"import React,{useState}from'react';import{Card,Button}from'antd';import{shallowEqual,useDispatch,useSelector}from'react-redux';import{useTranslation}from'react-i18next';import Dragger from'antd/lib/upload/Dragger';import{CloudUploadOutlined,InboxOutlined}from'@ant-design/icons';import updateService from'../../services/update';import{setMenuData}from'../../redux/slices/menu';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Update(){const[loadingBtn,setLoadingBtn]=useState(false);const dispatch=useDispatch();const{t}=useTranslation();const{activeMenu}=useSelector(state=>state.menu,shallowEqual);const updateBackend=()=>{setLoadingBtn(true);updateService.update().then(()=>toast.success(t('successfully.updated'))).finally(()=>setLoadingBtn(false));};const createFile=file=>{return{uid:file.title,name:file.title,status:'done',url:file.title,created:true};};const handleUpload=_ref=>{let{file,onSuccess}=_ref;const formData=new FormData();formData.append('file',file);updateService.upload(formData).then(_ref2=>{let{data}=_ref2;dispatch(setMenuData({activeMenu,data:createFile(data)}));onSuccess('ok');});};const beforeUpload=file=>{const isPNG=file.type==='image/png';const isJPG=file.type==='image/jpg';const isJPEG=file.type==='image/jpeg';if(isPNG||isJPEG||isJPG){toast.error(`${file.name} is not valid file`);return false;}};return/*#__PURE__*/_jsx(Card,{title:t('update'),extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(CloudUploadOutlined,{}),loading:loadingBtn,onClick:updateBackend,children:t('update.database')}),children:/*#__PURE__*/_jsxs(Dragger,{name:\"file\",multiple:false,maxCount:1,customRequest:handleUpload,defaultFileList:activeMenu!==null&&activeMenu!==void 0&&activeMenu.data?[activeMenu===null||activeMenu===void 0?void 0:activeMenu.data]:null,beforeUpload:beforeUpload,children:[/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-drag-icon\",children:/*#__PURE__*/_jsx(InboxOutlined,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-text\",children:\"Click or drag file to this area to upload\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ant-upload-hint\",children:\"In order to update database using this file you need to click button above\"})]})});}","map":null,"metadata":{},"sourceType":"module"}